import{Q as Qt,W as Si,y as Ti,x as lt,u as fs,E as hs,R as Jr,z as $r,N as ds,j as qt,P as gs,g as we,o as me,a as Dn,b as T,d as X,h as xs,i as Et,w as ws,l as ms,k as Kt,A as sn,V as ei,n as dt,F as on,q as An,t as Pe,f as Cn,C as As}from"./app-CTF0ss1m.js";import Cs from"./MoneyInput-RSw88-2D.js";import ps from"./ConfirmSubmit-Cz45rk4X.js";import Es from"./ScannerBox-D2_n5whI.js";import"./Modal-BkH6HXOE.js";function bs(x,d){for(var u=0;u<d.length;u++){const p=d[u];if(typeof p!="string"&&!Array.isArray(p)){for(const E in p)if(E!=="default"&&!(E in x)){const w=Object.getOwnPropertyDescriptor(p,E);w&&Object.defineProperty(x,E,w.get?w:{enumerable:!0,get:()=>p[E]})}}}return Object.freeze(Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}))}var Y;(function(x){x[x.QR_CODE=0]="QR_CODE",x[x.AZTEC=1]="AZTEC",x[x.CODABAR=2]="CODABAR",x[x.CODE_39=3]="CODE_39",x[x.CODE_93=4]="CODE_93",x[x.CODE_128=5]="CODE_128",x[x.DATA_MATRIX=6]="DATA_MATRIX",x[x.MAXICODE=7]="MAXICODE",x[x.ITF=8]="ITF",x[x.EAN_13=9]="EAN_13",x[x.EAN_8=10]="EAN_8",x[x.PDF_417=11]="PDF_417",x[x.RSS_14=12]="RSS_14",x[x.RSS_EXPANDED=13]="RSS_EXPANDED",x[x.UPC_A=14]="UPC_A",x[x.UPC_E=15]="UPC_E",x[x.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Y||(Y={}));var ti=new Map([[Y.QR_CODE,"QR_CODE"],[Y.AZTEC,"AZTEC"],[Y.CODABAR,"CODABAR"],[Y.CODE_39,"CODE_39"],[Y.CODE_93,"CODE_93"],[Y.CODE_128,"CODE_128"],[Y.DATA_MATRIX,"DATA_MATRIX"],[Y.MAXICODE,"MAXICODE"],[Y.ITF,"ITF"],[Y.EAN_13,"EAN_13"],[Y.EAN_8,"EAN_8"],[Y.PDF_417,"PDF_417"],[Y.RSS_14,"RSS_14"],[Y.RSS_EXPANDED,"RSS_EXPANDED"],[Y.UPC_A,"UPC_A"],[Y.UPC_E,"UPC_E"],[Y.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),ni;(function(x){x[x.UNKNOWN=0]="UNKNOWN",x[x.URL=1]="URL"})(ni||(ni={}));function ys(x){return Object.values(Y).includes(x)}var jn;(function(x){x[x.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",x[x.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(jn||(jn={}));var Is=(function(){function x(){}return x.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",x.SCAN_DEFAULT_FPS=2,x.DEFAULT_DISABLE_FLIP=!1,x.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,x.DEFAULT_SUPPORTED_SCAN_TYPE=[jn.SCAN_TYPE_CAMERA,jn.SCAN_TYPE_FILE],x})(),Ni=(function(){function x(d,u){this.format=d,this.formatName=u}return x.prototype.toString=function(){return this.formatName},x.create=function(d){if(!ti.has(d))throw"".concat(d," not in html5QrcodeSupportedFormatsTextMap");return new x(d,ti.get(d))},x})(),ri=(function(){function x(){}return x.createFromText=function(d){var u={text:d};return{decodedText:d,result:u}},x.createFromQrcodeResult=function(d){return{decodedText:d.text,result:d}},x})(),Rr;(function(x){x[x.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",x[x.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",x[x.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Rr||(Rr={}));var _s=(function(){function x(){}return x.createFrom=function(d){return{errorMessage:d,type:Rr.UNKWOWN_ERROR}},x})(),Ss=(function(){function x(d){this.verbose=d}return x.prototype.log=function(d){this.verbose&&console.log(d)},x.prototype.warn=function(d){this.verbose&&console.warn(d)},x.prototype.logError=function(d,u){(this.verbose||u===!0)&&console.error(d)},x.prototype.logErrors=function(d){if(d.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(d)},x})();function Gt(x){return typeof x>"u"||x===null}var pn=(function(){function x(){}return x.codeParseError=function(d){return"QR code parse error, error = ".concat(d)},x.errorGettingUserMedia=function(d){return"Error getting userMedia, error = ".concat(d)},x.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},x.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},x.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},x.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},x.scannerPaused=function(){return"Scanner paused"},x})(),Oi=(function(){function x(){}return x.isMediaStreamConstraintsValid=function(d,u){if(typeof d!="object"){var p=typeof d;return u.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(p,"."),!0),!1}for(var E=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],w=new Set(E),N=Object.keys(d),F=0,k=N;F<k.length;F++){var C=k[F];if(w.has(C))return u.logError("".concat(C," is not supported videoConstaints."),!0),!1}return!0},x})(),Mn={exports:{}},Ts=Mn.exports,ii;function Ns(){return ii||(ii=1,(function(x,d){(function(u,p){p(d)})(Ts,(function(u){function p(f){return f==null}var E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,e){f.__proto__=e}||function(f,e){for(var t in e)e.hasOwnProperty(t)&&(f[t]=e[t])};function w(f,e){E(f,e);function t(){this.constructor=f}f.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function N(f,e){var t=Object.setPrototypeOf;t?t(f,e):f.__proto__=e}function F(f,e){e===void 0&&(e=f.constructor);var t=Error.captureStackTrace;t&&t(f,e)}var k=(function(f){w(e,f);function e(t){var n=this.constructor,r=f.call(this,t)||this;return Object.defineProperty(r,"name",{value:n.name,enumerable:!1}),N(r,n.prototype),F(r),r}return e})(Error);class C extends k{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}C.kind="Exception";class P extends C{}P.kind="ArgumentException";class M extends C{}M.kind="IllegalArgumentException";class ae{constructor(e){if(this.binarizer=e,e===null)throw new M("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,n,r){const i=this.binarizer.getLuminanceSource().crop(e,t,n,r);return new ae(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new ae(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new ae(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class te extends C{static getChecksumInstance(){return new te}}te.kind="ChecksumException";class xe{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class J{static arraycopy(e,t,n,r,i){for(;i--;)n[r++]=e[t++]}static currentTimeMillis(){return Date.now()}}class q extends C{}q.kind="IndexOutOfBoundsException";class ct extends q{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}ct.kind="ArrayIndexOutOfBoundsException";class fe{static fill(e,t){for(let n=0,r=e.length;n<r;n++)e[n]=t}static fillWithin(e,t,n,r){fe.rangeCheck(e.length,t,n);for(let i=t;i<n;i++)e[i]=r}static rangeCheck(e,t,n){if(t>n)throw new M("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new ct(t);if(n>e)throw new ct(n)}static asList(...e){return e}static create(e,t,n){return Array.from({length:e}).map(i=>Array.from({length:t}).fill(n))}static createInt32Array(e,t,n){return Array.from({length:e}).map(i=>Int32Array.from({length:t}).fill(n))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const n of e)t=31*t+n;return t}static fillUint8Array(e,t){for(let n=0;n!==e.length;n++)e[n]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)}static copyOfRange(e,t,n){const r=n-t,i=new Int32Array(r);return J.arraycopy(e,t,i,0,r),i}static binarySearch(e,t,n){n===void 0&&(n=fe.numberComparator);let r=0,i=e.length-1;for(;r<=i;){const s=i+r>>1,o=n(t,e[s]);if(o>0)r=s+1;else if(o<0)i=s-1;else return s}return-r-1}static numberComparator(e,t){return e-t}}class K{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}K.MIN_VALUE_32_BITS=-2147483648,K.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ce{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=ce.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=ce.makeArray(e);J.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=n[r];i&=~((1<<(e&31))-1);const s=n.length;for(;i===0;){if(++r===s)return t;i=n[r]}const o=r*32+K.numberOfTrailingZeros(i);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=~n[r];i&=~((1<<(e&31))-1);const s=n.length;for(;i===0;){if(++r===s)return t;i=~n[r]}const o=r*32+K.numberOfTrailingZeros(i);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new M;if(t===e)return;t--;const n=Math.floor(e/32),r=Math.floor(t/32),i=this.bits;for(let s=n;s<=r;s++){const o=s>n?0:e&31,l=(2<<(s<r?31:t&31))-(1<<o);i[s]|=l}}clear(){const e=this.bits.length,t=this.bits;for(let n=0;n<e;n++)t[n]=0}isRange(e,t,n){if(t<e||e<0||t>this.size)throw new M;if(t===e)return!0;t--;const r=Math.floor(e/32),i=Math.floor(t/32),s=this.bits;for(let o=r;o<=i;o++){const a=o>r?0:e&31,c=(2<<(o<i?31:t&31))-(1<<a)&4294967295;if((s[o]&c)!==(n?c:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new M("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let n=0;n<t;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new M("Sizes don't match");const t=this.bits;for(let n=0,r=t.length;n<r;n++)t[n]^=e.bits[n]}toBytes(e,t,n,r){for(let i=0;i<r;i++){let s=0;for(let o=0;o<8;o++)this.get(e)&&(s|=1<<7-o),e++;t[n+i]=s}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,r=this.bits;for(let i=0;i<n;i++){let s=r[i];s=s>>1&1431655765|(s&1431655765)<<1,s=s>>2&858993459|(s&858993459)<<2,s=s>>4&252645135|(s&252645135)<<4,s=s>>8&16711935|(s&16711935)<<8,s=s>>16&65535|(s&65535)<<16,e[t-i]=s}if(this.size!==n*32){const i=n*32-this.size;let s=e[0]>>>i;for(let o=1;o<n;o++){const a=e[o];s|=a<<32-i,e[o-1]=s,s=a>>>i}e[n-1]=s}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof ce))return!1;const t=e;return this.size===t.size&&fe.equals(this.bits,t.bits)}hashCode(){return 31*this.size+fe.hashCode(this.bits)}toString(){let e="";for(let t=0,n=this.size;t<n;t++)(t&7)===0&&(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new ce(this.size,this.bits.slice())}}var st;(function(f){f[f.OTHER=0]="OTHER",f[f.PURE_BARCODE=1]="PURE_BARCODE",f[f.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",f[f.TRY_HARDER=3]="TRY_HARDER",f[f.CHARACTER_SET=4]="CHARACTER_SET",f[f.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",f[f.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",f[f.ASSUME_GS1=7]="ASSUME_GS1",f[f.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",f[f.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",f[f.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(st||(st={}));var Ce=st;class U extends C{static getFormatInstance(){return new U}}U.kind="FormatException";var he;(function(f){f[f.Cp437=0]="Cp437",f[f.ISO8859_1=1]="ISO8859_1",f[f.ISO8859_2=2]="ISO8859_2",f[f.ISO8859_3=3]="ISO8859_3",f[f.ISO8859_4=4]="ISO8859_4",f[f.ISO8859_5=5]="ISO8859_5",f[f.ISO8859_6=6]="ISO8859_6",f[f.ISO8859_7=7]="ISO8859_7",f[f.ISO8859_8=8]="ISO8859_8",f[f.ISO8859_9=9]="ISO8859_9",f[f.ISO8859_10=10]="ISO8859_10",f[f.ISO8859_11=11]="ISO8859_11",f[f.ISO8859_13=12]="ISO8859_13",f[f.ISO8859_14=13]="ISO8859_14",f[f.ISO8859_15=14]="ISO8859_15",f[f.ISO8859_16=15]="ISO8859_16",f[f.SJIS=16]="SJIS",f[f.Cp1250=17]="Cp1250",f[f.Cp1251=18]="Cp1251",f[f.Cp1252=19]="Cp1252",f[f.Cp1256=20]="Cp1256",f[f.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",f[f.UTF8=22]="UTF8",f[f.ASCII=23]="ASCII",f[f.Big5=24]="Big5",f[f.GB18030=25]="GB18030",f[f.EUC_KR=26]="EUC_KR"})(he||(he={}));class G{constructor(e,t,n,...r){this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=r,G.VALUE_IDENTIFIER_TO_ECI.set(e,this),G.NAME_TO_ECI.set(n,this);const i=this.values;for(let s=0,o=i.length;s!==o;s++){const a=i[s];G.VALUES_TO_ECI.set(a,this)}for(const s of r)G.NAME_TO_ECI.set(s,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new U("incorect value");const t=G.VALUES_TO_ECI.get(e);if(t===void 0)throw new U("incorect value");return t}static getCharacterSetECIByName(e){const t=G.NAME_TO_ECI.get(e);if(t===void 0)throw new U("incorect value");return t}equals(e){if(!(e instanceof G))return!1;const t=e;return this.getName()===t.getName()}}G.VALUE_IDENTIFIER_TO_ECI=new Map,G.VALUES_TO_ECI=new Map,G.NAME_TO_ECI=new Map,G.Cp437=new G(he.Cp437,Int32Array.from([0,2]),"Cp437"),G.ISO8859_1=new G(he.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),G.ISO8859_2=new G(he.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),G.ISO8859_3=new G(he.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),G.ISO8859_4=new G(he.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),G.ISO8859_5=new G(he.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),G.ISO8859_6=new G(he.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),G.ISO8859_7=new G(he.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),G.ISO8859_8=new G(he.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),G.ISO8859_9=new G(he.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),G.ISO8859_10=new G(he.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),G.ISO8859_11=new G(he.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),G.ISO8859_13=new G(he.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),G.ISO8859_14=new G(he.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),G.ISO8859_15=new G(he.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),G.ISO8859_16=new G(he.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),G.SJIS=new G(he.SJIS,20,"SJIS","Shift_JIS"),G.Cp1250=new G(he.Cp1250,21,"Cp1250","windows-1250"),G.Cp1251=new G(he.Cp1251,22,"Cp1251","windows-1251"),G.Cp1252=new G(he.Cp1252,23,"Cp1252","windows-1252"),G.Cp1256=new G(he.Cp1256,24,"Cp1256","windows-1256"),G.UnicodeBigUnmarked=new G(he.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),G.UTF8=new G(he.UTF8,26,"UTF8","UTF-8"),G.ASCII=new G(he.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),G.Big5=new G(he.Big5,28,"Big5"),G.GB18030=new G(he.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),G.EUC_KR=new G(he.EUC_KR,30,"EUC_KR","EUC-KR");class bt extends C{}bt.kind="UnsupportedOperationException";class ze{static decode(e,t){const n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!ze.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof G?e:G.getCharacterSetECIByName(e)}static decodeFallback(e,t){const n=this.encodingCharacterSet(t);if(ze.isDecodeFallbackSupported(n)){let r="";for(let i=0,s=e.length;i<s;i++){let o=e[i].toString(16);o.length<2&&(o="0"+o),r+="%"+o}return decodeURIComponent(r)}if(n.equals(G.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new bt(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(G.UTF8)||e.equals(G.ISO8859_1)||e.equals(G.ASCII)}static encodeFallback(e){const n=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let i=0;i<n.length;i++)r.push(n[i].charCodeAt(0));return new Uint8Array(r)}}class ${static castAsNonUtf8Char(e,t=null){const n=t?t.getName():this.ISO88591;return ze.decode(new Uint8Array([e]),n)}static guessEncoding(e,t){if(t!=null&&t.get(Ce.CHARACTER_SET)!==void 0)return t.get(Ce.CHARACTER_SET).toString();const n=e.length;let r=!0,i=!0,s=!0,o=0,a=0,l=0,c=0,h=0,g=0,A=0,b=0,y=0,_=0,R=0;const H=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let W=0;W<n&&(r||i||s);W++){const V=e[W]&255;s&&(o>0?(V&128)===0?s=!1:o--:(V&128)!==0&&((V&64)===0?s=!1:(o++,(V&32)===0?a++:(o++,(V&16)===0?l++:(o++,(V&8)===0?c++:s=!1))))),r&&(V>127&&V<160?r=!1:V>159&&(V<192||V===215||V===247)&&R++),i&&(h>0?V<64||V===127||V>252?i=!1:h--:V===128||V===160||V>239?i=!1:V>160&&V<224?(g++,b=0,A++,A>y&&(y=A)):V>127?(h++,A=0,b++,b>_&&(_=b)):(A=0,b=0))}return s&&o>0&&(s=!1),i&&h>0&&(i=!1),s&&(H||a+l+c>0)?$.UTF8:i&&($.ASSUME_SHIFT_JIS||y>=3||_>=3)?$.SHIFT_JIS:r&&i?y===2&&g===2||R*10>=n?$.SHIFT_JIS:$.ISO88591:r?$.ISO88591:i?$.SHIFT_JIS:s?$.UTF8:$.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let n=-1;function r(s,o,a,l,c,h){if(s==="%%")return"%";if(t[++n]===void 0)return;s=l?parseInt(l.substr(1)):void 0;let g=c?parseInt(c.substr(1)):void 0,A;switch(h){case"s":A=t[n];break;case"c":A=t[n][0];break;case"f":A=parseFloat(t[n]).toFixed(s);break;case"p":A=parseFloat(t[n]).toPrecision(s);break;case"e":A=parseFloat(t[n]).toExponential(s);break;case"x":A=parseInt(t[n]).toString(g||16);break;case"d":A=parseFloat(parseInt(t[n],g||10).toPrecision(s)).toFixed(0);break}A=typeof A=="object"?JSON.stringify(A):(+A).toString(g);let b=parseInt(a),y=a&&a[0]+""=="0"?"0":" ";for(;A.length<b;)A=o!==void 0?A+y:y+A;return A}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}static getBytes(e,t){return ze.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}$.SHIFT_JIS=G.SJIS.getName(),$.GB2312="GB2312",$.ISO88591=G.ISO8859_1.getName(),$.EUC_JP="EUC_JP",$.UTF8=G.UTF8.getName(),$.PLATFORM_DEFAULT_ENCODING=$.UTF8,$.ASSUME_SHIFT_JIS=!1;class re{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=$.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,n){for(let r=t;t<t+n;r++)this.append(e[r]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class ye{constructor(e,t,n,r){if(this.width=e,this.height=t,this.rowSize=n,this.bits=r,t==null&&(t=e),this.height=t,e<1||t<1)throw new M("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,r==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,n=e[0].length,r=new ye(n,t);for(let i=0;i<t;i++){const s=e[i];for(let o=0;o<n;o++)s[o]&&r.set(o,i)}return r}static parseFromString(e,t,n){if(e===null)throw new M("stringRepresentation cannot be null");const r=new Array(e.length);let i=0,s=0,o=-1,a=0,l=0;for(;l<e.length;)if(e.charAt(l)===`
`||e.charAt(l)==="\r"){if(i>s){if(o===-1)o=i-s;else if(i-s!==o)throw new M("row lengths do not match");s=i,a++}l++}else if(e.substring(l,l+t.length)===t)l+=t.length,r[i]=!0,i++;else if(e.substring(l,l+n.length)===n)l+=n.length,r[i]=!1,i++;else throw new M("illegal character encountered: "+e.substring(l));if(i>s){if(o===-1)o=i-s;else if(i-s!==o)throw new M("row lengths do not match");a++}const c=new ye(o,a);for(let h=0;h<i;h++)r[h]&&c.set(Math.floor(h%o),Math.floor(h/o));return c}get(e,t){const n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0}set(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295}unset(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)}flip(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new M("input matrix dimensions do not match");const t=new ce(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits;for(let i=0,s=this.height;i<s;i++){const o=i*n,a=e.getRow(i,t).getBitArray();for(let l=0;l<n;l++)r[o+l]^=a[l]}}clear(){const e=this.bits,t=e.length;for(let n=0;n<t;n++)e[n]=0}setRegion(e,t,n,r){if(t<0||e<0)throw new M("Left and top must be nonnegative");if(r<1||n<1)throw new M("Height and width must be at least 1");const i=e+n,s=t+r;if(s>this.height||i>this.width)throw new M("The region must fit inside the matrix");const o=this.rowSize,a=this.bits;for(let l=t;l<s;l++){const c=l*o;for(let h=e;h<i;h++)a[c+Math.floor(h/32)]|=1<<(h&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new ce(this.width):t.clear();const n=this.rowSize,r=this.bits,i=e*n;for(let s=0;s<n;s++)t.setBulk(s*32,r[i+s]);return t}setRow(e,t){J.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let n=new ce(e),r=new ce(e);for(let i=0,s=Math.floor((t+1)/2);i<s;i++)n=this.getRow(i,n),r=this.getRow(t-1-i,r),n.reverse(),r.reverse(),this.setRow(i,r),this.setRow(t-1-i,n)}getEnclosingRectangle(){const e=this.width,t=this.height,n=this.rowSize,r=this.bits;let i=e,s=t,o=-1,a=-1;for(let l=0;l<t;l++)for(let c=0;c<n;c++){const h=r[l*n+c];if(h!==0){if(l<s&&(s=l),l>a&&(a=l),c*32<i){let g=0;for(;(h<<31-g&4294967295)===0;)g++;c*32+g<i&&(i=c*32+g)}if(c*32+31>o){let g=31;for(;!(h>>>g);)g--;c*32+g>o&&(o=c*32+g)}}}return o<i||a<s?null:Int32Array.from([i,s,o-i+1,a-s+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let n=0;for(;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;const r=n/e;let i=n%e*32;const s=t[n];let o=0;for(;(s<<31-o&4294967295)===0;)o++;return i+=o,Int32Array.from([i,r])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let n=t.length-1;for(;n>=0&&t[n]===0;)n--;if(n<0)return null;const r=Math.floor(n/e);let i=Math.floor(n%e)*32;const s=t[n];let o=31;for(;!(s>>>o);)o--;return i+=o,Int32Array.from([i,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof ye))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&fe.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+fe.hashCode(this.bits),e}toString(e="X ",t="  ",n=`
`){return this.buildToString(e,t,n)}buildToString(e,t,n){let r=new re;for(let i=0,s=this.height;i<s;i++){for(let o=0,a=this.width;o<a;o++)r.append(this.get(o,i)?e:t);r.append(n)}return r.toString()}clone(){return new ye(this.width,this.height,this.rowSize,this.bits.slice())}}class v extends C{static getNotFoundInstance(){return new v}}v.kind="NotFoundException";class Ie extends xe{constructor(e){super(e),this.luminances=Ie.EMPTY,this.buckets=new Int32Array(Ie.LUMINANCE_BUCKETS)}getBlackRow(e,t){const n=this.getLuminanceSource(),r=n.getWidth();t==null||t.getSize()<r?t=new ce(r):t.clear(),this.initArrays(r);const i=n.getRow(e,this.luminances),s=this.buckets;for(let a=0;a<r;a++)s[(i[a]&255)>>Ie.LUMINANCE_SHIFT]++;const o=Ie.estimateBlackPoint(s);if(r<3)for(let a=0;a<r;a++)(i[a]&255)<o&&t.set(a);else{let a=i[0]&255,l=i[1]&255;for(let c=1;c<r-1;c++){const h=i[c+1]&255;(l*4-a-h)/2<o&&t.set(c),a=l,l=h}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight(),r=new ye(t,n);this.initArrays(t);const i=this.buckets;for(let a=1;a<5;a++){const l=Math.floor(n*a/5),c=e.getRow(l,this.luminances),h=Math.floor(t*4/5);for(let g=Math.floor(t/5);g<h;g++){const A=c[g]&255;i[A>>Ie.LUMINANCE_SHIFT]++}}const s=Ie.estimateBlackPoint(i),o=e.getMatrix();for(let a=0;a<n;a++){const l=a*t;for(let c=0;c<t;c++)(o[l+c]&255)<s&&r.set(c,a)}return r}createBinarizer(e){return new Ie(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let n=0;n<Ie.LUMINANCE_BUCKETS;n++)t[n]=0}static estimateBlackPoint(e){const t=e.length;let n=0,r=0,i=0;for(let c=0;c<t;c++)e[c]>i&&(r=c,i=e[c]),e[c]>n&&(n=e[c]);let s=0,o=0;for(let c=0;c<t;c++){const h=c-r,g=e[c]*h*h;g>o&&(s=c,o=g)}if(r>s){const c=r;r=s,s=c}if(s-r<=t/16)throw new v;let a=s-1,l=-1;for(let c=s-1;c>r;c--){const h=c-r,g=h*h*(s-c)*(n-e[c]);g>l&&(a=c,l=g)}return a<<Ie.LUMINANCE_SHIFT}}Ie.LUMINANCE_BITS=5,Ie.LUMINANCE_SHIFT=8-Ie.LUMINANCE_BITS,Ie.LUMINANCE_BUCKETS=1<<Ie.LUMINANCE_BITS,Ie.EMPTY=Uint8ClampedArray.from([0]);class oe extends Ie{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight();if(t>=oe.MINIMUM_DIMENSION&&n>=oe.MINIMUM_DIMENSION){const r=e.getMatrix();let i=t>>oe.BLOCK_SIZE_POWER;(t&oe.BLOCK_SIZE_MASK)!==0&&i++;let s=n>>oe.BLOCK_SIZE_POWER;(n&oe.BLOCK_SIZE_MASK)!==0&&s++;const o=oe.calculateBlackPoints(r,i,s,t,n),a=new ye(t,n);oe.calculateThresholdForBlock(r,i,s,t,n,o,a),this.matrix=a}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new oe(e)}static calculateThresholdForBlock(e,t,n,r,i,s,o){const a=i-oe.BLOCK_SIZE,l=r-oe.BLOCK_SIZE;for(let c=0;c<n;c++){let h=c<<oe.BLOCK_SIZE_POWER;h>a&&(h=a);const g=oe.cap(c,2,n-3);for(let A=0;A<t;A++){let b=A<<oe.BLOCK_SIZE_POWER;b>l&&(b=l);const y=oe.cap(A,2,t-3);let _=0;for(let H=-2;H<=2;H++){const W=s[g+H];_+=W[y-2]+W[y-1]+W[y]+W[y+1]+W[y+2]}const R=_/25;oe.thresholdBlock(e,b,h,R,r,o)}}}static cap(e,t,n){return e<t?t:e>n?n:e}static thresholdBlock(e,t,n,r,i,s){for(let o=0,a=n*i+t;o<oe.BLOCK_SIZE;o++,a+=i)for(let l=0;l<oe.BLOCK_SIZE;l++)(e[a+l]&255)<=r&&s.set(t+l,n+o)}static calculateBlackPoints(e,t,n,r,i){const s=i-oe.BLOCK_SIZE,o=r-oe.BLOCK_SIZE,a=new Array(n);for(let l=0;l<n;l++){a[l]=new Int32Array(t);let c=l<<oe.BLOCK_SIZE_POWER;c>s&&(c=s);for(let h=0;h<t;h++){let g=h<<oe.BLOCK_SIZE_POWER;g>o&&(g=o);let A=0,b=255,y=0;for(let R=0,H=c*r+g;R<oe.BLOCK_SIZE;R++,H+=r){for(let W=0;W<oe.BLOCK_SIZE;W++){const V=e[H+W]&255;A+=V,V<b&&(b=V),V>y&&(y=V)}if(y-b>oe.MIN_DYNAMIC_RANGE)for(R++,H+=r;R<oe.BLOCK_SIZE;R++,H+=r)for(let W=0;W<oe.BLOCK_SIZE;W++)A+=e[H+W]&255}let _=A>>oe.BLOCK_SIZE_POWER*2;if(y-b<=oe.MIN_DYNAMIC_RANGE&&(_=b/2,l>0&&h>0)){const R=(a[l-1][h]+2*a[l][h-1]+a[l-1][h-1])/4;b<R&&(_=R)}a[l][h]=_}}return a}}oe.BLOCK_SIZE_POWER=3,oe.BLOCK_SIZE=1<<oe.BLOCK_SIZE_POWER,oe.BLOCK_SIZE_MASK=oe.BLOCK_SIZE-1,oe.MINIMUM_DIMENSION=oe.BLOCK_SIZE*5,oe.MIN_DYNAMIC_RANGE=24;class _t{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,n,r){throw new bt("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new bt("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new bt("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new re;for(let n=0;n<this.height;n++){const r=this.getRow(n,e);for(let i=0;i<this.width;i++){const s=r[i]&255;let o;s<64?o="#":s<128?o="+":s<192?o=".":o=" ",t.append(o)}t.append(`
`)}return t.toString()}}class Qe extends _t{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const n=this.delegate.getRow(e,t),r=this.getWidth();for(let i=0;i<r;i++)n[i]=255-(n[i]&255);return n}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t);for(let r=0;r<t;r++)n[r]=255-(e[r]&255);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,n,r){return new Qe(this.delegate.crop(e,t,n,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Qe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Qe(this.delegate.rotateCounterClockwise45())}}class ut extends _t{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=ut.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return ut.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,n){const r=new Uint8ClampedArray(t*n);for(let i=0,s=0,o=e.length;i<o;i+=4,s++){let a;if(e[i+3]===0)a=255;else{const c=e[i],h=e[i+1],g=e[i+2];a=306*c+601*h+117*g+512>>10}r[s]=a}return r}getRow(e,t){if(e<0||e>=this.getHeight())throw new M("Requested row is outside the image: "+e);const n=this.getWidth(),r=e*n;return t===null?t=this.buffer.slice(r,r+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(r,r+n))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,n,r){return super.crop(e,t,n,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),n=t.getContext("2d"),r=e*ut.DEGREE_TO_RADIANS,i=this.canvas.width,s=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(r))*i+Math.abs(Math.sin(r))*s),a=Math.ceil(Math.abs(Math.sin(r))*i+Math.abs(Math.cos(r))*s);return t.width=o,t.height=a,n.translate(o/2,a/2),n.rotate(r),n.drawImage(this.canvas,i/-2,s/-2),this.buffer=ut.makeBufferFromCanvasImageData(t),this}invert(){return new Qe(this)}}ut.DEGREE_TO_RADIANS=Math.PI/180;class an{constructor(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ye=(globalThis||Qt||self||window||void 0)&&(globalThis||Qt||self||window||void 0).__awaiter||function(f,e,t,n){function r(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function a(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?i(c.value):r(c.value).then(o,a)}l((n=n.apply(f,e||[])).next())})};class et{constructor(e,t=500,n){this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return Ye(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const n of e){const r=n.kind==="video"?"videoinput":n.kind;if(r!=="videoinput")continue;const i=n.deviceId||n.id,s=n.label||`Video device ${t.length+1}`,o=n.groupId,a={deviceId:i,label:s,kind:r,groupId:o};t.push(a)}return t})}getVideoInputDevices(){return Ye(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new an(t.deviceId,t.label))})}findDeviceById(e){return Ye(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(n=>n.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return Ye(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return Ye(this,void 0,void 0,function*(){this.reset();let n;e?n={deviceId:{exact:e}}:n={facingMode:"environment"};const r={video:n};return yield this.decodeOnceFromConstraints(r,t)})}decodeOnceFromConstraints(e,t){return Ye(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,t)})}decodeOnceFromStream(e,t){return Ye(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(n)})}decodeFromInputVideoDeviceContinuously(e,t,n){return Ye(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,n)})}decodeFromVideoDevice(e,t,n){return Ye(this,void 0,void 0,function*(){let r;e?r={deviceId:{exact:e}}:r={facingMode:"environment"};const i={video:r};return yield this.decodeFromConstraints(i,t,n)})}decodeFromConstraints(e,t,n){return Ye(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(r,t,n)})}decodeFromStream(e,t,n){return Ye(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(r,n)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return Ye(this,void 0,void 0,function*(){const n=this.prepareVideoElement(t);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n})}playVideoOnLoadAsync(e){return new Promise((t,n)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return Ye(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const n=document.getElementById(e);if(!n)throw new P(`element with id '${e}' not found`);if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new P(`element with id '${e}' must be an ${t} element`);return n}decodeFromImage(e,t){if(!e&&!t)throw new P("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new P("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,n){if(e===void 0&&t===void 0)throw new P("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new P("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)}_decodeFromVideoElementSetup(e){if(!e)throw new P("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new P("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const n=this._decodeOnLoadImage(t);return t.src=e,n}decodeFromVideoUrl(e){if(!e)throw new P("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n}decodeFromVideoUrlContinuously(e,t){if(!e)throw new P("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(n,t);return n.src=e,r}_decodeOnLoadImage(e){return new Promise((t,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,n),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return Ye(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return Ye(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,n=!0){this._stopAsyncDecode=!1;const r=(i,s)=>{if(this._stopAsyncDecode){s(new v("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const o=this.decode(e);i(o)}catch(o){const a=t&&o instanceof v,c=(o instanceof te||o instanceof U)&&n;if(a||c)return setTimeout(r,this._timeBetweenDecodingAttempts,i,s);s(o)}};return new Promise((i,s)=>r(i,s))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const r=this.decode(e);t(r,null),setTimeout(n,this.timeBetweenScansMillis)}catch(r){t(null,r);const i=r instanceof te||r instanceof U,s=r instanceof v;(i||s)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,t,n){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,n=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),n=new ut(t),r=new oe(n);return new ae(r)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const n=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=n}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let n,r;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,r=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,r=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=r+"px",t.width=n,t.height=r,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class D{constructor(e,t,n=t==null?0:8*t.length,r,i,s=J.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=r,this.format=i,this.timestamp=s,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=r,this.format=i,this.resultMetadata=null,s==null?this.timestamp=J.currentTimeMillis():this.timestamp=s}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const n=new Array(t.length+e.length);J.arraycopy(t,0,n,0,t.length),J.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}var I;(function(f){f[f.AZTEC=0]="AZTEC",f[f.CODABAR=1]="CODABAR",f[f.CODE_39=2]="CODE_39",f[f.CODE_93=3]="CODE_93",f[f.CODE_128=4]="CODE_128",f[f.DATA_MATRIX=5]="DATA_MATRIX",f[f.EAN_8=6]="EAN_8",f[f.EAN_13=7]="EAN_13",f[f.ITF=8]="ITF",f[f.MAXICODE=9]="MAXICODE",f[f.PDF_417=10]="PDF_417",f[f.QR_CODE=11]="QR_CODE",f[f.RSS_14=12]="RSS_14",f[f.RSS_EXPANDED=13]="RSS_EXPANDED",f[f.UPC_A=14]="UPC_A",f[f.UPC_E=15]="UPC_E",f[f.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(I||(I={}));var B=I,ee;(function(f){f[f.OTHER=0]="OTHER",f[f.ORIENTATION=1]="ORIENTATION",f[f.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",f[f.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",f[f.ISSUE_NUMBER=4]="ISSUE_NUMBER",f[f.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",f[f.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",f[f.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",f[f.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",f[f.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",f[f.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ee||(ee={}));var de=ee;class gt{constructor(e,t,n,r,i=-1,s=-1){this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=s,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class En{exp(e){return this.expTable[e]}log(e){if(e===0)throw new M;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class xt{constructor(e,t){if(t.length===0)throw new M;this.field=e;const n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-r),J.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let n;if(e===1){n=0;for(let s=0,o=t.length;s!==o;s++){const a=t[s];n=En.addOrSubtract(n,a)}return n}n=t[0];const r=t.length,i=this.field;for(let s=1;s<r;s++)n=En.addOrSubtract(i.multiply(e,n),t[s]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new M("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){const s=t;t=n,n=s}let r=new Int32Array(n.length);const i=n.length-t.length;J.arraycopy(n,0,r,0,i);for(let s=i;s<n.length;s++)r[s]=En.addOrSubtract(t[s-i],n[s]);return new xt(this.field,r)}multiply(e){if(!this.field.equals(e.field))throw new M("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Int32Array(n+i-1),o=this.field;for(let a=0;a<n;a++){const l=t[a];for(let c=0;c<i;c++)s[a+c]=En.addOrSubtract(s[a+c],o.multiply(l,r[c]))}return new xt(o,s)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,n=this.field,r=new Int32Array(t),i=this.coefficients;for(let s=0;s<t;s++)r[s]=n.multiply(i[s],e);return new xt(n,r)}multiplyByMonomial(e,t){if(e<0)throw new M;if(t===0)return this.field.getZero();const n=this.coefficients,r=n.length,i=new Int32Array(r+e),s=this.field;for(let o=0;o<r;o++)i[o]=s.multiply(n[o],t);return new xt(s,i)}divide(e){if(!this.field.equals(e.field))throw new M("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new M("Divide by 0");const t=this.field;let n=t.getZero(),r=this;const i=e.getCoefficient(e.getDegree()),s=t.inverse(i);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const o=r.getDegree()-e.getDegree(),a=t.multiply(r.getCoefficient(r.getDegree()),s),l=e.multiplyByMonomial(o,a),c=t.buildMonomial(o,a);n=n.addOrSubtract(c),r=r.addOrSubtract(l)}return[n,r]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){const r=this.field.log(n);r===0?e+="1":r===1?e+="a":(e+="a^",e+=r)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class Bn extends C{}Bn.kind="ArithmeticException";class _e extends En{constructor(e,t,n){super(),this.primitive=e,this.size=t,this.generatorBase=n;const r=new Int32Array(t);let i=1;for(let o=0;o<t;o++)r[o]=i,i*=2,i>=t&&(i^=e,i&=t-1);this.expTable=r;const s=new Int32Array(t);for(let o=0;o<t-1;o++)s[r[o]]=o;this.logTable=s,this.zero=new xt(this,Int32Array.from([0])),this.one=new xt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new M;if(t===0)return this.zero;const n=new Int32Array(e+1);return n[0]=t,new xt(this,n)}inverse(e){if(e===0)throw new Bn;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+K.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}_e.AZTEC_DATA_12=new _e(4201,4096,1),_e.AZTEC_DATA_10=new _e(1033,1024,1),_e.AZTEC_DATA_6=new _e(67,64,1),_e.AZTEC_PARAM=new _e(19,16,1),_e.QR_CODE_FIELD_256=new _e(285,256,0),_e.DATA_MATRIX_FIELD_256=new _e(301,256,1),_e.AZTEC_DATA_8=_e.DATA_MATRIX_FIELD_256,_e.MAXICODE_FIELD_64=_e.AZTEC_DATA_6;class ln extends C{}ln.kind="ReedSolomonException";class Mt extends C{}Mt.kind="IllegalStateException";class bn{constructor(e){this.field=e}decode(e,t){const n=this.field,r=new xt(n,e),i=new Int32Array(t);let s=!0;for(let A=0;A<t;A++){const b=r.evaluateAt(n.exp(A+n.getGeneratorBase()));i[i.length-1-A]=b,b!==0&&(s=!1)}if(s)return;const o=new xt(n,i),a=this.runEuclideanAlgorithm(n.buildMonomial(t,1),o,t),l=a[0],c=a[1],h=this.findErrorLocations(l),g=this.findErrorMagnitudes(c,h);for(let A=0;A<h.length;A++){const b=e.length-1-n.log(h[A]);if(b<0)throw new ln("Bad error location");e[b]=_e.addOrSubtract(e[b],g[A])}}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){const A=e;e=t,t=A}const r=this.field;let i=e,s=t,o=r.getZero(),a=r.getOne();for(;s.getDegree()>=(n/2|0);){let A=i,b=o;if(i=s,o=a,i.isZero())throw new ln("r_{i-1} was zero");s=A;let y=r.getZero();const _=i.getCoefficient(i.getDegree()),R=r.inverse(_);for(;s.getDegree()>=i.getDegree()&&!s.isZero();){const H=s.getDegree()-i.getDegree(),W=r.multiply(s.getCoefficient(s.getDegree()),R);y=y.addOrSubtract(r.buildMonomial(H,W)),s=s.addOrSubtract(i.multiplyByMonomial(H,W))}if(a=y.multiply(o).addOrSubtract(b),s.getDegree()>=i.getDegree())throw new Mt("Division algorithm failed to reduce polynomial?")}const l=a.getCoefficient(0);if(l===0)throw new ln("sigmaTilde(0) was zero");const c=r.inverse(l),h=a.multiplyScalar(c),g=s.multiplyScalar(c);return[h,g]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(t);let r=0;const i=this.field;for(let s=1;s<i.getSize()&&r<t;s++)e.evaluateAt(s)===0&&(n[r]=i.inverse(s),r++);if(r!==t)throw new ln("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,t){const n=t.length,r=new Int32Array(n),i=this.field;for(let s=0;s<n;s++){const o=i.inverse(t[s]);let a=1;for(let l=0;l<n;l++)if(s!==l){const c=i.multiply(t[l],o),h=(c&1)===0?c|1:c&-2;a=i.multiply(a,h)}r[s]=i.multiply(e.evaluateAt(o),i.inverse(a)),i.getGeneratorBase()!==0&&(r[s]=i.multiply(r[s],o))}return r}}var tt;(function(f){f[f.UPPER=0]="UPPER",f[f.LOWER=1]="LOWER",f[f.MIXED=2]="MIXED",f[f.DIGIT=3]="DIGIT",f[f.PUNCT=4]="PUNCT",f[f.BINARY=5]="BINARY"})(tt||(tt={}));class Me{decode(e){this.ddata=e;let t=e.getBits(),n=this.extractBits(t),r=this.correctBits(n),i=Me.convertBoolArrayToByteArray(r),s=Me.getEncodedData(r),o=new gt(i,s,null,null);return o.setNumBits(r.length),o}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,n=tt.UPPER,r=tt.UPPER,i="",s=0;for(;s<t;)if(r===tt.BINARY){if(t-s<5)break;let o=Me.readCode(e,s,5);if(s+=5,o===0){if(t-s<11)break;o=Me.readCode(e,s,11)+31,s+=11}for(let a=0;a<o;a++){if(t-s<8){s=t;break}const l=Me.readCode(e,s,8);i+=$.castAsNonUtf8Char(l),s+=8}r=n}else{let o=r===tt.DIGIT?4:5;if(t-s<o)break;let a=Me.readCode(e,s,o);s+=o;let l=Me.getCharacter(r,a);l.startsWith("CTRL_")?(n=r,r=Me.getTable(l.charAt(5)),l.charAt(6)==="L"&&(n=r)):(i+=l,r=n)}return i}static getTable(e){switch(e){case"L":return tt.LOWER;case"P":return tt.PUNCT;case"M":return tt.MIXED;case"D":return tt.DIGIT;case"B":return tt.BINARY;case"U":default:return tt.UPPER}}static getCharacter(e,t){switch(e){case tt.UPPER:return Me.UPPER_TABLE[t];case tt.LOWER:return Me.LOWER_TABLE[t];case tt.MIXED:return Me.MIXED_TABLE[t];case tt.PUNCT:return Me.PUNCT_TABLE[t];case tt.DIGIT:return Me.DIGIT_TABLE[t];default:throw new Mt("Bad table")}}correctBits(e){let t,n;this.ddata.getNbLayers()<=2?(n=6,t=_e.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=_e.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=_e.AZTEC_DATA_10):(n=12,t=_e.AZTEC_DATA_12);let r=this.ddata.getNbDatablocks(),i=e.length/n;if(i<r)throw new U;let s=e.length%n,o=new Int32Array(i);for(let g=0;g<i;g++,s+=n)o[g]=Me.readCode(e,s,n);try{new bn(t).decode(o,i-r)}catch(g){throw new U(g)}let a=(1<<n)-1,l=0;for(let g=0;g<r;g++){let A=o[g];if(A===0||A===a)throw new U;(A===1||A===a-1)&&l++}let c=new Array(r*n-l),h=0;for(let g=0;g<r;g++){let A=o[g];if(A===1||A===a-1)c.fill(A>1,h,h+n-1),h+=n-1;else for(let b=n-1;b>=0;--b)c[h++]=(A&1<<b)!==0}return c}extractBits(e){let t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(t?11:14)+n*4,i=new Int32Array(r),s=new Array(this.totalBitsInLayer(n,t));if(t)for(let o=0;o<i.length;o++)i[o]=o;else{let o=r+1+2*K.truncDivision(K.truncDivision(r,2)-1,15),a=r/2,l=K.truncDivision(o,2);for(let c=0;c<a;c++){let h=c+K.truncDivision(c,15);i[a-c-1]=l-h-1,i[a+c]=l+h+1}}for(let o=0,a=0;o<n;o++){let l=(n-o)*4+(t?9:12),c=o*2,h=r-1-c;for(let g=0;g<l;g++){let A=g*2;for(let b=0;b<2;b++)s[a+A+b]=e.get(i[c+b],i[c+g]),s[a+2*l+A+b]=e.get(i[c+g],i[h-b]),s[a+4*l+A+b]=e.get(i[h-b],i[h-g]),s[a+6*l+A+b]=e.get(i[h-g],i[c+b])}a+=l*8}return s}static readCode(e,t,n){let r=0;for(let i=t;i<t+n;i++)r<<=1,e[i]&&(r|=1);return r}static readByte(e,t){let n=e.length-t;return n>=8?Me.readCode(e,t,8):Me.readCode(e,t,n)<<8-n}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let n=0;n<t.length;n++)t[n]=Me.readByte(e,8*n);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Me.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Me.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Me.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Me.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Me.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Ee{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,n,r){const i=e-n,s=t-r;return Math.sqrt(i*i+s*s)}static sum(e){let t=0;for(let n=0,r=e.length;n!==r;n++){const i=e[n];t+=i}return t}}class kn{static floatToIntBits(e){return e}}kn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Z{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof Z){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*kn.floatToIntBits(this.x)+kn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),r=this.distance(e[0],e[2]);let i,s,o;if(n>=t&&n>=r?(s=e[0],i=e[1],o=e[2]):r>=n&&r>=t?(s=e[1],i=e[0],o=e[2]):(s=e[2],i=e[0],o=e[1]),this.crossProductZ(i,s,o)<0){const a=i;i=o,o=a}e[0]=i,e[1]=s,e[2]=o}static distance(e,t){return Ee.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,n){const r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}}class Pn{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Dr extends Pn{constructor(e,t,n,r,i){super(e,t),this.compact=n,this.nbDatablocks=r,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Vt{constructor(e,t,n,r){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=Vt.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),r==null&&(r=e.getHeight()/2|0);const i=t/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=r-i,this.downInit=r+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new v}detect(){let e=this.leftInit,t=this.rightInit,n=this.upInit,r=this.downInit,i=!1,s=!0,o=!1,a=!1,l=!1,c=!1,h=!1;const g=this.width,A=this.height;for(;s;){s=!1;let b=!0;for(;(b||!a)&&t<g;)b=this.containsBlackPoint(n,r,t,!1),b?(t++,s=!0,a=!0):a||t++;if(t>=g){i=!0;break}let y=!0;for(;(y||!l)&&r<A;)y=this.containsBlackPoint(e,t,r,!0),y?(r++,s=!0,l=!0):l||r++;if(r>=A){i=!0;break}let _=!0;for(;(_||!c)&&e>=0;)_=this.containsBlackPoint(n,r,e,!1),_?(e--,s=!0,c=!0):c||e--;if(e<0){i=!0;break}let R=!0;for(;(R||!h)&&n>=0;)R=this.containsBlackPoint(e,t,n,!0),R?(n--,s=!0,h=!0):h||n--;if(n<0){i=!0;break}s&&(o=!0)}if(!i&&o){const b=t-e;let y=null;for(let W=1;y===null&&W<b;W++)y=this.getBlackPointOnSegment(e,r-W,e+W,r);if(y==null)throw new v;let _=null;for(let W=1;_===null&&W<b;W++)_=this.getBlackPointOnSegment(e,n+W,e+W,n);if(_==null)throw new v;let R=null;for(let W=1;R===null&&W<b;W++)R=this.getBlackPointOnSegment(t,n+W,t-W,n);if(R==null)throw new v;let H=null;for(let W=1;H===null&&W<b;W++)H=this.getBlackPointOnSegment(t,r-W,t-W,r);if(H==null)throw new v;return this.centerEdges(H,y,R,_)}else throw new v}getBlackPointOnSegment(e,t,n,r){const i=Ee.round(Ee.distance(e,t,n,r)),s=(n-e)/i,o=(r-t)/i,a=this.image;for(let l=0;l<i;l++){const c=Ee.round(e+l*s),h=Ee.round(t+l*o);if(a.get(c,h))return new Z(c,h)}return null}centerEdges(e,t,n,r){const i=e.getX(),s=e.getY(),o=t.getX(),a=t.getY(),l=n.getX(),c=n.getY(),h=r.getX(),g=r.getY(),A=Vt.CORR;return i<this.width/2?[new Z(h-A,g+A),new Z(o+A,a+A),new Z(l-A,c-A),new Z(i+A,s-A)]:[new Z(h+A,g+A),new Z(o+A,a-A),new Z(l-A,c+A),new Z(i-A,s-A)]}containsBlackPoint(e,t,n,r){const i=this.image;if(r){for(let s=e;s<=t;s++)if(i.get(s,n))return!0}else for(let s=e;s<=t;s++)if(i.get(n,s))return!0;return!1}}Vt.INIT_SIZE=10,Vt.CORR=1;class Kn{static checkAndNudgePoints(e,t){const n=e.getWidth(),r=e.getHeight();let i=!0;for(let s=0;s<t.length&&i;s+=2){const o=Math.floor(t[s]),a=Math.floor(t[s+1]);if(o<-1||o>n||a<-1||a>r)throw new v;i=!1,o===-1?(t[s]=0,i=!0):o===n&&(t[s]=n-1,i=!0),a===-1?(t[s+1]=0,i=!0):a===r&&(t[s+1]=r-1,i=!0)}i=!0;for(let s=t.length-2;s>=0&&i;s-=2){const o=Math.floor(t[s]),a=Math.floor(t[s+1]);if(o<-1||o>n||a<-1||a>r)throw new v;i=!1,o===-1?(t[s]=0,i=!0):o===n&&(t[s]=n-1,i=!0),a===-1?(t[s+1]=0,i=!0):a===r&&(t[s+1]=r-1,i=!0)}}}class Rt{constructor(e,t,n,r,i,s,o,a,l){this.a11=e,this.a21=t,this.a31=n,this.a12=r,this.a22=i,this.a32=s,this.a13=o,this.a23=a,this.a33=l}static quadrilateralToQuadrilateral(e,t,n,r,i,s,o,a,l,c,h,g,A,b,y,_){const R=Rt.quadrilateralToSquare(e,t,n,r,i,s,o,a);return Rt.squareToQuadrilateral(l,c,h,g,A,b,y,_).times(R)}transformPoints(e){const t=e.length,n=this.a11,r=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,l=this.a31,c=this.a32,h=this.a33;for(let g=0;g<t;g+=2){const A=e[g],b=e[g+1],y=i*A+a*b+h;e[g]=(n*A+s*b+l)/y,e[g+1]=(r*A+o*b+c)/y}}transformPointsWithValues(e,t){const n=this.a11,r=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,l=this.a31,c=this.a32,h=this.a33,g=e.length;for(let A=0;A<g;A++){const b=e[A],y=t[A],_=i*b+a*y+h;e[A]=(n*b+s*y+l)/_,t[A]=(r*b+o*y+c)/_}}static squareToQuadrilateral(e,t,n,r,i,s,o,a){const l=e-n+i-o,c=t-r+s-a;if(l===0&&c===0)return new Rt(n-e,i-n,e,r-t,s-r,t,0,0,1);{const h=n-i,g=o-i,A=r-s,b=a-s,y=h*b-g*A,_=(l*b-g*c)/y,R=(h*c-l*A)/y;return new Rt(n-e+_*n,o-e+R*o,e,r-t+_*r,a-t+R*a,t,_,R,1)}}static quadrilateralToSquare(e,t,n,r,i,s,o,a){return Rt.squareToQuadrilateral(e,t,n,r,i,s,o,a).buildAdjoint()}buildAdjoint(){return new Rt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new Rt(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class Mr extends Kn{sampleGrid(e,t,n,r,i,s,o,a,l,c,h,g,A,b,y,_,R,H,W){const V=Rt.quadrilateralToQuadrilateral(r,i,s,o,a,l,c,h,g,A,b,y,_,R,H,W);return this.sampleGridWithTransform(e,t,n,V)}sampleGridWithTransform(e,t,n,r){if(t<=0||n<=0)throw new v;const i=new ye(t,n),s=new Float32Array(2*t);for(let o=0;o<n;o++){const a=s.length,l=o+.5;for(let c=0;c<a;c+=2)s[c]=c/2+.5,s[c+1]=l;r.transformPoints(s),Kn.checkAndNudgePoints(e,s);try{for(let c=0;c<a;c+=2)e.get(Math.floor(s[c]),Math.floor(s[c+1]))&&i.set(c/2,o)}catch{throw new v}}return i}}class Ht{static setGridSampler(e){Ht.gridSampler=e}static getInstance(){return Ht.gridSampler}}Ht.gridSampler=new Mr;class ft{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new Z(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Br{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){let s=n[0];n[0]=n[2],n[2]=s}this.extractParameters(n);let r=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),i=this.getMatrixCornerPoints(n);return new Dr(r,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new v;let t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);let r=0;for(let s=0;s<4;s++){let o=n[(this.shift+s)%4];this.compact?(r<<=7,r+=o>>1&127):(r<<=10,r+=(o>>2&992)+(o>>1&31))}let i=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=(i>>6)+1,this.nbDataBlocks=(i&63)+1):(this.nbLayers=(i>>11)+1,this.nbDataBlocks=(i&2047)+1)}getRotation(e,t){let n=0;e.forEach((r,i,s)=>{let o=(r>>t-2<<1)+(r&1);n=(n<<3)+o}),n=((n&1)<<11)+(n>>1);for(let r=0;r<4;r++)if(K.bitCount(n^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new v}getCorrectedParameterData(e,t){let n,r;t?(n=7,r=2):(n=10,r=4);let i=n-r,s=new Int32Array(n);for(let a=n-1;a>=0;--a)s[a]=e&15,e>>=4;try{new bn(_e.AZTEC_PARAM).decode(s,i)}catch{throw new v}let o=0;for(let a=0;a<r;a++)o=(o<<4)+s[a];return o}getBullsEyeCorners(e){let t=e,n=e,r=e,i=e,s=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let h=this.getFirstDifferent(t,s,1,-1),g=this.getFirstDifferent(n,s,1,1),A=this.getFirstDifferent(r,s,-1,1),b=this.getFirstDifferent(i,s,-1,-1);if(this.nbCenterLayers>2){let y=this.distancePoint(b,h)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(y<.75||y>1.25||!this.isWhiteOrBlackRectangle(h,g,A,b))break}t=h,n=g,r=A,i=b,s=!s}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new v;this.compact=this.nbCenterLayers===5;let o=new Z(t.getX()+.5,t.getY()-.5),a=new Z(n.getX()+.5,n.getY()+.5),l=new Z(r.getX()-.5,r.getY()+.5),c=new Z(i.getX()-.5,i.getY()-.5);return this.expandSquare([o,a,l,c],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,n,r;try{let o=new Vt(this.image).detect();e=o[0],t=o[1],n=o[2],r=o[3]}catch{let a=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new ft(a+7,l-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new ft(a+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new ft(a-7,l+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new ft(a-7,l-7),!1,-1,-1).toResultPoint()}let i=Ee.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=Ee.round((e.getY()+r.getY()+t.getY()+n.getY())/4);try{let o=new Vt(this.image,15,i,s).detect();e=o[0],t=o[1],n=o[2],r=o[3]}catch{e=this.getFirstDifferent(new ft(i+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new ft(i+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new ft(i-7,s+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new ft(i-7,s-7),!1,-1,-1).toResultPoint()}return i=Ee.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=Ee.round((e.getY()+r.getY()+t.getY()+n.getY())/4),new ft(i,s)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,n,r,i){let s=Ht.getInstance(),o=this.getDimension(),a=o/2-this.nbCenterLayers,l=o/2+this.nbCenterLayers;return s.sampleGrid(e,o,o,a,a,l,a,l,l,a,l,t.getX(),t.getY(),n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY())}sampleLine(e,t,n){let r=0,i=this.distanceResultPoint(e,t),s=i/n,o=e.getX(),a=e.getY(),l=s*(t.getX()-e.getX())/i,c=s*(t.getY()-e.getY())/i;for(let h=0;h<n;h++)this.image.get(Ee.round(o+h*l),Ee.round(a+h*c))&&(r|=1<<n-h-1);return r}isWhiteOrBlackRectangle(e,t,n,r){let i=3;e=new ft(e.getX()-i,e.getY()+i),t=new ft(t.getX()-i,t.getY()-i),n=new ft(n.getX()+i,n.getY()-i),r=new ft(r.getX()+i,r.getY()+i);let s=this.getColor(r,e);if(s===0)return!1;let o=this.getColor(e,t);return o!==s||(o=this.getColor(t,n),o!==s)?!1:(o=this.getColor(n,r),o===s)}getColor(e,t){let n=this.distancePoint(e,t),r=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,s=0,o=e.getX(),a=e.getY(),l=this.image.get(e.getX(),e.getY()),c=Math.ceil(n);for(let g=0;g<c;g++)o+=r,a+=i,this.image.get(Ee.round(o),Ee.round(a))!==l&&s++;let h=s/n;return h>.1&&h<.9?0:h<=.1===l?1:-1}getFirstDifferent(e,t,n,r){let i=e.getX()+n,s=e.getY()+r;for(;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=n,s+=r;for(i-=n,s-=r;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=n;for(i-=n;this.isValid(i,s)&&this.image.get(i,s)===t;)s+=r;return s-=r,new ft(i,s)}expandSquare(e,t,n){let r=n/(2*t),i=e[0].getX()-e[2].getX(),s=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,a=(e[0].getY()+e[2].getY())/2,l=new Z(o+r*i,a+r*s),c=new Z(o-r*i,a-r*s);i=e[1].getX()-e[3].getX(),s=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,a=(e[1].getY()+e[3].getY())/2;let h=new Z(o+r*i,a+r*s),g=new Z(o-r*i,a-r*s);return[l,h,c,g]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=Ee.round(e.getX()),n=Ee.round(e.getY());return this.isValid(t,n)}distancePoint(e,t){return Ee.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return Ee.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(K.truncDivision(this.nbLayers-4,8)+1)+15}}class Ln{decode(e,t=null){let n=null,r=new Br(e.getBlackMatrix()),i=null,s=null;try{let c=r.detectMirror(!1);i=c.getPoints(),this.reportFoundResultPoints(t,i),s=new Me().decode(c)}catch(c){n=c}if(s==null)try{let c=r.detectMirror(!0);i=c.getPoints(),this.reportFoundResultPoints(t,i),s=new Me().decode(c)}catch(c){throw n??c}let o=new D(s.getText(),s.getRawBytes(),s.getNumBits(),i,B.AZTEC,J.currentTimeMillis()),a=s.getByteSegments();a!=null&&o.putMetadata(de.BYTE_SEGMENTS,a);let l=s.getECLevel();return l!=null&&o.putMetadata(de.ERROR_CORRECTION_LEVEL,l),o}reportFoundResultPoints(e,t){if(e!=null){let n=e.get(Ce.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach((r,i,s)=>{n.foundPossibleResultPoint(r)})}}reset(){}}class Bi extends et{constructor(e=500){super(new Ln,e)}}class je{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get(Ce.TRY_HARDER)===!0&&e.isRotateSupported()){const i=e.rotateCounterClockwise(),s=this.doDecode(i,t),o=s.getResultMetadata();let a=270;o!==null&&o.get(de.ORIENTATION)===!0&&(a=a+o.get(de.ORIENTATION)%360),s.putMetadata(de.ORIENTATION,a);const l=s.getResultPoints();if(l!==null){const c=i.getHeight();for(let h=0;h<l.length;h++)l[h]=new Z(c-l[h].getY()-1,l[h].getX())}return s}else throw new v}}reset(){}doDecode(e,t){const n=e.getWidth(),r=e.getHeight();let i=new ce(n);const s=t&&t.get(Ce.TRY_HARDER)===!0,o=Math.max(1,r>>(s?8:5));let a;s?a=r:a=15;const l=Math.trunc(r/2);for(let c=0;c<a;c++){const h=Math.trunc((c+1)/2),g=(c&1)===0,A=l+o*(g?h:-h);if(A<0||A>=r)break;try{i=e.getBlackRow(A,i)}catch{continue}for(let b=0;b<2;b++){if(b===1&&(i.reverse(),t&&t.get(Ce.NEED_RESULT_POINT_CALLBACK)===!0)){const y=new Map;t.forEach((_,R)=>y.set(R,_)),y.delete(Ce.NEED_RESULT_POINT_CALLBACK),t=y}try{const y=this.decodeRow(A,i,t);if(b===1){y.putMetadata(de.ORIENTATION,180);const _=y.getResultPoints();_!==null&&(_[0]=new Z(n-_[0].getX()-1,_[0].getY()),_[1]=new Z(n-_[1].getX()-1,_[1].getY()))}return y}catch{}}}throw new v}static recordPattern(e,t,n){const r=n.length;for(let l=0;l<r;l++)n[l]=0;const i=e.getSize();if(t>=i)throw new v;let s=!e.get(t),o=0,a=t;for(;a<i;){if(e.get(a)!==s)n[o]++;else{if(++o===r)break;n[o]=1,s=!s}a++}if(!(o===r||o===r-1&&a===i))throw new v}static recordPatternInReverse(e,t,n){let r=n.length,i=e.get(t);for(;t>0&&r>=0;)e.get(--t)!==i&&(r--,i=!i);if(r>=0)throw new v;je.recordPattern(e,t+1,n)}static patternMatchVariance(e,t,n){const r=e.length;let i=0,s=0;for(let l=0;l<r;l++)i+=e[l],s+=t[l];if(i<s)return Number.POSITIVE_INFINITY;const o=i/s;n*=o;let a=0;for(let l=0;l<r;l++){const c=e[l],h=t[l]*o,g=c>h?c-h:h-c;if(g>n)return Number.POSITIVE_INFINITY;a+=g}return a/i}}class z extends je{static findStartPattern(e){const t=e.getSize(),n=e.getNextSet(0);let r=0,i=Int32Array.from([0,0,0,0,0,0]),s=n,o=!1;const a=6;for(let l=n;l<t;l++)if(e.get(l)!==o)i[r]++;else{if(r===a-1){let c=z.MAX_AVG_VARIANCE,h=-1;for(let g=z.CODE_START_A;g<=z.CODE_START_C;g++){const A=je.patternMatchVariance(i,z.CODE_PATTERNS[g],z.MAX_INDIVIDUAL_VARIANCE);A<c&&(c=A,h=g)}if(h>=0&&e.isRange(Math.max(0,s-(l-s)/2),s,!1))return Int32Array.from([s,l,h]);s+=i[0]+i[1],i=i.slice(2,i.length-1),i[r-1]=0,i[r]=0,r--}else r++;i[r]=1,o=!o}throw new v}static decodeCode(e,t,n){je.recordPattern(e,n,t);let r=z.MAX_AVG_VARIANCE,i=-1;for(let s=0;s<z.CODE_PATTERNS.length;s++){const o=z.CODE_PATTERNS[s],a=this.patternMatchVariance(t,o,z.MAX_INDIVIDUAL_VARIANCE);a<r&&(r=a,i=s)}if(i>=0)return i;throw new v}decodeRow(e,t,n){const r=n&&n.get(Ce.ASSUME_GS1)===!0,i=z.findStartPattern(t),s=i[2];let o=0;const a=new Uint8Array(20);a[o++]=s;let l;switch(s){case z.CODE_START_A:l=z.CODE_CODE_A;break;case z.CODE_START_B:l=z.CODE_CODE_B;break;case z.CODE_START_C:l=z.CODE_CODE_C;break;default:throw new U}let c=!1,h=!1,g="",A=i[0],b=i[1];const y=Int32Array.from([0,0,0,0,0,0]);let _=0,R=0,H=s,W=0,V=!0,Ae=!1,le=!1;for(;!c;){const mn=h;switch(h=!1,_=R,R=z.decodeCode(t,y,b),a[o++]=R,R!==z.CODE_STOP&&(V=!0),R!==z.CODE_STOP&&(W++,H+=W*R),A=b,b+=y.reduce((cs,us)=>cs+us,0),R){case z.CODE_START_A:case z.CODE_START_B:case z.CODE_START_C:throw new U}switch(l){case z.CODE_CODE_A:if(R<64)le===Ae?g+=String.fromCharCode(32+R):g+=String.fromCharCode(32+R+128),le=!1;else if(R<96)le===Ae?g+=String.fromCharCode(R-64):g+=String.fromCharCode(R+64),le=!1;else switch(R!==z.CODE_STOP&&(V=!1),R){case z.CODE_FNC_1:r&&(g.length===0?g+="]C1":g+="");break;case z.CODE_FNC_2:case z.CODE_FNC_3:break;case z.CODE_FNC_4_A:!Ae&&le?(Ae=!0,le=!1):Ae&&le?(Ae=!1,le=!1):le=!0;break;case z.CODE_SHIFT:h=!0,l=z.CODE_CODE_B;break;case z.CODE_CODE_B:l=z.CODE_CODE_B;break;case z.CODE_CODE_C:l=z.CODE_CODE_C;break;case z.CODE_STOP:c=!0;break}break;case z.CODE_CODE_B:if(R<96)le===Ae?g+=String.fromCharCode(32+R):g+=String.fromCharCode(32+R+128),le=!1;else switch(R!==z.CODE_STOP&&(V=!1),R){case z.CODE_FNC_1:r&&(g.length===0?g+="]C1":g+="");break;case z.CODE_FNC_2:case z.CODE_FNC_3:break;case z.CODE_FNC_4_B:!Ae&&le?(Ae=!0,le=!1):Ae&&le?(Ae=!1,le=!1):le=!0;break;case z.CODE_SHIFT:h=!0,l=z.CODE_CODE_A;break;case z.CODE_CODE_A:l=z.CODE_CODE_A;break;case z.CODE_CODE_C:l=z.CODE_CODE_C;break;case z.CODE_STOP:c=!0;break}break;case z.CODE_CODE_C:if(R<100)R<10&&(g+="0"),g+=R;else switch(R!==z.CODE_STOP&&(V=!1),R){case z.CODE_FNC_1:r&&(g.length===0?g+="]C1":g+="");break;case z.CODE_CODE_A:l=z.CODE_CODE_A;break;case z.CODE_CODE_B:l=z.CODE_CODE_B;break;case z.CODE_STOP:c=!0;break}break}mn&&(l=l===z.CODE_CODE_A?z.CODE_CODE_B:z.CODE_CODE_A)}const Ct=b-A;if(b=t.getNextUnset(b),!t.isRange(b,Math.min(t.getSize(),b+(b-A)/2),!1))throw new v;if(H-=W*_,H%103!==_)throw new te;const Dt=g.length;if(Dt===0)throw new v;Dt>0&&V&&(l===z.CODE_CODE_C?g=g.substring(0,Dt-2):g=g.substring(0,Dt-1));const pt=(i[1]+i[0])/2,De=A+Ct/2,it=a.length,yt=new Uint8Array(it);for(let mn=0;mn<it;mn++)yt[mn]=a[mn];const wn=[new Z(pt,e),new Z(De,e)];return new D(g,yt,0,wn,B.CODE_128,new Date().getTime())}}z.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],z.MAX_AVG_VARIANCE=.25,z.MAX_INDIVIDUAL_VARIANCE=.7,z.CODE_SHIFT=98,z.CODE_CODE_C=99,z.CODE_CODE_B=100,z.CODE_CODE_A=101,z.CODE_FNC_1=102,z.CODE_FNC_2=97,z.CODE_FNC_3=96,z.CODE_FNC_4_A=101,z.CODE_FNC_4_B=100,z.CODE_START_A=103,z.CODE_START_B=104,z.CODE_START_C=105,z.CODE_STOP=106;class Ze extends je{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,n){let r=this.counters;r.fill(0),this.decodeRowResult="";let i=Ze.findAsteriskPattern(t,r),s=t.getNextSet(i[1]),o=t.getSize(),a,l;do{Ze.recordPattern(t,s,r);let y=Ze.toNarrowWidePattern(r);if(y<0)throw new v;a=Ze.patternToChar(y),this.decodeRowResult+=a,l=s;for(let _ of r)s+=_;s=t.getNextSet(s)}while(a!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let c=0;for(let y of r)c+=y;let h=s-l-c;if(s!==o&&h*2<c)throw new v;if(this.usingCheckDigit){let y=this.decodeRowResult.length-1,_=0;for(let R=0;R<y;R++)_+=Ze.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(R));if(this.decodeRowResult.charAt(y)!==Ze.ALPHABET_STRING.charAt(_%43))throw new te;this.decodeRowResult=this.decodeRowResult.substring(0,y)}if(this.decodeRowResult.length===0)throw new v;let g;this.extendedMode?g=Ze.decodeExtended(this.decodeRowResult):g=this.decodeRowResult;let A=(i[1]+i[0])/2,b=l+c/2;return new D(g,null,0,[new Z(A,e),new Z(b,e)],B.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let n=e.getSize(),r=e.getNextSet(0),i=0,s=r,o=!1,a=t.length;for(let l=r;l<n;l++)if(e.get(l)!==o)t[i]++;else{if(i===a-1){if(this.toNarrowWidePattern(t)===Ze.ASTERISK_ENCODING&&e.isRange(Math.max(0,s-Math.floor((l-s)/2)),s,!1))return[s,l];s+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,o=!o}throw new v}static toNarrowWidePattern(e){let t=e.length,n=0,r;do{let i=2147483647;for(let a of e)a<i&&a>n&&(i=a);n=i,r=0;let s=0,o=0;for(let a=0;a<t;a++){let l=e[a];l>n&&(o|=1<<t-1-a,r++,s+=l)}if(r===3){for(let a=0;a<t&&r>0;a++){let l=e[a];if(l>n&&(r--,l*2>=s))return-1}return o}}while(r>3);return-1}static patternToChar(e){for(let t=0;t<Ze.CHARACTER_ENCODINGS.length;t++)if(Ze.CHARACTER_ENCODINGS[t]===e)return Ze.ALPHABET_STRING.charAt(t);if(e===Ze.ASTERISK_ENCODING)return"*";throw new v}static decodeExtended(e){let t=e.length,n="";for(let r=0;r<t;r++){let i=e.charAt(r);if(i==="+"||i==="$"||i==="%"||i==="/"){let s=e.charAt(r+1),o="\0";switch(i){case"+":if(s>="A"&&s<="Z")o=String.fromCharCode(s.charCodeAt(0)+32);else throw new U;break;case"$":if(s>="A"&&s<="Z")o=String.fromCharCode(s.charCodeAt(0)-64);else throw new U;break;case"%":if(s>="A"&&s<="E")o=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")o=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")o=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")o=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")o="\0";else if(s==="V")o="@";else if(s==="W")o="`";else if(s==="X"||s==="Y"||s==="Z")o="";else throw new U;break;case"/":if(s>="A"&&s<="O")o=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")o=":";else throw new U;break}n+=o,r++}else n+=i}return n}}Ze.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Ze.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Ze.ASTERISK_ENCODING=148;class Re extends je{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,n){let r=this.decodeStart(t),i=this.decodeEnd(t),s=new re;Re.decodeMiddle(t,r[1],i[0],s);let o=s.toString(),a=null;n!=null&&(a=n.get(Ce.ALLOWED_LENGTHS)),a==null&&(a=Re.DEFAULT_ALLOWED_LENGTHS);let l=o.length,c=!1,h=0;for(let b of a){if(l===b){c=!0;break}b>h&&(h=b)}if(!c&&l>h&&(c=!0),!c)throw new U;const g=[new Z(r[1],e),new Z(i[0],e)];return new D(o,null,0,g,B.ITF,new Date().getTime())}static decodeMiddle(e,t,n,r){let i=new Int32Array(10),s=new Int32Array(5),o=new Int32Array(5);for(i.fill(0),s.fill(0),o.fill(0);t<n;){je.recordPattern(e,t,i);for(let l=0;l<5;l++){let c=2*l;s[l]=i[c],o[l]=i[c+1]}let a=Re.decodeDigit(s);r.append(a.toString()),a=this.decodeDigit(o),r.append(a.toString()),i.forEach(function(l){t+=l})}}decodeStart(e){let t=Re.skipWhiteSpace(e),n=Re.findGuardPattern(e,t,Re.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,t){let n=this.narrowLineWidth*10;n=n<t?n:t;for(let r=t-1;n>0&&r>=0&&!e.get(r);r--)n--;if(n!==0)throw new v}static skipWhiteSpace(e){const t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new v;return n}decodeEnd(e){e.reverse();try{let t=Re.skipWhiteSpace(e),n;try{n=Re.findGuardPattern(e,t,Re.END_PATTERN_REVERSED[0])}catch(i){i instanceof v&&(n=Re.findGuardPattern(e,t,Re.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,n[0]);let r=n[0];return n[0]=e.getSize()-n[1],n[1]=e.getSize()-r,n}finally{e.reverse()}}static findGuardPattern(e,t,n){let r=n.length,i=new Int32Array(r),s=e.getSize(),o=!1,a=0,l=t;i.fill(0);for(let c=t;c<s;c++)if(e.get(c)!==o)i[a]++;else{if(a===r-1){if(je.patternMatchVariance(i,n,Re.MAX_INDIVIDUAL_VARIANCE)<Re.MAX_AVG_VARIANCE)return[l,c];l+=i[0]+i[1],J.arraycopy(i,2,i,0,a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,o=!o}throw new v}static decodeDigit(e){let t=Re.MAX_AVG_VARIANCE,n=-1,r=Re.PATTERNS.length;for(let i=0;i<r;i++){let s=Re.PATTERNS[i],o=je.patternMatchVariance(e,s,Re.MAX_INDIVIDUAL_VARIANCE);o<t?(t=o,n=i):o===t&&(n=-1)}if(n>=0)return n%10;throw new v}}Re.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Re.MAX_AVG_VARIANCE=.38,Re.MAX_INDIVIDUAL_VARIANCE=.5,Re.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Re.START_PATTERN=Int32Array.from([1,1,1,1]),Re.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ve extends je{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,n,r=0,i=Int32Array.from([0,0,0]);for(;!t;){i=Int32Array.from([0,0,0]),n=Ve.findGuardPattern(e,r,!1,this.START_END_PATTERN,i);let s=n[0];r=n[1];let o=s-(r-s);o>=0&&(t=e.isRange(o,s,!1))}return n}static checkChecksum(e){return Ve.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return Ve.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new U;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new U;n+=i}return(1e3-n)%10}static decodeEnd(e,t){return Ve.findGuardPattern(e,t,!1,Ve.START_END_PATTERN,new Int32Array(Ve.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,n,r){return this.findGuardPattern(e,t,n,r,new Int32Array(r.length))}static findGuardPattern(e,t,n,r,i){let s=e.getSize();t=n?e.getNextUnset(t):e.getNextSet(t);let o=0,a=t,l=r.length,c=n;for(let h=t;h<s;h++)if(e.get(h)!==c)i[o]++;else{if(o===l-1){if(je.patternMatchVariance(i,r,Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE)return Int32Array.from([a,h]);a+=i[0]+i[1];let g=i.slice(2,i.length-1);for(let A=0;A<o-1;A++)i[A]=g[A];i[o-1]=0,i[o]=0,o--}else o++;i[o]=1,c=!c}throw new v}static decodeDigit(e,t,n,r){this.recordPattern(e,n,t);let i=this.MAX_AVG_VARIANCE,s=-1,o=r.length;for(let a=0;a<o;a++){let l=r[a],c=je.patternMatchVariance(t,l,Ve.MAX_INDIVIDUAL_VARIANCE);c<i&&(i=c,s=a)}if(s>=0)return s;throw new v}}Ve.MAX_AVG_VARIANCE=.48,Ve.MAX_INDIVIDUAL_VARIANCE=.7,Ve.START_END_PATTERN=Int32Array.from([1,1,1]),Ve.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ve.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ve.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class yn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),s=r.toString(),o=yn.parseExtensionString(s),a=[new Z((n[0]+n[1])/2,e),new Z(i,e)],l=new D(s,null,0,a,B.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&l.putAllMetadata(o),l}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],o=0;for(let l=0;l<5&&s<i;l++){let c=Ve.decodeDigit(e,r,s,Ve.L_AND_G_PATTERNS);n+=String.fromCharCode(48+c%10);for(let h of r)s+=h;c>=10&&(o|=1<<4-l),l!==4&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(n.length!==5)throw new v;let a=this.determineCheckDigit(o);if(yn.extensionChecksum(n.toString())!==a)throw new v;return s}static extensionChecksum(e){let t=e.length,n=0;for(let r=t-2;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-48;n*=3;for(let r=t-1;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-48;return n*=3,n%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new v}static parseExtensionString(e){if(e.length!==5)return null;let t=yn.parseExtension5String(e);return t==null?null:new Map([[de.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let n=parseInt(e.substring(1)),r=(n/100).toString(),i=n%100,s=i<10?"0"+i:i.toString();return t+r+"."+s}}class Qn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),s=r.toString(),o=Qn.parseExtensionString(s),a=[new Z((n[0]+n[1])/2,e),new Z(i,e)],l=new D(s,null,0,a,B.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&l.putAllMetadata(o),l}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],o=0;for(let a=0;a<2&&s<i;a++){let l=Ve.decodeDigit(e,r,s,Ve.L_AND_G_PATTERNS);n+=String.fromCharCode(48+l%10);for(let c of r)s+=c;l>=10&&(o|=1<<1-a),a!==1&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(n.length!==2)throw new v;if(parseInt(n.toString())%4!==o)throw new v;return s}static parseExtensionString(e){return e.length!==2?null:new Map([[de.ISSUE_NUMBER,parseInt(e)]])}}class kr{static decodeRow(e,t,n){let r=Ve.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new yn().decodeRow(e,t,r)}catch{return new Qn().decodeRow(e,t,r)}}}kr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Se extends Ve{constructor(){super(),this.decodeRowStringBuffer="",Se.L_AND_G_PATTERNS=Se.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=Se.L_PATTERNS[e-10],n=new Int32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[t.length-r-1];Se.L_AND_G_PATTERNS[e]=n}}decodeRow(e,t,n){let r=Se.findStartGuardPattern(t),i=n==null?null:n.get(Ce.NEED_RESULT_POINT_CALLBACK);if(i!=null){const V=new Z((r[0]+r[1])/2,e);i.foundPossibleResultPoint(V)}let s=this.decodeMiddle(t,r,this.decodeRowStringBuffer),o=s.rowOffset,a=s.resultString;if(i!=null){const V=new Z(o,e);i.foundPossibleResultPoint(V)}let l=this.decodeEnd(t,o);if(i!=null){const V=new Z((l[0]+l[1])/2,e);i.foundPossibleResultPoint(V)}let c=l[1],h=c+(c-l[0]);if(h>=t.getSize()||!t.isRange(c,h,!1))throw new v;let g=a.toString();if(g.length<8)throw new U;if(!Se.checkChecksum(g))throw new te;let A=(r[1]+r[0])/2,b=(l[1]+l[0])/2,y=this.getBarcodeFormat(),_=[new Z(A,e),new Z(b,e)],R=new D(g,null,0,_,y,new Date().getTime()),H=0;try{let V=kr.decodeRow(e,t,l[1]);R.putMetadata(de.UPC_EAN_EXTENSION,V.getText()),R.putAllMetadata(V.getResultMetadata()),R.addResultPoints(V.getResultPoints()),H=V.getText().length}catch{}let W=n==null?null:n.get(Ce.ALLOWED_EAN_EXTENSIONS);if(W!=null){let V=!1;for(let Ae in W)if(H.toString()===Ae){V=!0;break}if(!V)throw new v}return R}decodeEnd(e,t){return Se.findGuardPattern(e,t,!1,Se.START_END_PATTERN,new Int32Array(Se.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return Se.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return Se.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new U;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-48;if(i<0||i>9)throw new U;n+=i}return(1e3-n)%10}}class Jt extends Se{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1],o=0;for(let l=0;l<6&&s<i;l++){let c=Se.decodeDigit(e,r,s,Se.L_AND_G_PATTERNS);n+=String.fromCharCode(48+c%10);for(let h of r)s+=h;c>=10&&(o|=1<<5-l)}n=Jt.determineFirstDigit(n,o),s=Se.findGuardPattern(e,s,!0,Se.MIDDLE_PATTERN,new Int32Array(Se.MIDDLE_PATTERN.length).fill(0))[1];for(let l=0;l<6&&s<i;l++){let c=Se.decodeDigit(e,r,s,Se.L_PATTERNS);n+=String.fromCharCode(48+c);for(let h of r)s+=h}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return B.EAN_13}static determineFirstDigit(e,t){for(let n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode(48+n)+e,e;throw new v}}Jt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Pr extends Se{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s=t[1];for(let a=0;a<4&&s<i;a++){let l=Se.decodeDigit(e,r,s,Se.L_PATTERNS);n+=String.fromCharCode(48+l);for(let c of r)s+=c}s=Se.findGuardPattern(e,s,!0,Se.MIDDLE_PATTERN,new Int32Array(Se.MIDDLE_PATTERN.length).fill(0))[1];for(let a=0;a<4&&s<i;a++){let l=Se.decodeDigit(e,r,s,Se.L_PATTERNS);n+=String.fromCharCode(48+l);for(let c of r)s+=c}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return B.EAN_8}}class Lr extends Se{constructor(){super(...arguments),this.ean13Reader=new Jt}getBarcodeFormat(){return B.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,n))}decodeMiddle(e,t,n){return this.ean13Reader.decodeMiddle(e,t,n)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let n=new D(t.substring(1),null,null,e.getResultPoints(),B.UPC_A);return e.getResultMetadata()!=null&&n.putAllMetadata(e.getResultMetadata()),n}else throw new v}reset(){this.ean13Reader.reset()}}class vt extends Se{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters.map(l=>l);r[0]=0,r[1]=0,r[2]=0,r[3]=0;const i=e.getSize();let s=t[1],o=0;for(let l=0;l<6&&s<i;l++){const c=vt.decodeDigit(e,r,s,vt.L_AND_G_PATTERNS);n+=String.fromCharCode(48+c%10);for(let h of r)s+=h;c>=10&&(o|=1<<5-l)}let a=vt.determineNumSysAndCheckDigit(n,o);return{rowOffset:s,resultString:a}}decodeEnd(e,t){return vt.findGuardPatternWithoutCounters(e,t,!0,vt.MIDDLE_END_PATTERN)}checkChecksum(e){return Se.checkChecksum(vt.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let n=0;n<=1;n++)for(let r=0;r<10;r++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][r]){let i=String.fromCharCode(48+n),s=String.fromCharCode(48+r);return i+e+s}throw v.getNotFoundInstance()}getBarcodeFormat(){return B.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(i=>i.charCodeAt(0)),n=new re;n.append(e.charAt(0));let r=t[5];switch(r){case 0:case 1:case 2:n.appendChars(t,0,2),n.append(r),n.append("0000"),n.appendChars(t,2,3);break;case 3:n.appendChars(t,0,3),n.append("00000"),n.appendChars(t,3,2);break;case 4:n.appendChars(t,0,4),n.append("00000"),n.append(t[4]);break;default:n.appendChars(t,0,5),n.append("0000"),n.append(r);break}return e.length>=8&&n.append(e.charAt(7)),n.toString()}}vt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),vt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Jn extends je{constructor(e){super();let t=e==null?null:e.get(Ce.POSSIBLE_FORMATS),n=[];p(t)?(n.push(new Jt),n.push(new Lr),n.push(new Pr),n.push(new vt)):(t.indexOf(B.EAN_13)>-1&&n.push(new Jt),t.indexOf(B.UPC_A)>-1&&n.push(new Lr),t.indexOf(B.EAN_8)>-1&&n.push(new Pr),t.indexOf(B.UPC_E)>-1&&n.push(new vt)),this.readers=n}decodeRow(e,t,n){for(let r of this.readers)try{const i=r.decodeRow(e,t,n),s=i.getBarcodeFormat()===B.EAN_13&&i.getText().charAt(0)==="0",o=n==null?null:n.get(Ce.POSSIBLE_FORMATS),a=o==null||o.includes(B.UPC_A);if(s&&a){const l=i.getRawBytes(),c=new D(i.getText().substring(1),l,l?l.length:null,i.getResultPoints(),B.UPC_A);return c.putAllMetadata(i.getResultMetadata()),c}return i}catch{}throw new v}reset(){for(let e of this.readers)e.reset()}}class ot extends je{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let n=0;n<t.length;n++)if(je.patternMatchVariance(e,t[n],ot.MAX_INDIVIDUAL_VARIANCE)<ot.MAX_AVG_VARIANCE)return n;throw new v}static count(e){return Ee.sum(new Int32Array(e))}static increment(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]>r&&(r=t[i],n=i);e[n]++}static decrement(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]<r&&(r=t[i],n=i);e[n]--}static isFinderPattern(e){let t=e[0]+e[1],n=t+e[2]+e[3],r=t/n;if(r>=ot.MIN_FINDER_PATTERN_RATIO&&r<=ot.MAX_FINDER_PATTERN_RATIO){let i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(let o of e)o>s&&(s=o),o<i&&(i=o);return s<10*i}return!1}}ot.MAX_AVG_VARIANCE=.2,ot.MAX_INDIVIDUAL_VARIANCE=.45,ot.MIN_FINDER_PATTERN_RATIO=9.5/12,ot.MAX_FINDER_PATTERN_RATIO=12.5/14;class cn{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof cn))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Fn{constructor(e,t,n,r,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new Z(n,i)),this.resultPoints.push(new Z(r,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof Fn))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class Bt{constructor(){}static getRSSvalue(e,t,n){let r=0;for(let a of e)r+=a;let i=0,s=0,o=e.length;for(let a=0;a<o-1;a++){let l;for(l=1,s|=1<<a;l<e[a];l++,s&=~(1<<a)){let c=Bt.combins(r-l-1,o-a-2);if(n&&s===0&&r-l-(o-a-1)>=o-a-1&&(c-=Bt.combins(r-l-(o-a),o-a-2)),o-a-1>1){let h=0;for(let g=r-l-(o-a-2);g>t;g--)h+=Bt.combins(r-l-g-1,o-a-3);c-=h*(o-1-a)}else r-l>t&&c--;i+=c}r-=l}return i}static combins(e,t){let n,r;e-t>t?(r=t,n=e-t):(r=e-t,n=t);let i=1,s=1;for(let o=e;o>n;o--)i*=o,s<=r&&(i/=s,s++);for(;s<=r;)i/=s,s++;return i}}class ki{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let n=12*t,r=new ce(n),i=0,o=e[0].getRightChar().getValue();for(let a=11;a>=0;--a)(o&1<<a)!=0&&r.set(i),i++;for(let a=1;a<e.length;++a){let l=e[a],c=l.getLeftChar().getValue();for(let h=11;h>=0;--h)(c&1<<h)!=0&&r.set(i),i++;if(l.getRightChar()!=null){let h=l.getRightChar().getValue();for(let g=11;g>=0;--g)(h&1<<g)!=0&&r.set(i),i++}}return r}}class $t{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class $n{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class wt extends $n{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===wt.FNC1}}wt.FNC1="$";class en extends $n{constructor(e,t,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class St extends $n{constructor(e,t,n){if(super(e),t<0||t>10||n<0||n>10)throw new U;this.firstDigit=t,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===St.FNC1}isSecondDigitFNC1(){return this.secondDigit===St.FNC1}isAnyFNC1(){return this.firstDigit===St.FNC1||this.secondDigit===St.FNC1}}St.FNC1=10;class j{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new v;let t=e.substring(0,2);for(let i of j.TWO_DIGIT_DATA_LENGTH)if(i[0]===t)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(2,i[2],e):j.processFixedAI(2,i[1],e);if(e.length<3)throw new v;let n=e.substring(0,3);for(let i of j.THREE_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(3,i[2],e):j.processFixedAI(3,i[1],e);for(let i of j.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(4,i[2],e):j.processFixedAI(4,i[1],e);if(e.length<4)throw new v;let r=e.substring(0,4);for(let i of j.FOUR_DIGIT_DATA_LENGTH)if(i[0]===r)return i[1]===j.VARIABLE_LENGTH?j.processVariableAI(4,i[2],e):j.processFixedAI(4,i[1],e);throw new v}static processFixedAI(e,t,n){if(n.length<e)throw new v;let r=n.substring(0,e);if(n.length<e+t)throw new v;let i=n.substring(e,e+t),s=n.substring(e+t),o="("+r+")"+i,a=j.parseFieldsInGeneralPurpose(s);return a==null?o:o+a}static processVariableAI(e,t,n){let r=n.substring(0,e),i;n.length<e+t?i=n.length:i=e+t;let s=n.substring(e,i),o=n.substring(i),a="("+r+")"+s,l=j.parseFieldsInGeneralPurpose(o);return l==null?a:a+l}}j.VARIABLE_LENGTH=[],j.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",j.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",j.VARIABLE_LENGTH,20],["22",j.VARIABLE_LENGTH,29],["30",j.VARIABLE_LENGTH,8],["37",j.VARIABLE_LENGTH,8],["90",j.VARIABLE_LENGTH,30],["91",j.VARIABLE_LENGTH,30],["92",j.VARIABLE_LENGTH,30],["93",j.VARIABLE_LENGTH,30],["94",j.VARIABLE_LENGTH,30],["95",j.VARIABLE_LENGTH,30],["96",j.VARIABLE_LENGTH,30],["97",j.VARIABLE_LENGTH,3],["98",j.VARIABLE_LENGTH,30],["99",j.VARIABLE_LENGTH,30]],j.THREE_DIGIT_DATA_LENGTH=[["240",j.VARIABLE_LENGTH,30],["241",j.VARIABLE_LENGTH,30],["242",j.VARIABLE_LENGTH,6],["250",j.VARIABLE_LENGTH,30],["251",j.VARIABLE_LENGTH,30],["253",j.VARIABLE_LENGTH,17],["254",j.VARIABLE_LENGTH,20],["400",j.VARIABLE_LENGTH,30],["401",j.VARIABLE_LENGTH,30],["402",17],["403",j.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",j.VARIABLE_LENGTH,20],["421",j.VARIABLE_LENGTH,15],["422",3],["423",j.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],j.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",j.VARIABLE_LENGTH,15],["391",j.VARIABLE_LENGTH,18],["392",j.VARIABLE_LENGTH,15],["393",j.VARIABLE_LENGTH,18],["703",j.VARIABLE_LENGTH,30]],j.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",j.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",j.VARIABLE_LENGTH,20],["8003",j.VARIABLE_LENGTH,30],["8004",j.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",j.VARIABLE_LENGTH,30],["8008",j.VARIABLE_LENGTH,12],["8018",18],["8020",j.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",j.VARIABLE_LENGTH,70],["8200",j.VARIABLE_LENGTH,70]];class un{constructor(e){this.buffer=new re,this.information=e}decodeAllCodes(e,t){let n=t,r=null;do{let i=this.decodeGeneralPurposeField(n,r),s=j.parseFieldsInGeneralPurpose(i.getNewString());if(s!=null&&e.append(s),i.isRemaining()?r=""+i.getRemainingValue():r=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let i=this.extractNumericValueFromBitArray(e,4);return i===0?new St(this.information.getSize(),St.FNC1,St.FNC1):new St(this.information.getSize(),i-1,St.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),n=(t-8)/11,r=(t-8)%11;return new St(e+7,n,r)}extractNumericValueFromBitArray(e,t){return un.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,n){let r=0;for(let i=0;i<n;++i)e.get(t+i)&&(r|=1<<n-i-1);return r}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let n=this.parseBlocks();return n!=null&&n.isRemaining()?new en(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new en(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let n=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(n!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new en(this.current.getPosition(),this.buffer.toString()):t=new en(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new $t(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new en(this.current.getPosition(),this.buffer.toString());return new $t(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new $t(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new en(this.current.getPosition(),this.buffer.toString());return new $t(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new $t(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new en(this.current.getPosition(),this.buffer.toString());return new $t(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new $t(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new wt(e+5,wt.FNC1);if(t>=5&&t<15)return new wt(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new wt(e+7,""+(n+1));if(n>=90&&n<116)return new wt(e+7,""+(n+7));let r=this.extractNumericValueFromBitArray(e,8),i;switch(r){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new U}return new wt(e+8,i)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new wt(e+5,wt.FNC1);if(t>=5&&t<15)return new wt(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new wt(e+6,""+(n+33));let r;switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new Mt("Decoding invalid alphanumeric value: "+n)}return new wt(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class er{constructor(e){this.information=e,this.generalDecoder=new un(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class mt extends er{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)}encodeCompressedGtinWithoutAI(e,t,n){for(let r=0;r<4;++r){let i=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*r,10);i/100===0&&e.append("0"),i/10===0&&e.append("0"),e.append(i)}mt.appendCheckDigit(e,n)}static appendCheckDigit(e,t){let n=0;for(let r=0;r<13;r++){let i=e.charAt(r+t).charCodeAt(0)-48;n+=(r&1)===0?3*i:i}n=10-n%10,n===10&&(n=0),e.append(n)}}mt.GTIN_SIZE=40;class fn extends mt{constructor(e){super(e)}parseInformation(){let e=new re;e.append("(01)");let t=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(fn.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,fn.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,fn.HEADER_SIZE+44)}}fn.HEADER_SIZE=4;class Un extends er{constructor(e){super(e)}parseInformation(){let e=new re;return this.getGeneralDecoder().decodeAllCodes(e,Un.HEADER_SIZE)}}Un.HEADER_SIZE=5;class Vn extends mt{constructor(e){super(e)}encodeCompressedWeight(e,t,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,r);let i=this.checkWeight(r),s=1e5;for(let o=0;o<5;++o)i/s===0&&e.append("0"),s/=10;e.append(i)}}class kt extends Vn{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=kt.HEADER_SIZE+Vn.GTIN_SIZE+kt.WEIGHT_SIZE)throw new v;let e=new re;return this.encodeCompressedGtin(e,kt.HEADER_SIZE),this.encodeCompressedWeight(e,kt.HEADER_SIZE+Vn.GTIN_SIZE,kt.WEIGHT_SIZE),e.toString()}}kt.HEADER_SIZE=5,kt.WEIGHT_SIZE=15;class Pi extends kt{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class Li extends kt{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class Pt extends mt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<Pt.HEADER_SIZE+mt.GTIN_SIZE)throw new v;let e=new re;this.encodeCompressedGtin(e,Pt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(Pt.HEADER_SIZE+mt.GTIN_SIZE,Pt.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(Pt.HEADER_SIZE+mt.GTIN_SIZE+Pt.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}Pt.HEADER_SIZE=8,Pt.LAST_DIGIT_SIZE=2;class ht extends mt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<ht.HEADER_SIZE+mt.GTIN_SIZE)throw new v;let e=new re;this.encodeCompressedGtin(e,ht.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(ht.HEADER_SIZE+mt.GTIN_SIZE,ht.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(ht.HEADER_SIZE+mt.GTIN_SIZE+ht.LAST_DIGIT_SIZE,ht.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let r=this.getGeneralDecoder().decodeGeneralPurposeField(ht.HEADER_SIZE+mt.GTIN_SIZE+ht.LAST_DIGIT_SIZE+ht.FIRST_THREE_DIGITS_SIZE,null);return e.append(r.getNewString()),e.toString()}}ht.HEADER_SIZE=8,ht.LAST_DIGIT_SIZE=2,ht.FIRST_THREE_DIGITS_SIZE=10;class Fe extends Vn{constructor(e,t,n){super(e),this.dateCode=n,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE+Fe.DATE_SIZE)throw new v;let e=new re;return this.encodeCompressedGtin(e,Fe.HEADER_SIZE),this.encodeCompressedWeight(e,Fe.HEADER_SIZE+Fe.GTIN_SIZE,Fe.WEIGHT_SIZE),this.encodeCompressedDate(e,Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,Fe.DATE_SIZE);if(n==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let r=n%32;n/=32;let i=n%12+1;n/=12;let s=n;s/10==0&&e.append("0"),e.append(s),i/10==0&&e.append("0"),e.append(i),r/10==0&&e.append("0"),e.append(r)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}Fe.HEADER_SIZE=8,Fe.WEIGHT_SIZE=20,Fe.DATE_SIZE=16;function Fr(f){try{if(f.get(1))return new fn(f);if(!f.get(2))return new Un(f);switch(un.extractNumericValueFromBitArray(f,1,4)){case 4:return new Pi(f);case 5:return new Li(f)}switch(un.extractNumericValueFromBitArray(f,1,5)){case 12:return new Pt(f);case 13:return new ht(f)}switch(un.extractNumericValueFromBitArray(f,1,7)){case 56:return new Fe(f,"310","11");case 57:return new Fe(f,"320","11");case 58:return new Fe(f,"310","13");case 59:return new Fe(f,"320","13");case 60:return new Fe(f,"310","15");case 61:return new Fe(f,"320","15");case 62:return new Fe(f,"310","17");case 63:return new Fe(f,"320","17")}}catch(e){throw console.log(e),new Mt("unknown decoder: "+f)}}class Wt{constructor(e,t,n,r){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof Wt?Wt.equalsOrNull(e.leftchar,t.leftchar)&&Wt.equalsOrNull(e.rightchar,t.rightchar)&&Wt.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:Wt.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class tr{constructor(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof tr?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let n;return e.forEach((r,i)=>{t.forEach(s=>{r.getLeftChar().getValue()===s.getLeftChar().getValue()&&r.getRightChar().getValue()===s.getRightChar().getValue()&&r.getFinderPatter().getValue()===s.getFinderPatter().getValue()&&(n=!0)})}),n}}class L extends ot{constructor(e){super(...arguments),this.pairs=new Array(L.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,n){this.pairs.length=0,this.startFromEven=!1;try{return L.constructResult(this.decodeRow2pairs(e,t))}catch(r){this.verbose&&console.log(r)}return this.pairs.length=0,this.startFromEven=!0,L.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(i){if(i instanceof v){if(!this.pairs.length)throw new v;n=!0}}if(this.checkChecksum())return this.pairs;let r;if(this.rows.length?r=!0:r=!1,this.storeRow(e,!1),r){let i=this.checkRowsBoolean(!1);if(i!=null||(i=this.checkRowsBoolean(!0),i!=null))return i}throw new v}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(n){this.verbose&&console.log(n)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let r=this.rows[n];this.pairs.length=0;for(let s of e)this.pairs.push(s.getPairs());if(this.pairs.push(r.getPairs()),!L.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let i=new Array(e);i.push(r);try{return this.checkRows(i,n+1)}catch(s){this.verbose&&console.log(s)}}throw new v}static isValidSequence(e){for(let t of L.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let n=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){n=!1;break}if(n)return!0}return!1}storeRow(e,t){let n=0,r=!1,i=!1;for(;n<this.rows.length;){let s=this.rows[n];if(s.getRowNumber()>e){i=s.isEquivalent(this.pairs);break}r=s.isEquivalent(this.pairs),n++}i||r||L.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new tr(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let n of t)if(n.getPairs().length!==e.length){for(let r of n.getPairs())for(let i of e)if(Wt.equals(r,i))break}}static isPartialRow(e,t){for(let n of t){let r=!0;for(let i of e){let s=!1;for(let o of n.getPairs())if(i.equals(o)){s=!0;break}if(!s){r=!1;break}}if(r)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=ki.buildBitArray(e),r=Fr(t).parseInformation(),i=e[0].getFinderPattern().getResultPoints(),s=e[e.length-1].getFinderPattern().getResultPoints(),o=[i[0],i[1],s[0],s[1]];return new D(r,null,null,o,B.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(n==null)return!1;let r=n.getChecksumPortion(),i=2;for(let o=1;o<this.pairs.size();++o){let a=this.pairs.get(o);r+=a.getLeftChar().getChecksumPortion(),i++;let l=a.getRightChar();l!=null&&(r+=l.getChecksumPortion(),i++)}return r%=211,211*(i-4)+r==t.getValue()}static getNextSecondBar(e,t){let n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n}retrieveNextPair(e,t,n){let r=t.length%2==0;this.startFromEven&&(r=!r);let i,s=!0,o=-1;do this.findNextPair(e,t,o),i=this.parseFoundFinderPattern(e,n,r),i==null?o=L.getNextSecondBar(e,this.startEnd[0]):s=!1;while(s);let a=this.decodeDataCharacter(e,i,r,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new v;let l;try{l=this.decodeDataCharacter(e,i,r,!1)}catch(c){l=null,this.verbose&&console.log(c)}return new Wt(a,l,i,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),s;n>=0?s=n:this.isEmptyPair(t)?s=0:s=t[t.length-1].getFinderPattern().getStartEnd()[1];let o=t.length%2!=0;this.startFromEven&&(o=!o);let a=!1;for(;s<i&&(a=!e.get(s),!!a);)s++;let l=0,c=s;for(let h=s;h<i;h++)if(e.get(h)!=a)r[l]++;else{if(l==3){if(o&&L.reverseCounters(r),L.isFinderPattern(r)){this.startEnd[0]=c,this.startEnd[1]=h;return}o&&L.reverseCounters(r),c+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,l--}else l++;r[l]=1,a=!a}throw new v}static reverseCounters(e){let t=e.length;for(let n=0;n<t/2;++n){let r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}}parseFoundFinderPattern(e,t,n){let r,i,s;if(n){let l=this.startEnd[0]-1;for(;l>=0&&!e.get(l);)l--;l++,r=this.startEnd[0]-l,i=l,s=this.startEnd[1]}else i=this.startEnd[0],s=e.getNextUnset(this.startEnd[1]+1),r=s-this.startEnd[1];let o=this.getDecodeFinderCounters();J.arraycopy(o,0,o,1,o.length-1),o[0]=r;let a;try{a=this.parseFinderValue(o,L.FINDER_PATTERNS)}catch{return null}return new Fn(a,[i,s],i,s,t)}decodeDataCharacter(e,t,n,r){let i=this.getDataCharacterCounters();for(let De=0;De<i.length;De++)i[De]=0;if(r)L.recordPatternInReverse(e,t.getStartEnd()[0],i);else{L.recordPattern(e,t.getStartEnd()[1],i);for(let De=0,it=i.length-1;De<it;De++,it--){let yt=i[De];i[De]=i[it],i[it]=yt}}let s=17,o=Ee.sum(new Int32Array(i))/s,a=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(o-a)/a>.3)throw new v;let l=this.getOddCounts(),c=this.getEvenCounts(),h=this.getOddRoundingErrors(),g=this.getEvenRoundingErrors();for(let De=0;De<i.length;De++){let it=1*i[De]/o,yt=it+.5;if(yt<1){if(it<.3)throw new v;yt=1}else if(yt>8){if(it>8.7)throw new v;yt=8}let wn=De/2;(De&1)==0?(l[wn]=yt,h[wn]=it-yt):(c[wn]=yt,g[wn]=it-yt)}this.adjustOddEvenCounts(s);let A=4*t.getValue()+(n?0:2)+(r?0:1)-1,b=0,y=0;for(let De=l.length-1;De>=0;De--){if(L.isNotA1left(t,n,r)){let it=L.WEIGHTS[A][2*De];y+=l[De]*it}b+=l[De]}let _=0;for(let De=c.length-1;De>=0;De--)if(L.isNotA1left(t,n,r)){let it=L.WEIGHTS[A][2*De+1];_+=c[De]*it}let R=y+_;if((b&1)!=0||b>13||b<4)throw new v;let H=(13-b)/2,W=L.SYMBOL_WIDEST[H],V=9-W,Ae=Bt.getRSSvalue(l,W,!0),le=Bt.getRSSvalue(c,V,!1),Ct=L.EVEN_TOTAL_SUBSET[H],Dt=L.GSUM[H],pt=Ae*Ct+le+Dt;return new cn(pt,R)}static isNotA1left(e,t,n){return!(e.getValue()==0&&t&&n)}adjustOddEvenCounts(e){let t=Ee.sum(new Int32Array(this.getOddCounts())),n=Ee.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1;t>13?i=!0:t<4&&(r=!0);let s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);let a=t+n-e,l=(t&1)==1,c=(n&1)==0;if(a==1)if(l){if(c)throw new v;i=!0}else{if(!c)throw new v;o=!0}else if(a==-1)if(l){if(c)throw new v;r=!0}else{if(!c)throw new v;s=!0}else if(a==0){if(l){if(!c)throw new v;t<n?(r=!0,o=!0):(i=!0,s=!0)}else if(c)throw new v}else throw new v;if(r){if(i)throw new v;L.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&L.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(o)throw new v;L.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&L.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}L.SYMBOL_WIDEST=[7,5,4,3,1],L.EVEN_TOTAL_SUBSET=[4,20,52,104,204],L.GSUM=[0,348,1388,2948,3988],L.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],L.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],L.FINDER_PAT_A=0,L.FINDER_PAT_B=1,L.FINDER_PAT_C=2,L.FINDER_PAT_D=3,L.FINDER_PAT_E=4,L.FINDER_PAT_F=5,L.FINDER_PATTERN_SEQUENCES=[[L.FINDER_PAT_A,L.FINDER_PAT_A],[L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B],[L.FINDER_PAT_A,L.FINDER_PAT_C,L.FINDER_PAT_B,L.FINDER_PAT_D],[L.FINDER_PAT_A,L.FINDER_PAT_E,L.FINDER_PAT_B,L.FINDER_PAT_D,L.FINDER_PAT_C],[L.FINDER_PAT_A,L.FINDER_PAT_E,L.FINDER_PAT_B,L.FINDER_PAT_D,L.FINDER_PAT_D,L.FINDER_PAT_F],[L.FINDER_PAT_A,L.FINDER_PAT_E,L.FINDER_PAT_B,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_F,L.FINDER_PAT_F],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_D],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_E],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_F,L.FINDER_PAT_F],[L.FINDER_PAT_A,L.FINDER_PAT_A,L.FINDER_PAT_B,L.FINDER_PAT_B,L.FINDER_PAT_C,L.FINDER_PAT_D,L.FINDER_PAT_D,L.FINDER_PAT_E,L.FINDER_PAT_E,L.FINDER_PAT_F,L.FINDER_PAT_F]],L.MAX_PAIRS=11;class Fi extends cn{constructor(e,t,n){super(e,t),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ge extends ot{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,n){const r=this.decodePair(t,!1,e,n);Ge.addOrTally(this.possibleLeftPairs,r),t.reverse();let i=this.decodePair(t,!0,e,n);Ge.addOrTally(this.possibleRightPairs,i),t.reverse();for(let s of this.possibleLeftPairs)if(s.getCount()>1){for(let o of this.possibleRightPairs)if(o.getCount()>1&&Ge.checkChecksum(s,o))return Ge.constructResult(s,o)}throw new v}static addOrTally(e,t){if(t==null)return;let n=!1;for(let r of e)if(r.getValue()===t.getValue()){r.incrementCount(),n=!0;break}n||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let n=4537077*e.getValue()+t.getValue(),r=new String(n).toString(),i=new re;for(let l=13-r.length;l>0;l--)i.append("0");i.append(r);let s=0;for(let l=0;l<13;l++){let c=i.charAt(l).charCodeAt(0)-48;s+=(l&1)===0?3*c:c}s=10-s%10,s===10&&(s=0),i.append(s.toString());let o=e.getFinderPattern().getResultPoints(),a=t.getFinderPattern().getResultPoints();return new D(i.toString(),null,0,[o[0],o[1],a[0],a[1]],B.RSS_14,new Date().getTime())}static checkChecksum(e,t){let n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,n===r}decodePair(e,t,n,r){try{let i=this.findFinderPattern(e,t),s=this.parseFoundFinderPattern(e,n,t,i),o=r==null?null:r.get(Ce.NEED_RESULT_POINT_CALLBACK);if(o!=null){let c=(i[0]+i[1])/2;t&&(c=e.getSize()-1-c),o.foundPossibleResultPoint(new Z(c,n))}let a=this.decodeDataCharacter(e,s,!0),l=this.decodeDataCharacter(e,s,!1);return new Fi(1597*a.getValue()+l.getValue(),a.getChecksumPortion()+4*l.getChecksumPortion(),s)}catch{return null}}decodeDataCharacter(e,t,n){let r=this.getDataCharacterCounters();for(let _=0;_<r.length;_++)r[_]=0;if(n)je.recordPatternInReverse(e,t.getStartEnd()[0],r);else{je.recordPattern(e,t.getStartEnd()[1]+1,r);for(let _=0,R=r.length-1;_<R;_++,R--){let H=r[_];r[_]=r[R],r[R]=H}}let i=n?16:15,s=Ee.sum(new Int32Array(r))/i,o=this.getOddCounts(),a=this.getEvenCounts(),l=this.getOddRoundingErrors(),c=this.getEvenRoundingErrors();for(let _=0;_<r.length;_++){let R=r[_]/s,H=Math.floor(R+.5);H<1?H=1:H>8&&(H=8);let W=Math.floor(_/2);(_&1)===0?(o[W]=H,l[W]=R-H):(a[W]=H,c[W]=R-H)}this.adjustOddEvenCounts(n,i);let h=0,g=0;for(let _=o.length-1;_>=0;_--)g*=9,g+=o[_],h+=o[_];let A=0,b=0;for(let _=a.length-1;_>=0;_--)A*=9,A+=a[_],b+=a[_];let y=g+3*A;if(n){if((h&1)!==0||h>12||h<4)throw new v;let _=(12-h)/2,R=Ge.OUTSIDE_ODD_WIDEST[_],H=9-R,W=Bt.getRSSvalue(o,R,!1),V=Bt.getRSSvalue(a,H,!0),Ae=Ge.OUTSIDE_EVEN_TOTAL_SUBSET[_],le=Ge.OUTSIDE_GSUM[_];return new cn(W*Ae+V+le,y)}else{if((b&1)!==0||b>10||b<4)throw new v;let _=(10-b)/2,R=Ge.INSIDE_ODD_WIDEST[_],H=9-R,W=Bt.getRSSvalue(o,R,!0),V=Bt.getRSSvalue(a,H,!1),Ae=Ge.INSIDE_ODD_TOTAL_SUBSET[_],le=Ge.INSIDE_GSUM[_];return new cn(V*Ae+W+le,y)}}findFinderPattern(e,t){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let r=e.getSize(),i=!1,s=0;for(;s<r&&(i=!e.get(s),t!==i);)s++;let o=0,a=s;for(let l=s;l<r;l++)if(e.get(l)!==i)n[o]++;else{if(o===3){if(ot.isFinderPattern(n))return[a,l];a+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,o--}else o++;n[o]=1,i=!i}throw new v}parseFoundFinderPattern(e,t,n,r){let i=e.get(r[0]),s=r[0]-1;for(;s>=0&&i!==e.get(s);)s--;s++;const o=r[0]-s,a=this.getDecodeFinderCounters(),l=new Int32Array(a.length);J.arraycopy(a,0,l,1,a.length-1),l[0]=o;const c=this.parseFinderValue(l,Ge.FINDER_PATTERNS);let h=s,g=r[1];return n&&(h=e.getSize()-1-h,g=e.getSize()-1-g),new Fn(c,[s,r[1]],h,g,t)}adjustOddEvenCounts(e,t){let n=Ee.sum(new Int32Array(this.getOddCounts())),r=Ee.sum(new Int32Array(this.getEvenCounts())),i=!1,s=!1,o=!1,a=!1;e?(n>12?s=!0:n<4&&(i=!0),r>12?a=!0:r<4&&(o=!0)):(n>11?s=!0:n<5&&(i=!0),r>10?a=!0:r<4&&(o=!0));let l=n+r-t,c=(n&1)===(e?1:0),h=(r&1)===1;if(l===1)if(c){if(h)throw new v;s=!0}else{if(!h)throw new v;a=!0}else if(l===-1)if(c){if(h)throw new v;i=!0}else{if(!h)throw new v;o=!0}else if(l===0){if(c){if(!h)throw new v;n<r?(i=!0,a=!0):(s=!0,o=!0)}else if(h)throw new v}else throw new v;if(i){if(s)throw new v;ot.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&ot.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(a)throw new v;ot.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&ot.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ge.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ge.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ge.OUTSIDE_GSUM=[0,161,961,2015,2715],Ge.INSIDE_GSUM=[0,336,1036,1516],Ge.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ge.INSIDE_ODD_WIDEST=[2,4,6,8],Ge.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class hn extends je{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const n=e?e.get(Ce.POSSIBLE_FORMATS):null,r=e&&e.get(Ce.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;n?((n.includes(B.EAN_13)||n.includes(B.UPC_A)||n.includes(B.EAN_8)||n.includes(B.UPC_E))&&this.readers.push(new Jn(e)),n.includes(B.CODE_39)&&this.readers.push(new Ze(r)),n.includes(B.CODE_128)&&this.readers.push(new z),n.includes(B.ITF)&&this.readers.push(new Re),n.includes(B.RSS_14)&&this.readers.push(new Ge),n.includes(B.RSS_EXPANDED)&&this.readers.push(new L(this.verbose))):(this.readers.push(new Jn(e)),this.readers.push(new Ze),this.readers.push(new Jn(e)),this.readers.push(new z),this.readers.push(new Re),this.readers.push(new Ge),this.readers.push(new L(this.verbose)))}decodeRow(e,t,n){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,n)}catch{}throw new v}reset(){this.readers.forEach(e=>e.reset())}}class Ui extends et{constructor(e=500,t){super(new hn(t),e,t)}}class Ne{constructor(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Te{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class pe{constructor(e,t,n,r,i,s){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=i,this.ecBlocks=s;let o=0;const a=s.getECCodewords(),l=s.getECBlocks();for(let c of l)o+=c.getCount()*(c.getDataCodewords()+a);this.totalCodewords=o}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if((e&1)!==0||(t&1)!==0)throw new U;for(let n of pe.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===t)return n;throw new U}toString(){return""+this.versionNumber}static buildVersions(){return[new pe(1,10,10,8,8,new Ne(5,new Te(1,3))),new pe(2,12,12,10,10,new Ne(7,new Te(1,5))),new pe(3,14,14,12,12,new Ne(10,new Te(1,8))),new pe(4,16,16,14,14,new Ne(12,new Te(1,12))),new pe(5,18,18,16,16,new Ne(14,new Te(1,18))),new pe(6,20,20,18,18,new Ne(18,new Te(1,22))),new pe(7,22,22,20,20,new Ne(20,new Te(1,30))),new pe(8,24,24,22,22,new Ne(24,new Te(1,36))),new pe(9,26,26,24,24,new Ne(28,new Te(1,44))),new pe(10,32,32,14,14,new Ne(36,new Te(1,62))),new pe(11,36,36,16,16,new Ne(42,new Te(1,86))),new pe(12,40,40,18,18,new Ne(48,new Te(1,114))),new pe(13,44,44,20,20,new Ne(56,new Te(1,144))),new pe(14,48,48,22,22,new Ne(68,new Te(1,174))),new pe(15,52,52,24,24,new Ne(42,new Te(2,102))),new pe(16,64,64,14,14,new Ne(56,new Te(2,140))),new pe(17,72,72,16,16,new Ne(36,new Te(4,92))),new pe(18,80,80,18,18,new Ne(48,new Te(4,114))),new pe(19,88,88,20,20,new Ne(56,new Te(4,144))),new pe(20,96,96,22,22,new Ne(68,new Te(4,174))),new pe(21,104,104,24,24,new Ne(56,new Te(6,136))),new pe(22,120,120,18,18,new Ne(68,new Te(6,175))),new pe(23,132,132,20,20,new Ne(62,new Te(8,163))),new pe(24,144,144,22,22,new Ne(62,new Te(8,156),new Te(2,155))),new pe(25,8,18,6,16,new Ne(7,new Te(1,5))),new pe(26,8,32,6,14,new Ne(11,new Te(1,10))),new pe(27,12,26,10,24,new Ne(14,new Te(1,16))),new pe(28,12,36,10,16,new Ne(18,new Te(1,22))),new pe(29,16,36,14,16,new Ne(24,new Te(1,32))),new pe(30,16,48,14,22,new Ne(28,new Te(1,49)))]}}pe.VERSIONS=pe.buildVersions();class nr{constructor(e){const t=e.getHeight();if(t<8||t>144||(t&1)!==0)throw new U;this.version=nr.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new ye(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),n=e.getWidth();return pe.getVersionForDimensions(t,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,n=4,r=0;const i=this.mappingBitMatrix.getHeight(),s=this.mappingBitMatrix.getWidth();let o=!1,a=!1,l=!1,c=!1;do if(n===i&&r===0&&!o)e[t++]=this.readCorner1(i,s)&255,n-=2,r+=2,o=!0;else if(n===i-2&&r===0&&(s&3)!==0&&!a)e[t++]=this.readCorner2(i,s)&255,n-=2,r+=2,a=!0;else if(n===i+4&&r===2&&(s&7)===0&&!l)e[t++]=this.readCorner3(i,s)&255,n-=2,r+=2,l=!0;else if(n===i-2&&r===0&&(s&7)===4&&!c)e[t++]=this.readCorner4(i,s)&255,n-=2,r+=2,c=!0;else{do n<i&&r>=0&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,s)&255),n-=2,r+=2;while(n>=0&&r<s);n+=1,r+=3;do n>=0&&r<s&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,s)&255),n+=2,r-=2;while(n<i&&r>=0);n+=3,r+=1}while(n<i||r<s);if(t!==this.version.getTotalCodewords())throw new U;return e}readModule(e,t,n,r){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,n,r){let i=0;return this.readModule(e-2,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t,n,r)&&(i|=1),i<<=1,this.readModule(e,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e,t,n,r)&&(i|=1),i}readCorner1(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}readCorner2(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner3(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner4(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new M("Dimension of bitMatrix must match the version size");const r=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),s=t/r|0,o=n/i|0,a=s*r,l=o*i,c=new ye(l,a);for(let h=0;h<s;++h){const g=h*r;for(let A=0;A<o;++A){const b=A*i;for(let y=0;y<r;++y){const _=h*(r+2)+1+y,R=g+y;for(let H=0;H<i;++H){const W=A*(i+2)+1+H;if(e.get(W,_)){const V=b+H;c.set(V,R)}}}}}return c}}class rr{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const n=t.getECBlocks();let r=0;const i=n.getECBlocks();for(let y of i)r+=y.getCount();const s=new Array(r);let o=0;for(let y of i)for(let _=0;_<y.getCount();_++){const R=y.getDataCodewords(),H=n.getECCodewords()+R;s[o++]=new rr(R,new Uint8Array(H))}const l=s[0].codewords.length-n.getECCodewords(),c=l-1;let h=0;for(let y=0;y<c;y++)for(let _=0;_<o;_++)s[_].codewords[y]=e[h++];const g=t.getVersionNumber()===24,A=g?8:o;for(let y=0;y<A;y++)s[y].codewords[l-1]=e[h++];const b=s[0].codewords.length;for(let y=l;y<b;y++)for(let _=0;_<o;_++){const R=g?(_+8)%o:_,H=g&&R>7?y-1:y;s[R].codewords[H]=e[h++]}if(h!==e.length)throw new M;return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class ir{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new M(""+e);let t=0,n=this.bitOffset,r=this.byteOffset;const i=this.bytes;if(n>0){const s=8-n,o=e<s?e:s,a=s-o,l=255>>8-o<<a;t=(i[r]&l)>>a,e-=o,n+=o,n===8&&(n=0,r++)}if(e>0){for(;e>=8;)t=t<<8|i[r]&255,r++,e-=8;if(e>0){const s=8-e,o=255>>s<<s;t=t<<e|(i[r]&o)>>s,n+=e}}return this.bitOffset=n,this.byteOffset=r,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var qe;(function(f){f[f.PAD_ENCODE=0]="PAD_ENCODE",f[f.ASCII_ENCODE=1]="ASCII_ENCODE",f[f.C40_ENCODE=2]="C40_ENCODE",f[f.TEXT_ENCODE=3]="TEXT_ENCODE",f[f.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",f[f.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",f[f.BASE256_ENCODE=6]="BASE256_ENCODE"})(qe||(qe={}));class Xt{static decode(e){const t=new ir(e),n=new re,r=new re,i=new Array;let s=qe.ASCII_ENCODE;do if(s===qe.ASCII_ENCODE)s=this.decodeAsciiSegment(t,n,r);else{switch(s){case qe.C40_ENCODE:this.decodeC40Segment(t,n);break;case qe.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case qe.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case qe.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case qe.BASE256_ENCODE:this.decodeBase256Segment(t,n,i);break;default:throw new U}s=qe.ASCII_ENCODE}while(s!==qe.PAD_ENCODE&&t.available()>0);return r.length()>0&&n.append(r.toString()),new gt(e,n.toString(),i.length===0?null:i,null)}static decodeAsciiSegment(e,t,n){let r=!1;do{let i=e.readBits(8);if(i===0)throw new U;if(i<=128)return r&&(i+=128),t.append(String.fromCharCode(i-1)),qe.ASCII_ENCODE;if(i===129)return qe.PAD_ENCODE;if(i<=229){const s=i-130;s<10&&t.append("0"),t.append(""+s)}else switch(i){case 230:return qe.C40_ENCODE;case 231:return qe.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:r=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return qe.ANSIX12_ENCODE;case 239:return qe.TEXT_ENCODE;case 240:return qe.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new U;break}}while(e.available()>0);return qe.ASCII_ENCODE}static decodeC40Segment(e,t){let n=!1;const r=[];let i=0;do{if(e.available()===8)return;const s=e.readBits(8);if(s===254)return;this.parseTwoBytes(s,e.readBits(8),r);for(let o=0;o<3;o++){const a=r[o];switch(i){case 0:if(a<3)i=a+1;else if(a<this.C40_BASIC_SET_CHARS.length){const l=this.C40_BASIC_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else throw new U;break;case 1:n?(t.append(String.fromCharCode(a+128)),n=!1):t.append(String.fromCharCode(a)),i=0;break;case 2:if(a<this.C40_SHIFT2_SET_CHARS.length){const l=this.C40_SHIFT2_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(a){case 27:t.append("");break;case 30:n=!0;break;default:throw new U}i=0;break;case 3:n?(t.append(String.fromCharCode(a+224)),n=!1):t.append(String.fromCharCode(a+96)),i=0;break;default:throw new U}}}while(e.available()>0)}static decodeTextSegment(e,t){let n=!1,r=[],i=0;do{if(e.available()===8)return;const s=e.readBits(8);if(s===254)return;this.parseTwoBytes(s,e.readBits(8),r);for(let o=0;o<3;o++){const a=r[o];switch(i){case 0:if(a<3)i=a+1;else if(a<this.TEXT_BASIC_SET_CHARS.length){const l=this.TEXT_BASIC_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else throw new U;break;case 1:n?(t.append(String.fromCharCode(a+128)),n=!1):t.append(String.fromCharCode(a)),i=0;break;case 2:if(a<this.TEXT_SHIFT2_SET_CHARS.length){const l=this.TEXT_SHIFT2_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(a){case 27:t.append("");break;case 30:n=!0;break;default:throw new U}i=0;break;case 3:if(a<this.TEXT_SHIFT3_SET_CHARS.length){const l=this.TEXT_SHIFT3_SET_CHARS[a];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l),i=0}else throw new U;break;default:throw new U}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const n=[];do{if(e.available()===8)return;const r=e.readBits(8);if(r===254)return;this.parseTwoBytes(r,e.readBits(8),n);for(let i=0;i<3;i++){const s=n[i];switch(s){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(s<14)t.append(String.fromCharCode(s+44));else if(s<40)t.append(String.fromCharCode(s+51));else throw new U;break}}}while(e.available()>0)}static parseTwoBytes(e,t,n){let r=(e<<8)+t-1,i=Math.floor(r/1600);n[0]=i,r-=i*1600,i=Math.floor(r/40),n[1]=i,n[2]=r-i*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let r=e.readBits(6);if(r===31){const i=8-e.getBitOffset();i!==8&&e.readBits(i);return}(r&32)===0&&(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,n){let r=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),r++);let s;if(i===0?s=e.available()/8|0:i<250?s=i:s=250*(i-249)+this.unrandomize255State(e.readBits(8),r++),s<0)throw new U;const o=new Uint8Array(s);for(let a=0;a<s;a++){if(e.available()<8)throw new U;o[a]=this.unrandomize255State(e.readBits(8),r++)}n.push(o);try{t.append(ze.decode(o,$.ISO88591))}catch(a){throw new Mt("Platform does not support required encoding: "+a.message)}}static unrandomize255State(e,t){const n=149*t%255+1,r=e-n;return r>=0?r:r+256}}Xt.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Xt.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Xt.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Xt.TEXT_SHIFT2_SET_CHARS=Xt.C40_SHIFT2_SET_CHARS,Xt.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Vi{constructor(){this.rsDecoder=new bn(_e.DATA_MATRIX_FIELD_256)}decode(e){const t=new nr(e),n=t.getVersion(),r=t.readCodewords(),i=rr.getDataBlocks(r,n);let s=0;for(let l of i)s+=l.getNumDataCodewords();const o=new Uint8Array(s),a=i.length;for(let l=0;l<a;l++){const c=i[l],h=c.getCodewords(),g=c.getNumDataCodewords();this.correctErrors(h,g);for(let A=0;A<g;A++)o[A*a+l]=h[A]}return Xt.decode(o)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new te}for(let r=0;r<t;r++)e[r]=n[r]}}class Xe{constructor(e){this.image=e,this.rectangleDetector=new Vt(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new v;t=this.shiftToModuleCenter(t);const n=t[0],r=t[1],i=t[2],s=t[3];let o=this.transitionsBetween(n,s)+1,a=this.transitionsBetween(i,s)+1;(o&1)===1&&(o+=1),(a&1)===1&&(a+=1),4*o<7*a&&4*a<7*o&&(o=a=Math.max(o,a));let l=Xe.sampleGrid(this.image,n,r,i,s,o,a);return new Pn(l,[n,r,i,s])}static shiftPoint(e,t,n){let r=(t.getX()-e.getX())/(n+1),i=(t.getY()-e.getY())/(n+1);return new Z(e.getX()+r,e.getY()+i)}static moveAway(e,t,n){let r=e.getX(),i=e.getY();return r<t?r-=1:r+=1,i<n?i-=1:i+=1,new Z(r,i)}detectSolid1(e){let t=e[0],n=e[1],r=e[3],i=e[2],s=this.transitionsBetween(t,n),o=this.transitionsBetween(n,r),a=this.transitionsBetween(r,i),l=this.transitionsBetween(i,t),c=s,h=[i,t,n,r];return c>o&&(c=o,h[0]=t,h[1]=n,h[2]=r,h[3]=i),c>a&&(c=a,h[0]=n,h[1]=r,h[2]=i,h[3]=t),c>l&&(h[0]=r,h[1]=i,h[2]=t,h[3]=n),h}detectSolid2(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i),o=Xe.shiftPoint(n,r,(s+1)*4),a=Xe.shiftPoint(r,n,(s+1)*4),l=this.transitionsBetween(o,t),c=this.transitionsBetween(a,i);return l<c?(e[0]=t,e[1]=n,e[2]=r,e[3]=i):(e[0]=n,e[1]=r,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i),o=this.transitionsBetween(n,i),a=Xe.shiftPoint(t,n,(o+1)*4),l=Xe.shiftPoint(r,n,(s+1)*4);s=this.transitionsBetween(a,i),o=this.transitionsBetween(l,i);let c=new Z(i.getX()+(r.getX()-n.getX())/(s+1),i.getY()+(r.getY()-n.getY())/(s+1)),h=new Z(i.getX()+(t.getX()-n.getX())/(o+1),i.getY()+(t.getY()-n.getY())/(o+1));if(!this.isValid(c))return this.isValid(h)?h:null;if(!this.isValid(h))return c;let g=this.transitionsBetween(a,c)+this.transitionsBetween(l,c),A=this.transitionsBetween(a,h)+this.transitionsBetween(l,h);return g>A?c:h}shiftToModuleCenter(e){let t=e[0],n=e[1],r=e[2],i=e[3],s=this.transitionsBetween(t,i)+1,o=this.transitionsBetween(r,i)+1,a=Xe.shiftPoint(t,n,o*4),l=Xe.shiftPoint(r,n,s*4);s=this.transitionsBetween(a,i)+1,o=this.transitionsBetween(l,i)+1,(s&1)===1&&(s+=1),(o&1)===1&&(o+=1);let c=(t.getX()+n.getX()+r.getX()+i.getX())/4,h=(t.getY()+n.getY()+r.getY()+i.getY())/4;t=Xe.moveAway(t,c,h),n=Xe.moveAway(n,c,h),r=Xe.moveAway(r,c,h),i=Xe.moveAway(i,c,h);let g,A;return a=Xe.shiftPoint(t,n,o*4),a=Xe.shiftPoint(a,i,s*4),g=Xe.shiftPoint(n,t,o*4),g=Xe.shiftPoint(g,r,s*4),l=Xe.shiftPoint(r,i,o*4),l=Xe.shiftPoint(l,n,s*4),A=Xe.shiftPoint(i,r,o*4),A=Xe.shiftPoint(A,t,s*4),[a,g,l,A]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,n,r,i,s,o){return Ht.getInstance().sampleGrid(e,s,o,.5,.5,s-.5,.5,s-.5,o-.5,.5,o-.5,t.getX(),t.getY(),i.getX(),i.getY(),r.getX(),r.getY(),n.getX(),n.getY())}transitionsBetween(e,t){let n=Math.trunc(e.getX()),r=Math.trunc(e.getY()),i=Math.trunc(t.getX()),s=Math.trunc(t.getY()),o=Math.abs(s-r)>Math.abs(i-n);if(o){let y=n;n=r,r=y,y=i,i=s,s=y}let a=Math.abs(i-n),l=Math.abs(s-r),c=-a/2,h=r<s?1:-1,g=n<i?1:-1,A=0,b=this.image.get(o?r:n,o?n:r);for(let y=n,_=r;y!==i;y+=g){let R=this.image.get(o?_:y,o?y:_);if(R!==b&&(A++,b=R),c+=l,c>0){if(_===s)break;_+=h,c-=a}}return A}}class zt{constructor(){this.decoder=new Vi}decode(e,t=null){let n,r;if(t!=null&&t.has(Ce.PURE_BARCODE)){const l=zt.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(l),r=zt.NO_POINTS}else{const l=new Xe(e.getBlackMatrix()).detect();n=this.decoder.decode(l.getBits()),r=l.getPoints()}const i=n.getRawBytes(),s=new D(n.getText(),i,8*i.length,r,B.DATA_MATRIX,J.currentTimeMillis()),o=n.getByteSegments();o!=null&&s.putMetadata(de.BYTE_SEGMENTS,o);const a=n.getECLevel();return a!=null&&s.putMetadata(de.ERROR_CORRECTION_LEVEL,a),s}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new v;const r=this.moduleSize(t,e);let i=t[1];const s=n[1];let o=t[0];const l=(n[0]-o+1)/r,c=(s-i+1)/r;if(l<=0||c<=0)throw new v;const h=r/2;i+=h,o+=h;const g=new ye(l,c);for(let A=0;A<c;A++){const b=i+A*r;for(let y=0;y<l;y++)e.get(o+y*r,b)&&g.set(y,A)}return g}static moduleSize(e,t){const n=t.getWidth();let r=e[0];const i=e[1];for(;r<n&&t.get(r,i);)r++;if(r===n)throw new v;const s=r-e[0];if(s===0)throw new v;return s}}zt.NO_POINTS=[];class Gi extends et{constructor(e=500){super(new zt,e)}}var dn;(function(f){f[f.L=0]="L",f[f.M=1]="M",f[f.Q=2]="Q",f[f.H=3]="H"})(dn||(dn={}));class Be{constructor(e,t,n){this.value=e,this.stringValue=t,this.bits=n,Be.FOR_BITS.set(n,this),Be.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return Be.L;case"M":return Be.M;case"Q":return Be.Q;case"H":return Be.H;default:throw new P(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof Be))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=Be.FOR_BITS.size)throw new M;return Be.FOR_BITS.get(e)}}Be.FOR_BITS=new Map,Be.FOR_VALUE=new Map,Be.L=new Be(dn.L,"L",1),Be.M=new Be(dn.M,"M",0),Be.Q=new Be(dn.Q,"Q",3),Be.H=new Be(dn.H,"H",2);class at{constructor(e){this.errorCorrectionLevel=Be.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return K.bitCount(e^t)}static decodeFormatInformation(e,t){const n=at.doDecodeFormatInformation(e,t);return n!==null?n:at.doDecodeFormatInformation(e^at.FORMAT_INFO_MASK_QR,t^at.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;for(const i of at.FORMAT_INFO_DECODE_LOOKUP){const s=i[0];if(s===e||s===t)return new at(i[1]);let o=at.numBitsDiffering(e,s);o<n&&(r=i[1],n=o),e!==t&&(o=at.numBitsDiffering(t,s),o<n&&(r=i[1],n=o))}return n<=3?new at(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof at))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}at.FORMAT_INFO_MASK_QR=21522,at.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class S{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const n of t)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class m{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Q{constructor(e,t,...n){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=n;let r=0;const i=n[0].getECCodewordsPerBlock(),s=n[0].getECBlocks();for(const o of s)r+=o.getCount()*(o.getDataCodewords()+i);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new U;try{return this.getVersionForNumber((e-17)/4)}catch{throw new U}}static getVersionForNumber(e){if(e<1||e>40)throw new M;return Q.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,n=0;for(let r=0;r<Q.VERSION_DECODE_INFO.length;r++){const i=Q.VERSION_DECODE_INFO[r];if(i===e)return Q.getVersionForNumber(r+7);const s=at.numBitsDiffering(e,i);s<t&&(n=r+7,t=s)}return t<=3?Q.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new ye(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let r=0;r<n;r++){const i=this.alignmentPatternCenters[r]-2;for(let s=0;s<n;s++)r===0&&(s===0||s===n-1)||r===n-1&&s===0||t.setRegion(this.alignmentPatternCenters[s]-2,i,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}Q.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Q.VERSIONS=[new Q(1,new Int32Array(0),new S(7,new m(1,19)),new S(10,new m(1,16)),new S(13,new m(1,13)),new S(17,new m(1,9))),new Q(2,Int32Array.from([6,18]),new S(10,new m(1,34)),new S(16,new m(1,28)),new S(22,new m(1,22)),new S(28,new m(1,16))),new Q(3,Int32Array.from([6,22]),new S(15,new m(1,55)),new S(26,new m(1,44)),new S(18,new m(2,17)),new S(22,new m(2,13))),new Q(4,Int32Array.from([6,26]),new S(20,new m(1,80)),new S(18,new m(2,32)),new S(26,new m(2,24)),new S(16,new m(4,9))),new Q(5,Int32Array.from([6,30]),new S(26,new m(1,108)),new S(24,new m(2,43)),new S(18,new m(2,15),new m(2,16)),new S(22,new m(2,11),new m(2,12))),new Q(6,Int32Array.from([6,34]),new S(18,new m(2,68)),new S(16,new m(4,27)),new S(24,new m(4,19)),new S(28,new m(4,15))),new Q(7,Int32Array.from([6,22,38]),new S(20,new m(2,78)),new S(18,new m(4,31)),new S(18,new m(2,14),new m(4,15)),new S(26,new m(4,13),new m(1,14))),new Q(8,Int32Array.from([6,24,42]),new S(24,new m(2,97)),new S(22,new m(2,38),new m(2,39)),new S(22,new m(4,18),new m(2,19)),new S(26,new m(4,14),new m(2,15))),new Q(9,Int32Array.from([6,26,46]),new S(30,new m(2,116)),new S(22,new m(3,36),new m(2,37)),new S(20,new m(4,16),new m(4,17)),new S(24,new m(4,12),new m(4,13))),new Q(10,Int32Array.from([6,28,50]),new S(18,new m(2,68),new m(2,69)),new S(26,new m(4,43),new m(1,44)),new S(24,new m(6,19),new m(2,20)),new S(28,new m(6,15),new m(2,16))),new Q(11,Int32Array.from([6,30,54]),new S(20,new m(4,81)),new S(30,new m(1,50),new m(4,51)),new S(28,new m(4,22),new m(4,23)),new S(24,new m(3,12),new m(8,13))),new Q(12,Int32Array.from([6,32,58]),new S(24,new m(2,92),new m(2,93)),new S(22,new m(6,36),new m(2,37)),new S(26,new m(4,20),new m(6,21)),new S(28,new m(7,14),new m(4,15))),new Q(13,Int32Array.from([6,34,62]),new S(26,new m(4,107)),new S(22,new m(8,37),new m(1,38)),new S(24,new m(8,20),new m(4,21)),new S(22,new m(12,11),new m(4,12))),new Q(14,Int32Array.from([6,26,46,66]),new S(30,new m(3,115),new m(1,116)),new S(24,new m(4,40),new m(5,41)),new S(20,new m(11,16),new m(5,17)),new S(24,new m(11,12),new m(5,13))),new Q(15,Int32Array.from([6,26,48,70]),new S(22,new m(5,87),new m(1,88)),new S(24,new m(5,41),new m(5,42)),new S(30,new m(5,24),new m(7,25)),new S(24,new m(11,12),new m(7,13))),new Q(16,Int32Array.from([6,26,50,74]),new S(24,new m(5,98),new m(1,99)),new S(28,new m(7,45),new m(3,46)),new S(24,new m(15,19),new m(2,20)),new S(30,new m(3,15),new m(13,16))),new Q(17,Int32Array.from([6,30,54,78]),new S(28,new m(1,107),new m(5,108)),new S(28,new m(10,46),new m(1,47)),new S(28,new m(1,22),new m(15,23)),new S(28,new m(2,14),new m(17,15))),new Q(18,Int32Array.from([6,30,56,82]),new S(30,new m(5,120),new m(1,121)),new S(26,new m(9,43),new m(4,44)),new S(28,new m(17,22),new m(1,23)),new S(28,new m(2,14),new m(19,15))),new Q(19,Int32Array.from([6,30,58,86]),new S(28,new m(3,113),new m(4,114)),new S(26,new m(3,44),new m(11,45)),new S(26,new m(17,21),new m(4,22)),new S(26,new m(9,13),new m(16,14))),new Q(20,Int32Array.from([6,34,62,90]),new S(28,new m(3,107),new m(5,108)),new S(26,new m(3,41),new m(13,42)),new S(30,new m(15,24),new m(5,25)),new S(28,new m(15,15),new m(10,16))),new Q(21,Int32Array.from([6,28,50,72,94]),new S(28,new m(4,116),new m(4,117)),new S(26,new m(17,42)),new S(28,new m(17,22),new m(6,23)),new S(30,new m(19,16),new m(6,17))),new Q(22,Int32Array.from([6,26,50,74,98]),new S(28,new m(2,111),new m(7,112)),new S(28,new m(17,46)),new S(30,new m(7,24),new m(16,25)),new S(24,new m(34,13))),new Q(23,Int32Array.from([6,30,54,78,102]),new S(30,new m(4,121),new m(5,122)),new S(28,new m(4,47),new m(14,48)),new S(30,new m(11,24),new m(14,25)),new S(30,new m(16,15),new m(14,16))),new Q(24,Int32Array.from([6,28,54,80,106]),new S(30,new m(6,117),new m(4,118)),new S(28,new m(6,45),new m(14,46)),new S(30,new m(11,24),new m(16,25)),new S(30,new m(30,16),new m(2,17))),new Q(25,Int32Array.from([6,32,58,84,110]),new S(26,new m(8,106),new m(4,107)),new S(28,new m(8,47),new m(13,48)),new S(30,new m(7,24),new m(22,25)),new S(30,new m(22,15),new m(13,16))),new Q(26,Int32Array.from([6,30,58,86,114]),new S(28,new m(10,114),new m(2,115)),new S(28,new m(19,46),new m(4,47)),new S(28,new m(28,22),new m(6,23)),new S(30,new m(33,16),new m(4,17))),new Q(27,Int32Array.from([6,34,62,90,118]),new S(30,new m(8,122),new m(4,123)),new S(28,new m(22,45),new m(3,46)),new S(30,new m(8,23),new m(26,24)),new S(30,new m(12,15),new m(28,16))),new Q(28,Int32Array.from([6,26,50,74,98,122]),new S(30,new m(3,117),new m(10,118)),new S(28,new m(3,45),new m(23,46)),new S(30,new m(4,24),new m(31,25)),new S(30,new m(11,15),new m(31,16))),new Q(29,Int32Array.from([6,30,54,78,102,126]),new S(30,new m(7,116),new m(7,117)),new S(28,new m(21,45),new m(7,46)),new S(30,new m(1,23),new m(37,24)),new S(30,new m(19,15),new m(26,16))),new Q(30,Int32Array.from([6,26,52,78,104,130]),new S(30,new m(5,115),new m(10,116)),new S(28,new m(19,47),new m(10,48)),new S(30,new m(15,24),new m(25,25)),new S(30,new m(23,15),new m(25,16))),new Q(31,Int32Array.from([6,30,56,82,108,134]),new S(30,new m(13,115),new m(3,116)),new S(28,new m(2,46),new m(29,47)),new S(30,new m(42,24),new m(1,25)),new S(30,new m(23,15),new m(28,16))),new Q(32,Int32Array.from([6,34,60,86,112,138]),new S(30,new m(17,115)),new S(28,new m(10,46),new m(23,47)),new S(30,new m(10,24),new m(35,25)),new S(30,new m(19,15),new m(35,16))),new Q(33,Int32Array.from([6,30,58,86,114,142]),new S(30,new m(17,115),new m(1,116)),new S(28,new m(14,46),new m(21,47)),new S(30,new m(29,24),new m(19,25)),new S(30,new m(11,15),new m(46,16))),new Q(34,Int32Array.from([6,34,62,90,118,146]),new S(30,new m(13,115),new m(6,116)),new S(28,new m(14,46),new m(23,47)),new S(30,new m(44,24),new m(7,25)),new S(30,new m(59,16),new m(1,17))),new Q(35,Int32Array.from([6,30,54,78,102,126,150]),new S(30,new m(12,121),new m(7,122)),new S(28,new m(12,47),new m(26,48)),new S(30,new m(39,24),new m(14,25)),new S(30,new m(22,15),new m(41,16))),new Q(36,Int32Array.from([6,24,50,76,102,128,154]),new S(30,new m(6,121),new m(14,122)),new S(28,new m(6,47),new m(34,48)),new S(30,new m(46,24),new m(10,25)),new S(30,new m(2,15),new m(64,16))),new Q(37,Int32Array.from([6,28,54,80,106,132,158]),new S(30,new m(17,122),new m(4,123)),new S(28,new m(29,46),new m(14,47)),new S(30,new m(49,24),new m(10,25)),new S(30,new m(24,15),new m(46,16))),new Q(38,Int32Array.from([6,32,58,84,110,136,162]),new S(30,new m(4,122),new m(18,123)),new S(28,new m(13,46),new m(32,47)),new S(30,new m(48,24),new m(14,25)),new S(30,new m(42,15),new m(32,16))),new Q(39,Int32Array.from([6,26,54,82,110,138,166]),new S(30,new m(20,117),new m(4,118)),new S(28,new m(40,47),new m(7,48)),new S(30,new m(43,24),new m(22,25)),new S(30,new m(10,15),new m(67,16))),new Q(40,Int32Array.from([6,30,58,86,114,142,170]),new S(30,new m(19,118),new m(6,119)),new S(28,new m(18,47),new m(31,48)),new S(30,new m(34,24),new m(34,25)),new S(30,new m(20,15),new m(61,16)))];var Je;(function(f){f[f.DATA_MASK_000=0]="DATA_MASK_000",f[f.DATA_MASK_001=1]="DATA_MASK_001",f[f.DATA_MASK_010=2]="DATA_MASK_010",f[f.DATA_MASK_011=3]="DATA_MASK_011",f[f.DATA_MASK_100=4]="DATA_MASK_100",f[f.DATA_MASK_101=5]="DATA_MASK_101",f[f.DATA_MASK_110=6]="DATA_MASK_110",f[f.DATA_MASK_111=7]="DATA_MASK_111"})(Je||(Je={}));class Tt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let n=0;n<t;n++)for(let r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)}}Tt.values=new Map([[Je.DATA_MASK_000,new Tt(Je.DATA_MASK_000,(f,e)=>(f+e&1)===0)],[Je.DATA_MASK_001,new Tt(Je.DATA_MASK_001,(f,e)=>(f&1)===0)],[Je.DATA_MASK_010,new Tt(Je.DATA_MASK_010,(f,e)=>e%3===0)],[Je.DATA_MASK_011,new Tt(Je.DATA_MASK_011,(f,e)=>(f+e)%3===0)],[Je.DATA_MASK_100,new Tt(Je.DATA_MASK_100,(f,e)=>(Math.floor(f/2)+Math.floor(e/3)&1)===0)],[Je.DATA_MASK_101,new Tt(Je.DATA_MASK_101,(f,e)=>f*e%6===0)],[Je.DATA_MASK_110,new Tt(Je.DATA_MASK_110,(f,e)=>f*e%6<3)],[Je.DATA_MASK_111,new Tt(Je.DATA_MASK_111,(f,e)=>(f+e+f*e%3&1)===0)]]);class Hi{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new U;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let i=0;i<6;i++)e=this.copyBit(i,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let i=5;i>=0;i--)e=this.copyBit(8,i,e);const t=this.bitMatrix.getHeight();let n=0;const r=t-7;for(let i=t-1;i>=r;i--)n=this.copyBit(8,i,n);for(let i=t-8;i<t;i++)n=this.copyBit(i,8,n);if(this.parsedFormatInfo=at.decodeFormatInformation(e,n),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new U}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Q.getVersionForNumber(t);let n=0;const r=e-11;for(let s=5;s>=0;s--)for(let o=e-9;o>=r;o--)n=this.copyBit(o,s,n);let i=Q.decodeVersionInformation(n);if(i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;n=0;for(let s=5;s>=0;s--)for(let o=e-9;o>=r;o--)n=this.copyBit(s,o,n);if(i=Q.decodeVersionInformation(n),i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new U}copyBit(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),n=Tt.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,r);const i=t.buildFunctionPattern();let s=!0;const o=new Uint8Array(t.getTotalCodewords());let a=0,l=0,c=0;for(let h=r-1;h>0;h-=2){h===6&&h--;for(let g=0;g<r;g++){const A=s?r-1-g:g;for(let b=0;b<2;b++)i.get(h-b,A)||(c++,l<<=1,this.bitMatrix.get(h-b,A)&&(l|=1),c===8&&(o[a++]=l,c=0,l=0))}s=!s}if(a!==t.getTotalCodewords())throw new U;return o}remask(){if(this.parsedFormatInfo===null)return;const e=Tt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,n=e.getWidth();t<n;t++)for(let r=t+1,i=e.getHeight();r<i;r++)e.get(t,r)!==e.get(r,t)&&(e.flip(r,t),e.flip(t,r))}}class sr{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,n){if(e.length!==t.getTotalCodewords())throw new M;const r=t.getECBlocksForLevel(n);let i=0;const s=r.getECBlocks();for(const b of s)i+=b.getCount();const o=new Array(i);let a=0;for(const b of s)for(let y=0;y<b.getCount();y++){const _=b.getDataCodewords(),R=r.getECCodewordsPerBlock()+_;o[a++]=new sr(_,new Uint8Array(R))}const l=o[0].codewords.length;let c=o.length-1;for(;c>=0&&o[c].codewords.length!==l;)c--;c++;const h=l-r.getECCodewordsPerBlock();let g=0;for(let b=0;b<h;b++)for(let y=0;y<a;y++)o[y].codewords[b]=e[g++];for(let b=c;b<a;b++)o[b].codewords[h]=e[g++];const A=o[0].codewords.length;for(let b=h;b<A;b++)for(let y=0;y<a;y++){const _=y<c?b:b+1;o[y].codewords[_]=e[g++]}return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Nt;(function(f){f[f.TERMINATOR=0]="TERMINATOR",f[f.NUMERIC=1]="NUMERIC",f[f.ALPHANUMERIC=2]="ALPHANUMERIC",f[f.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",f[f.BYTE=4]="BYTE",f[f.ECI=5]="ECI",f[f.KANJI=6]="KANJI",f[f.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",f[f.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",f[f.HANZI=9]="HANZI"})(Nt||(Nt={}));class ne{constructor(e,t,n,r){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=r,ne.FOR_BITS.set(r,this),ne.FOR_VALUE.set(e,this)}static forBits(e){const t=ne.FOR_BITS.get(e);if(t===void 0)throw new M;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof ne))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}ne.FOR_BITS=new Map,ne.FOR_VALUE=new Map,ne.TERMINATOR=new ne(Nt.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),ne.NUMERIC=new ne(Nt.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),ne.ALPHANUMERIC=new ne(Nt.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),ne.STRUCTURED_APPEND=new ne(Nt.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),ne.BYTE=new ne(Nt.BYTE,"BYTE",Int32Array.from([8,16,16]),4),ne.ECI=new ne(Nt.ECI,"ECI",Int32Array.from([0,0,0]),7),ne.KANJI=new ne(Nt.KANJI,"KANJI",Int32Array.from([8,10,12]),8),ne.FNC1_FIRST_POSITION=new ne(Nt.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),ne.FNC1_SECOND_POSITION=new ne(Nt.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),ne.HANZI=new ne(Nt.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Ue{static decode(e,t,n,r){const i=new ir(e);let s=new re;const o=new Array;let a=-1,l=-1;try{let c=null,h=!1,g;do{if(i.available()<4)g=ne.TERMINATOR;else{const A=i.readBits(4);g=ne.forBits(A)}switch(g){case ne.TERMINATOR:break;case ne.FNC1_FIRST_POSITION:case ne.FNC1_SECOND_POSITION:h=!0;break;case ne.STRUCTURED_APPEND:if(i.available()<16)throw new U;a=i.readBits(8),l=i.readBits(8);break;case ne.ECI:const A=Ue.parseECIValue(i);if(c=G.getCharacterSetECIByValue(A),c===null)throw new U;break;case ne.HANZI:const b=i.readBits(4),y=i.readBits(g.getCharacterCountBits(t));b===Ue.GB2312_SUBSET&&Ue.decodeHanziSegment(i,s,y);break;default:const _=i.readBits(g.getCharacterCountBits(t));switch(g){case ne.NUMERIC:Ue.decodeNumericSegment(i,s,_);break;case ne.ALPHANUMERIC:Ue.decodeAlphanumericSegment(i,s,_,h);break;case ne.BYTE:Ue.decodeByteSegment(i,s,_,c,o,r);break;case ne.KANJI:Ue.decodeKanjiSegment(i,s,_);break;default:throw new U}break}}while(g!==ne.TERMINATOR)}catch{throw new U}return new gt(e,s.toString(),o.length===0?null:o,n===null?null:n.toString(),a,l)}static decodeHanziSegment(e,t,n){if(n*13>e.available())throw new U;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const s=e.readBits(13);let o=s/96<<8&4294967295|s%96;o<959?o+=41377:o+=42657,r[i]=o>>8&255,r[i+1]=o&255,i+=2,n--}try{t.append(ze.decode(r,$.GB2312))}catch(s){throw new U(s)}}static decodeKanjiSegment(e,t,n){if(n*13>e.available())throw new U;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const s=e.readBits(13);let o=s/192<<8&4294967295|s%192;o<7936?o+=33088:o+=49472,r[i]=o>>8,r[i+1]=o,i+=2,n--}try{t.append(ze.decode(r,$.SHIFT_JIS))}catch(s){throw new U(s)}}static decodeByteSegment(e,t,n,r,i,s){if(8*n>e.available())throw new U;const o=new Uint8Array(n);for(let l=0;l<n;l++)o[l]=e.readBits(8);let a;r===null?a=$.guessEncoding(o,s):a=r.getName();try{t.append(ze.decode(o,a))}catch(l){throw new U(l)}i.push(o)}static toAlphaNumericChar(e){if(e>=Ue.ALPHANUMERIC_CHARS.length)throw new U;return Ue.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,n,r){const i=t.length();for(;n>1;){if(e.available()<11)throw new U;const s=e.readBits(11);t.append(Ue.toAlphaNumericChar(Math.floor(s/45))),t.append(Ue.toAlphaNumericChar(s%45)),n-=2}if(n===1){if(e.available()<6)throw new U;t.append(Ue.toAlphaNumericChar(e.readBits(6)))}if(r)for(let s=i;s<t.length();s++)t.charAt(s)==="%"&&(s<t.length()-1&&t.charAt(s+1)==="%"?t.deleteCharAt(s+1):t.setCharAt(s,""))}static decodeNumericSegment(e,t,n){for(;n>=3;){if(e.available()<10)throw new U;const r=e.readBits(10);if(r>=1e3)throw new U;t.append(Ue.toAlphaNumericChar(Math.floor(r/100))),t.append(Ue.toAlphaNumericChar(Math.floor(r/10)%10)),t.append(Ue.toAlphaNumericChar(r%10)),n-=3}if(n===2){if(e.available()<7)throw new U;const r=e.readBits(7);if(r>=100)throw new U;t.append(Ue.toAlphaNumericChar(Math.floor(r/10))),t.append(Ue.toAlphaNumericChar(r%10))}else if(n===1){if(e.available()<4)throw new U;const r=e.readBits(4);if(r>=10)throw new U;t.append(Ue.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if((t&128)===0)return t&127;if((t&192)===128){const n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){const n=e.readBits(16);return(t&31)<<16&4294967295|n}throw new U}}Ue.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Ue.GB2312_SUBSET=1;class Ur{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Wi{constructor(){this.rsDecoder=new bn(_e.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(ye.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const n=new Hi(e);let r=null;try{return this.decodeBitMatrixParser(n,t)}catch(i){r=i}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const i=this.decodeBitMatrixParser(n,t);return i.setOther(new Ur(!0)),i}catch(i){throw r!==null?r:i}}decodeBitMatrixParser(e,t){const n=e.readVersion(),r=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),s=sr.getDataBlocks(i,n,r);let o=0;for(const c of s)o+=c.getNumDataCodewords();const a=new Uint8Array(o);let l=0;for(const c of s){const h=c.getCodewords(),g=c.getNumDataCodewords();this.correctErrors(h,g);for(let A=0;A<g;A++)a[l++]=h[A]}return Ue.decode(a,n,r,t)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new te}for(let r=0;r<t;r++)e[r]=n[r]}}class or extends Z{constructor(e,t,n){super(e,t),this.estimatedModuleSize=n}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=(this.getX()+t)/2,i=(this.getY()+e)/2,s=(this.estimatedModuleSize+n)/2;return new or(r,i,s)}}class Gn{constructor(e,t,n,r,i,s,o){this.image=e,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=s,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,n=this.width,r=e+n,i=this.startY+t/2,s=new Int32Array(3),o=this.image;for(let a=0;a<t;a++){const l=i+((a&1)===0?Math.floor((a+1)/2):-Math.floor((a+1)/2));s[0]=0,s[1]=0,s[2]=0;let c=e;for(;c<r&&!o.get(c,l);)c++;let h=0;for(;c<r;){if(o.get(c,l))if(h===1)s[1]++;else if(h===2){if(this.foundPatternCross(s)){const g=this.handlePossibleCenter(s,l,c);if(g!==null)return g}s[0]=s[2],s[1]=1,s[2]=0,h=1}else s[++h]++;else h===1&&h++,s[h]++;c++}if(this.foundPatternCross(s)){const g=this.handlePossibleCenter(s,l,r);if(g!==null)return g}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new v}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,n=t/2;for(let r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let a=e;for(;a>=0&&i.get(t,a)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&!i.get(t,a)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(t,a)&&o[1]<=n;)o[1]++,a++;if(a===s||o[1]>n)return NaN;for(;a<s&&!i.get(t,a)&&o[2]<=n;)o[2]++,a++;if(o[2]>n)return NaN;const l=o[0]+o[1]+o[2];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(o)?Gn.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,n){const r=e[0]+e[1]+e[2],i=Gn.centerFromEnd(e,n),s=this.crossCheckVertical(t,i,2*e[1],r);if(!isNaN(s)){const o=(e[0]+e[1]+e[2])/3;for(const l of this.possibleCenters)if(l.aboutEquals(o,s,i))return l.combineEstimate(s,i,o);const a=new or(i,s,o);this.possibleCenters.push(a),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(a)}return null}}class ar extends Z{constructor(e,t,n,r){super(e,t),this.estimatedModuleSize=n,this.count=r,r===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=this.count+1,i=(this.count*this.getX()+t)/r,s=(this.count*this.getY()+e)/r,o=(this.count*this.estimatedModuleSize+n)/r;return new ar(i,s,o,r)}}class Xi{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class $e{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(Ce.TRY_HARDER)!==void 0,n=e!=null&&e.get(Ce.PURE_BARCODE)!==void 0,r=this.image,i=r.getHeight(),s=r.getWidth();let o=Math.floor(3*i/(4*$e.MAX_MODULES));(o<$e.MIN_SKIP||t)&&(o=$e.MIN_SKIP);let a=!1;const l=new Int32Array(5);for(let h=o-1;h<i&&!a;h+=o){l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0;let g=0;for(let A=0;A<s;A++)if(r.get(A,h))(g&1)===1&&g++,l[g]++;else if((g&1)===0)if(g===4)if($e.foundPatternCross(l)){if(this.handlePossibleCenter(l,h,A,n)===!0)if(o=2,this.hasSkipped===!0)a=this.haveMultiplyConfirmedCenters();else{const y=this.findRowSkip();y>l[2]&&(h+=y-l[2]-o,A=s-1)}else{l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,g=3;continue}g=0,l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0}else l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,g=3;else l[++g]++;else l[g]++;$e.foundPatternCross(l)&&this.handlePossibleCenter(l,h,s,n)===!0&&(o=l[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}const c=this.selectBestPatterns();return Z.orderBestPatterns(c),new Xi(c)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let i=0;i<5;i++){const s=e[i];if(s===0)return!1;t+=s}if(t<7)return!1;const n=t/7,r=n/2;return Math.abs(n-e[0])<r&&Math.abs(n-e[1])<r&&Math.abs(3*n-e[2])<3*r&&Math.abs(n-e[3])<r&&Math.abs(n-e[4])<r}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,n,r){const i=this.getCrossCheckStateCount();let s=0;const o=this.image;for(;e>=s&&t>=s&&o.get(t-s,e-s);)i[2]++,s++;if(e<s||t<s)return!1;for(;e>=s&&t>=s&&!o.get(t-s,e-s)&&i[1]<=n;)i[1]++,s++;if(e<s||t<s||i[1]>n)return!1;for(;e>=s&&t>=s&&o.get(t-s,e-s)&&i[0]<=n;)i[0]++,s++;if(i[0]>n)return!1;const a=o.getHeight(),l=o.getWidth();for(s=1;e+s<a&&t+s<l&&o.get(t+s,e+s);)i[2]++,s++;if(e+s>=a||t+s>=l)return!1;for(;e+s<a&&t+s<l&&!o.get(t+s,e+s)&&i[3]<n;)i[3]++,s++;if(e+s>=a||t+s>=l||i[3]>=n)return!1;for(;e+s<a&&t+s<l&&o.get(t+s,e+s)&&i[4]<n;)i[4]++,s++;if(i[4]>=n)return!1;const c=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(c-r)<2*r&&$e.foundPatternCross(i)}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&i.get(t,a);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(t,a)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&i.get(t,a)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(t,a);)o[2]++,a++;if(a===s)return NaN;for(;a<s&&!i.get(t,a)&&o[3]<n;)o[3]++,a++;if(a===s||o[3]>=n)return NaN;for(;a<s&&i.get(t,a)&&o[4]<n;)o[4]++,a++;if(o[4]>=n)return NaN;const l=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(l-r)>=2*r?NaN:$e.foundPatternCross(o)?$e.centerFromEnd(o,a):NaN}crossCheckHorizontal(e,t,n,r){const i=this.image,s=i.getWidth(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&i.get(a,t);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(a,t)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&i.get(a,t)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(a,t);)o[2]++,a++;if(a===s)return NaN;for(;a<s&&!i.get(a,t)&&o[3]<n;)o[3]++,a++;if(a===s||o[3]>=n)return NaN;for(;a<s&&i.get(a,t)&&o[4]<n;)o[4]++,a++;if(o[4]>=n)return NaN;const l=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(l-r)>=r?NaN:$e.foundPatternCross(o)?$e.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,n,r){const i=e[0]+e[1]+e[2]+e[3]+e[4];let s=$e.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(s),e[2],i);if(!isNaN(o)&&(s=this.crossCheckHorizontal(Math.floor(s),Math.floor(o),e[2],i),!isNaN(s)&&(!r||this.crossCheckDiagonal(Math.floor(o),Math.floor(s),e[2],i)))){const a=i/7;let l=!1;const c=this.possibleCenters;for(let h=0,g=c.length;h<g;h++){const A=c[h];if(A.aboutEquals(a,o,s)){c[h]=A.combineEstimate(o,s,a),l=!0;break}}if(!l){const h=new ar(s,o,a);c.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const n of this.possibleCenters)if(n.getCount()>=$e.CENTER_QUORUM)if(t==null)t=n;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-n.getX())-Math.abs(t.getY()-n.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const n=this.possibleCenters.length;for(const s of this.possibleCenters)s.getCount()>=$e.CENTER_QUORUM&&(e++,t+=s.getEstimatedModuleSize());if(e<3)return!1;const r=t/n;let i=0;for(const s of this.possibleCenters)i+=Math.abs(s.getEstimatedModuleSize()-r);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new v;const t=this.possibleCenters;let n;if(e>3){let r=0,i=0;for(const a of this.possibleCenters){const l=a.getEstimatedModuleSize();r+=l,i+=l*l}n=r/e;let s=Math.sqrt(i/e-n*n);t.sort((a,l)=>{const c=Math.abs(l.getEstimatedModuleSize()-n),h=Math.abs(a.getEstimatedModuleSize()-n);return c<h?-1:c>h?1:0});const o=Math.max(.2*n,s);for(let a=0;a<t.length&&t.length>3;a++){const l=t[a];Math.abs(l.getEstimatedModuleSize()-n)>o&&(t.splice(a,1),a--)}}if(t.length>3){let r=0;for(const i of t)r+=i.getEstimatedModuleSize();n=r/t.length,t.sort((i,s)=>{if(s.getCount()===i.getCount()){const o=Math.abs(s.getEstimatedModuleSize()-n),a=Math.abs(i.getEstimatedModuleSize()-n);return o<a?1:o>a?-1:0}else return s.getCount()-i.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}$e.CENTER_QUORUM=2,$e.MIN_SKIP=3,$e.MAX_MODULES=57;class In{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(Ce.NEED_RESULT_POINT_CALLBACK);const n=new $e(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(n)}processFinderPatternInfo(e){const t=e.getTopLeft(),n=e.getTopRight(),r=e.getBottomLeft(),i=this.calculateModuleSize(t,n,r);if(i<1)throw new v("No pattern found in proccess finder.");const s=In.computeDimension(t,n,r,i),o=Q.getProvisionalVersionForDimension(s),a=o.getDimensionForVersion()-7;let l=null;if(o.getAlignmentPatternCenters().length>0){const A=n.getX()-t.getX()+r.getX(),b=n.getY()-t.getY()+r.getY(),y=1-3/a,_=Math.floor(t.getX()+y*(A-t.getX())),R=Math.floor(t.getY()+y*(b-t.getY()));for(let H=4;H<=16;H<<=1)try{l=this.findAlignmentInRegion(i,_,R,H);break}catch(W){if(!(W instanceof v))throw W}}const c=In.createTransform(t,n,r,l,s),h=In.sampleGrid(this.image,c,s);let g;return l===null?g=[r,t,n]:g=[r,t,n,l],new Pn(h,g)}static createTransform(e,t,n,r,i){const s=i-3.5;let o,a,l,c;return r!==null?(o=r.getX(),a=r.getY(),l=s-3,c=l):(o=t.getX()-e.getX()+n.getX(),a=t.getY()-e.getY()+n.getY(),l=s,c=s),Rt.quadrilateralToQuadrilateral(3.5,3.5,s,3.5,l,c,3.5,s,e.getX(),e.getY(),t.getX(),t.getY(),o,a,n.getX(),n.getY())}static sampleGrid(e,t,n){return Ht.getInstance().sampleGridWithTransform(e,n,n,t)}static computeDimension(e,t,n,r){const i=Ee.round(Z.distance(e,t)/r),s=Ee.round(Z.distance(e,n)/r);let o=Math.floor((i+s)/2)+7;switch(o&3){case 0:o++;break;case 2:o--;break;case 3:throw new v("Dimensions could be not found.")}return o}calculateModuleSize(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,t){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,n,r){let i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),s=1,o=e-(n-e);o<0?(s=e/(e-o),o=0):o>=this.image.getWidth()&&(s=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);let a=Math.floor(t-(r-t)*s);return s=1,a<0?(s=t/(t-a),a=0):a>=this.image.getHeight()&&(s=(this.image.getHeight()-1-t)/(a-t),a=this.image.getHeight()-1),o=Math.floor(e+(o-e)*s),i+=this.sizeOfBlackWhiteBlackRun(e,t,o,a),i-1}sizeOfBlackWhiteBlackRun(e,t,n,r){const i=Math.abs(r-t)>Math.abs(n-e);if(i){let A=e;e=t,t=A,A=n,n=r,r=A}const s=Math.abs(n-e),o=Math.abs(r-t);let a=-s/2;const l=e<n?1:-1,c=t<r?1:-1;let h=0;const g=n+l;for(let A=e,b=t;A!==g;A+=l){const y=i?b:A,_=i?A:b;if(h===1===this.image.get(y,_)){if(h===2)return Ee.distance(A,b,e,t);h++}if(a+=o,a>0){if(b===r)break;b+=c,a-=s}}return h===2?Ee.distance(n+l,r,e,t):NaN}findAlignmentInRegion(e,t,n,r){const i=Math.floor(r*e),s=Math.max(0,t-i),o=Math.min(this.image.getWidth()-1,t+i);if(o-s<e*3)throw new v("Alignment top exceeds estimated module size.");const a=Math.max(0,n-i),l=Math.min(this.image.getHeight()-1,n+i);if(l-a<e*3)throw new v("Alignment bottom exceeds estimated module size.");return new Gn(this.image,s,a,o-s,l-a,e,this.resultPointCallback).find()}}class Yt{constructor(){this.decoder=new Wi}getDecoder(){return this.decoder}decode(e,t){let n,r;if(t!=null&&t.get(Ce.PURE_BARCODE)!==void 0){const a=Yt.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(a,t),r=Yt.NO_POINTS}else{const a=new In(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(a.getBits(),t),r=a.getPoints()}n.getOther()instanceof Ur&&n.getOther().applyMirroredCorrection(r);const i=new D(n.getText(),n.getRawBytes(),void 0,r,B.QR_CODE,void 0),s=n.getByteSegments();s!==null&&i.putMetadata(de.BYTE_SEGMENTS,s);const o=n.getECLevel();return o!==null&&i.putMetadata(de.ERROR_CORRECTION_LEVEL,o),n.hasStructuredAppend()&&(i.putMetadata(de.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),i.putMetadata(de.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new v;const r=this.moduleSize(t,e);let i=t[1],s=n[1],o=t[0],a=n[0];if(o>=a||i>=s)throw new v;if(s-i!==a-o&&(a=o+(s-i),a>=e.getWidth()))throw new v;const l=Math.round((a-o+1)/r),c=Math.round((s-i+1)/r);if(l<=0||c<=0)throw new v;if(c!==l)throw new v;const h=Math.floor(r/2);i+=h,o+=h;const g=o+Math.floor((l-1)*r)-a;if(g>0){if(g>h)throw new v;o-=g}const A=i+Math.floor((c-1)*r)-s;if(A>0){if(A>h)throw new v;i-=A}const b=new ye(l,c);for(let y=0;y<c;y++){const _=i+Math.floor(y*r);for(let R=0;R<l;R++)e.get(o+Math.floor(R*r),_)&&b.set(R,y)}return b}static moduleSize(e,t){const n=t.getHeight(),r=t.getWidth();let i=e[0],s=e[1],o=!0,a=0;for(;i<r&&s<n;){if(o!==t.get(i,s)){if(++a===5)break;o=!o}i++,s++}if(i===r||s===n)throw new v;return(i-e[0])/7}}Yt.NO_POINTS=new Array;class se{PDF417Common(){}static getBitCountSum(e){return Ee.sum(e)}static toIntArray(e){if(e==null||!e.length)return se.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let n=0;for(const r of e)t[n++]=r;return t}static getCodeword(e){const t=fe.binarySearch(se.SYMBOL_TABLE,e&262143);return t<0?-1:(se.CODEWORD_TABLE[t]-1)%se.NUMBER_OF_CODEWORDS}}se.NUMBER_OF_CODEWORDS=929,se.MAX_CODEWORDS_IN_BARCODE=se.NUMBER_OF_CODEWORDS-1,se.MIN_ROWS_IN_BARCODE=3,se.MAX_ROWS_IN_BARCODE=90,se.MODULES_IN_CODEWORD=17,se.MODULES_IN_STOP_PATTERN=18,se.BARS_IN_MODULE=8,se.EMPTY_INT_ARRAY=new Int32Array([]),se.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),se.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class zi{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class ue{static detectMultiple(e,t,n){let r=e.getBlackMatrix(),i=ue.detect(n,r);return i.length||(r=r.clone(),r.rotate180(),i=ue.detect(n,r)),new zi(r,i)}static detect(e,t){const n=new Array;let r=0,i=0,s=!1;for(;r<t.getHeight();){const o=ue.findVertices(t,r,i);if(o[0]==null&&o[3]==null){if(!s)break;s=!1,i=0;for(const a of n)a[1]!=null&&(r=Math.trunc(Math.max(r,a[1].getY()))),a[3]!=null&&(r=Math.max(r,Math.trunc(a[3].getY())));r+=ue.ROW_STEP;continue}if(s=!0,n.push(o),!e)break;o[2]!=null?(i=Math.trunc(o[2].getX()),r=Math.trunc(o[2].getY())):(i=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY()))}return n}static findVertices(e,t,n){const r=e.getHeight(),i=e.getWidth(),s=new Array(8);return ue.copyToResult(s,ue.findRowsWithPattern(e,r,i,t,n,ue.START_PATTERN),ue.INDEXES_START_PATTERN),s[4]!=null&&(n=Math.trunc(s[4].getX()),t=Math.trunc(s[4].getY())),ue.copyToResult(s,ue.findRowsWithPattern(e,r,i,t,n,ue.STOP_PATTERN),ue.INDEXES_STOP_PATTERN),s}static copyToResult(e,t,n){for(let r=0;r<n.length;r++)e[n[r]]=t[r]}static findRowsWithPattern(e,t,n,r,i,s){const o=new Array(4);let a=!1;const l=new Int32Array(s.length);for(;r<t;r+=ue.ROW_STEP){let h=ue.findGuardPattern(e,i,r,n,!1,s,l);if(h!=null){for(;r>0;){const g=ue.findGuardPattern(e,i,--r,n,!1,s,l);if(g!=null)h=g;else{r++;break}}o[0]=new Z(h[0],r),o[1]=new Z(h[1],r),a=!0;break}}let c=r+1;if(a){let h=0,g=Int32Array.from([Math.trunc(o[0].getX()),Math.trunc(o[1].getX())]);for(;c<t;c++){const A=ue.findGuardPattern(e,g[0],c,n,!1,s,l);if(A!=null&&Math.abs(g[0]-A[0])<ue.MAX_PATTERN_DRIFT&&Math.abs(g[1]-A[1])<ue.MAX_PATTERN_DRIFT)g=A,h=0;else{if(h>ue.SKIPPED_ROW_COUNT_MAX)break;h++}}c-=h+1,o[2]=new Z(g[0],c),o[3]=new Z(g[1],c)}return c-r<ue.BARCODE_MIN_HEIGHT&&fe.fill(o,null),o}static findGuardPattern(e,t,n,r,i,s,o){fe.fillWithin(o,0,o.length,0);let a=t,l=0;for(;e.get(a,n)&&a>0&&l++<ue.MAX_PIXEL_DRIFT;)a--;let c=a,h=0,g=s.length;for(let A=i;c<r;c++)if(e.get(c,n)!==A)o[h]++;else{if(h===g-1){if(ue.patternMatchVariance(o,s,ue.MAX_INDIVIDUAL_VARIANCE)<ue.MAX_AVG_VARIANCE)return new Int32Array([a,c]);a+=o[0]+o[1],J.arraycopy(o,2,o,0,h-1),o[h-1]=0,o[h]=0,h--}else h++;o[h]=1,A=!A}return h===g-1&&ue.patternMatchVariance(o,s,ue.MAX_INDIVIDUAL_VARIANCE)<ue.MAX_AVG_VARIANCE?new Int32Array([a,c-1]):null}static patternMatchVariance(e,t,n){let r=e.length,i=0,s=0;for(let l=0;l<r;l++)i+=e[l],s+=t[l];if(i<s)return 1/0;let o=i/s;n*=o;let a=0;for(let l=0;l<r;l++){let c=e[l],h=t[l]*o,g=c>h?c-h:h-c;if(g>n)return 1/0;a+=g}return a/i}}ue.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),ue.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),ue.MAX_AVG_VARIANCE=.42,ue.MAX_INDIVIDUAL_VARIANCE=.8,ue.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),ue.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),ue.MAX_PIXEL_DRIFT=3,ue.MAX_PATTERN_DRIFT=5,ue.SKIPPED_ROW_COUNT_MAX=25,ue.ROW_STEP=5,ue.BARCODE_MIN_HEIGHT=10;class nt{constructor(e,t){if(t.length===0)throw new M;this.field=e;let n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-r),J.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let r=0;for(let i of this.coefficients)r=this.field.add(r,i);return r}let t=this.coefficients[0],n=this.coefficients.length;for(let r=1;r<n;r++)t=this.field.add(this.field.multiply(e,t),this.coefficients[r]);return t}add(e){if(!this.field.equals(e.field))throw new M("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){let s=t;t=n,n=s}let r=new Int32Array(n.length),i=n.length-t.length;J.arraycopy(n,0,r,0,i);for(let s=i;s<n.length;s++)r[s]=this.field.add(t[s-i],n[s]);return new nt(this.field,r)}subtract(e){if(!this.field.equals(e.field))throw new M("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof nt?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new M("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new nt(this.field,new Int32Array([0]));let t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,s=new Int32Array(n+i-1);for(let o=0;o<n;o++){let a=t[o];for(let l=0;l<i;l++)s[o+l]=this.field.add(s[o+l],this.field.multiply(a,r[l]))}return new nt(this.field,s)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new nt(this.field,t)}multiplyScalar(e){if(e===0)return new nt(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new nt(this.field,n)}multiplyByMonomial(e,t){if(e<0)throw new M;if(t===0)return new nt(this.field,new Int32Array([0]));let n=this.coefficients.length,r=new Int32Array(n+e);for(let i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new nt(this.field,r)}toString(){let e=new re;for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class Yi{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new M;return this.logTable[e]}inverse(e){if(e===0)throw new Bn;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class lr extends Yi{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let r=0;r<e;r++)this.expTable[r]=n,n=n*t%e;for(let r=0;r<e-1;r++)this.logTable[this.expTable[r]]=r;this.zero=new nt(this,new Int32Array([0])),this.one=new nt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new M;if(t===0)return this.zero;let n=new Int32Array(e+1);return n[0]=t,new nt(this,n)}}lr.PDF417_GF=new lr(se.NUMBER_OF_CODEWORDS,3);class Vr{constructor(){this.field=lr.PDF417_GF}decode(e,t,n){let r=new nt(this.field,e),i=new Int32Array(t),s=!1;for(let b=t;b>0;b--){let y=r.evaluateAt(this.field.exp(b));i[t-b]=y,y!==0&&(s=!0)}if(!s)return 0;let o=this.field.getOne();if(n!=null)for(const b of n){let y=this.field.exp(e.length-1-b),_=new nt(this.field,new Int32Array([this.field.subtract(0,y),1]));o=o.multiply(_)}let a=new nt(this.field,i),l=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),a,t),c=l[0],h=l[1],g=this.findErrorLocations(c),A=this.findErrorMagnitudes(h,c,g);for(let b=0;b<g.length;b++){let y=e.length-1-this.field.log(g[b]);if(y<0)throw te.getChecksumInstance();e[y]=this.field.subtract(e[y],A[b])}return g.length}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){let g=e;e=t,t=g}let r=e,i=t,s=this.field.getZero(),o=this.field.getOne();for(;i.getDegree()>=Math.round(n/2);){let g=r,A=s;if(r=i,s=o,r.isZero())throw te.getChecksumInstance();i=g;let b=this.field.getZero(),y=r.getCoefficient(r.getDegree()),_=this.field.inverse(y);for(;i.getDegree()>=r.getDegree()&&!i.isZero();){let R=i.getDegree()-r.getDegree(),H=this.field.multiply(i.getCoefficient(i.getDegree()),_);b=b.add(this.field.buildMonomial(R,H)),i=i.subtract(r.multiplyByMonomial(R,H))}o=b.multiply(s).subtract(A).negative()}let a=o.getCoefficient(0);if(a===0)throw te.getChecksumInstance();let l=this.field.inverse(a),c=o.multiply(l),h=i.multiply(l);return[c,h]}findErrorLocations(e){let t=e.getDegree(),n=new Int32Array(t),r=0;for(let i=1;i<this.field.getSize()&&r<t;i++)e.evaluateAt(i)===0&&(n[r]=this.field.inverse(i),r++);if(r!==t)throw te.getChecksumInstance();return n}findErrorMagnitudes(e,t,n){let r=t.getDegree(),i=new Int32Array(r);for(let l=1;l<=r;l++)i[r-l]=this.field.multiply(l,t.getCoefficient(l));let s=new nt(this.field,i),o=n.length,a=new Int32Array(o);for(let l=0;l<o;l++){let c=this.field.inverse(n[l]),h=this.field.subtract(0,e.evaluateAt(c)),g=this.field.inverse(s.evaluateAt(c));a[l]=this.field.multiply(h,g)}return a}}class tn{constructor(e,t,n,r,i){e instanceof tn?this.constructor_2(e):this.constructor_1(e,t,n,r,i)}constructor_1(e,t,n,r,i){const s=t==null||n==null,o=r==null||i==null;if(s&&o)throw new v;s?(t=new Z(0,r.getY()),n=new Z(0,i.getY())):o&&(r=new Z(e.getWidth()-1,t.getY()),i=new Z(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=r,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(r.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),r.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new tn(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,n){let r=this.topLeft,i=this.bottomLeft,s=this.topRight,o=this.bottomRight;if(e>0){let a=n?this.topLeft:this.topRight,l=Math.trunc(a.getY()-e);l<0&&(l=0);let c=new Z(a.getX(),l);n?r=c:s=c}if(t>0){let a=n?this.bottomLeft:this.bottomRight,l=Math.trunc(a.getY()+t);l>=this.image.getHeight()&&(l=this.image.getHeight()-1);let c=new Z(a.getX(),l);n?i=c:o=c}return new tn(this.image,r,i,s,o)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class ji{constructor(e,t,n,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class _n{constructor(){this.buffer=""}static form(e,t){let n=-1;function r(s,o,a,l,c,h){if(s==="%%")return"%";if(t[++n]===void 0)return;s=l?parseInt(l.substr(1)):void 0;let g=c?parseInt(c.substr(1)):void 0,A;switch(h){case"s":A=t[n];break;case"c":A=t[n][0];break;case"f":A=parseFloat(t[n]).toFixed(s);break;case"p":A=parseFloat(t[n]).toPrecision(s);break;case"e":A=parseFloat(t[n]).toExponential(s);break;case"x":A=parseInt(t[n]).toString(g||16);break;case"d":A=parseFloat(parseInt(t[n],g||10).toPrecision(s)).toFixed(0);break}A=typeof A=="object"?JSON.stringify(A):(+A).toString(g);let b=parseInt(a),y=a&&a[0]+""=="0"?"0":" ";for(;A.length<b;)A=o!==void 0?A+y:y+A;return A}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}format(e,...t){this.buffer+=_n.form(e,t)}toString(){return this.buffer}}class Sn{constructor(e){this.boundingBox=new tn(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let n=1;n<Sn.MAX_NEARBY_DISTANCE;n++){let r=this.imageRowToCodewordIndex(e)-n;if(r>=0&&(t=this.codewords[r],t!=null)||(r=this.imageRowToCodewordIndex(e)+n,r<this.codewords.length&&(t=this.codewords[r],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new _n;let t=0;for(const n of this.codewords){if(n==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,n.getRowNumber(),n.getValue())}return e.toString()}}Sn.MAX_NEARBY_DISTANCE=5;class Tn{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[n,r]of this.values.entries()){const i={getKey:()=>n,getValue:()=>r};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return se.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class Gr extends Sn{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=-1,l=1,c=0;for(let h=s;h<o;h++){if(t[h]==null)continue;let g=t[h],A=g.getRowNumber()-a;if(A===0)c++;else if(A===1)l=Math.max(l,c),c=1,a=g.getRowNumber();else if(A<0||g.getRowNumber()>=e.getRowCount()||A>h)t[h]=null;else{let b;l>2?b=(l-2)*A:b=A;let y=b>=h;for(let _=1;_<=b&&!y;_++)y=t[h-_]!=null;y?t[h]=null:(a=g.getRowNumber(),c=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let n of this.getCodewords())if(n!=null){let r=n.getRowNumber();if(r>=t.length)continue;t[r]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.getCodewords(),a=-1;for(let l=i;l<s;l++){if(o[l]==null)continue;let c=o[l];c.setRowNumberAsRowIndicatorColumn();let h=c.getRowNumber()-a;h===0||(h===1?a=c.getRowNumber():c.getRowNumber()>=e.getRowCount()?o[l]=null:a=c.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new Tn,n=new Tn,r=new Tn,i=new Tn;for(let o of e){if(o==null)continue;o.setRowNumberAsRowIndicatorColumn();let a=o.getValue()%30,l=o.getRowNumber();switch(this._isLeft||(l+=2),l%3){case 0:n.setValue(a*3+1);break;case 1:i.setValue(a/3),r.setValue(a%3);break;case 2:t.setValue(a+1);break}}if(t.getValue().length===0||n.getValue().length===0||r.getValue().length===0||i.getValue().length===0||t.getValue()[0]<1||n.getValue()[0]+r.getValue()[0]<se.MIN_ROWS_IN_BARCODE||n.getValue()[0]+r.getValue()[0]>se.MAX_ROWS_IN_BARCODE)return null;let s=new ji(t.getValue()[0],n.getValue()[0],r.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(e,s),s}removeIncorrectCodewords(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(e[n]==null)continue;let i=r.getValue()%30,s=r.getRowNumber();if(s>t.getRowCount()){e[n]=null;continue}switch(this._isLeft||(s+=2),s%3){case 0:i*3+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:(Math.trunc(i/3)!==t.getErrorCorrectionLevel()||i%3!==t.getRowCountLowerPart())&&(e[n]=null);break;case 2:i+1!==t.getColumnCount()&&(e[n]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Nn{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=se.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let n=this.detectionResultColumns[t].getCodewords();for(let r=0;r<n.length;r++)n[r]!=null&&(n[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,n))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(let r=1;r<=this.barcodeColumnCount;r++){let i=this.detectionResultColumns[r].getCodewords()[n];i!=null&&(i.setRowNumber(e[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let s=this.barcodeColumnCount+1;s>0&&i<this.ADJUST_ROW_NUMBER_SKIP;s--){let o=this.detectionResultColumns[s].getCodewords()[n];o!=null&&(i=Nn.adjustRowNumberIfValid(r,i,o),o.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let s=1;s<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;s++){let o=this.detectionResultColumns[s].getCodewords()[n];o!=null&&(i=Nn.adjustRowNumberIfValid(r,i,o),o.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,n){if(!this.detectionResultColumns[e-1])return;let r=n[t],i=this.detectionResultColumns[e-1].getCodewords(),s=i;this.detectionResultColumns[e+1]!=null&&(s=this.detectionResultColumns[e+1].getCodewords());let o=new Array(14);o[2]=i[t],o[3]=s[t],t>0&&(o[0]=n[t-1],o[4]=i[t-1],o[5]=s[t-1]),t>1&&(o[8]=n[t-2],o[10]=i[t-2],o[11]=s[t-2]),t<n.length-1&&(o[1]=n[t+1],o[6]=i[t+1],o[7]=s[t+1]),t<n.length-2&&(o[9]=n[t+2],o[12]=i[t+2],o[13]=s[t+2]);for(let a of o)if(Nn.adjustRowNumber(r,a))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new _n;for(let n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(let r=0;r<this.barcodeColumnCount+2;r++){if(this.detectionResultColumns[r]==null){t.format("    |   ");continue}let i=this.detectionResultColumns[r].getCodewords()[n];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()}}class On{constructor(e,t,n,r){this.rowNumber=On.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(r)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==On.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}On.BARCODE_ROW_UNKNOWN=-1;class At{static initialize(){for(let e=0;e<se.SYMBOL_TABLE.length;e++){let t=se.SYMBOL_TABLE[e],n=t&1;for(let r=0;r<se.BARS_IN_MODULE;r++){let i=0;for(;(t&1)===n;)i+=1,t>>=1;n=t&1,At.RATIOS_TABLE[e]||(At.RATIOS_TABLE[e]=new Array(se.BARS_IN_MODULE)),At.RATIOS_TABLE[e][se.BARS_IN_MODULE-r-1]=Math.fround(i/se.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=At.getDecodedCodewordValue(At.sampleBitCounts(e));return t!==-1?t:At.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=Ee.sum(e),n=new Int32Array(se.BARS_IN_MODULE),r=0,i=0;for(let s=0;s<se.MODULES_IN_CODEWORD;s++){let o=t/(2*se.MODULES_IN_CODEWORD)+s*t/se.MODULES_IN_CODEWORD;i+e[r]<=o&&(i+=e[r],r++),n[r]++}return n}static getDecodedCodewordValue(e){let t=At.getBitValue(e);return se.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let n=0;n<e.length;n++)for(let r=0;r<e[n];r++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=Ee.sum(e),n=new Array(se.BARS_IN_MODULE);if(t>1)for(let s=0;s<n.length;s++)n[s]=Math.fround(e[s]/t);let r=kn.MAX_VALUE,i=-1;this.bSymbolTableReady||At.initialize();for(let s=0;s<At.RATIOS_TABLE.length;s++){let o=0,a=At.RATIOS_TABLE[s];for(let l=0;l<se.BARS_IN_MODULE;l++){let c=Math.fround(a[l]-n[l]);if(o+=Math.fround(c*c),o>=r)break}o<r&&(r=o,i=se.SYMBOL_TABLE[s])}return i}}At.bSymbolTableReady=!1,At.RATIOS_TABLE=new Array(se.SYMBOL_TABLE.length).map(f=>new Array(se.BARS_IN_MODULE));class Hr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Wr{static parseLong(e,t=void 0){return parseInt(e,t)}}class Xr extends C{}Xr.kind="NullPointerException";class Zi{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,n){if(e==null)throw new Xr;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new q;if(n===0)return;for(let r=0;r<n;r++)this.write(e[t+r])}flush(){}close(){}}class qi extends C{}class Ki extends Zi{constructor(e=32){if(super(),this.count=0,e<0)throw new M("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let n=this.buf.length<<1;if(n-e<0&&(n=e),n<0){if(e<0)throw new qi;n=K.MAX_VALUE}this.buf=fe.copyOfUint8Array(this.buf,n)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new q;this.ensureCapacity(this.count+n),J.arraycopy(e,t,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return fe.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var Oe;(function(f){f[f.ALPHA=0]="ALPHA",f[f.LOWER=1]="LOWER",f[f.MIXED=2]="MIXED",f[f.PUNCT=3]="PUNCT",f[f.ALPHA_SHIFT=4]="ALPHA_SHIFT",f[f.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Oe||(Oe={}));function zr(){if(typeof window<"u")return window.BigInt||null;if(typeof Qt<"u")return Qt.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Hn;function jt(f){if(typeof Hn>"u"&&(Hn=zr()),Hn===null)throw new Error("BigInt is not supported!");return Hn(f)}function Qi(){let f=[];f[0]=jt(1);let e=jt(900);f[1]=e;for(let t=2;t<16;t++)f[t]=f[t-1]*e;return f}class O{static decode(e,t){let n=new re(""),r=G.ISO8859_1;n.enableDecoding(r);let i=1,s=e[i++],o=new Hr;for(;i<e[0];){switch(s){case O.TEXT_COMPACTION_MODE_LATCH:i=O.textCompaction(e,i,n);break;case O.BYTE_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH_6:i=O.byteCompaction(s,e,r,i,n);break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[i++]);break;case O.NUMERIC_COMPACTION_MODE_LATCH:i=O.numericCompaction(e,i,n);break;case O.ECI_CHARSET:G.getCharacterSetECIByValue(e[i++]);break;case O.ECI_GENERAL_PURPOSE:i+=2;break;case O.ECI_USER_DEFINED:i++;break;case O.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=O.decodeMacroBlock(e,i,o);break;case O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case O.MACRO_PDF417_TERMINATOR:throw new U;default:i--,i=O.textCompaction(e,i,n);break}if(i<e.length)s=e[i++];else throw U.getFormatInstance()}if(n.length()===0)throw U.getFormatInstance();let a=new gt(null,n.toString(),null,t);return a.setOther(o),a}static decodeMacroBlock(e,t,n){if(t+O.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw U.getFormatInstance();let r=new Int32Array(O.NUMBER_OF_SEQUENCE_CODEWORDS);for(let o=0;o<O.NUMBER_OF_SEQUENCE_CODEWORDS;o++,t++)r[o]=e[t];n.setSegmentIndex(K.parseInt(O.decodeBase900toBase10(r,O.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new re;t=O.textCompaction(e,t,i),n.setFileId(i.toString());let s=-1;for(e[t]===O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=t+1);t<e[0];)switch(e[t]){case O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case O.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let o=new re;t=O.textCompaction(e,t+1,o),n.setFileName(o.toString());break;case O.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let a=new re;t=O.textCompaction(e,t+1,a),n.setSender(a.toString());break;case O.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let l=new re;t=O.textCompaction(e,t+1,l),n.setAddressee(l.toString());break;case O.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let c=new re;t=O.numericCompaction(e,t+1,c),n.setSegmentCount(K.parseInt(c.toString()));break;case O.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let h=new re;t=O.numericCompaction(e,t+1,h),n.setTimestamp(Wr.parseLong(h.toString()));break;case O.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let g=new re;t=O.numericCompaction(e,t+1,g),n.setChecksum(K.parseInt(g.toString()));break;case O.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let A=new re;t=O.numericCompaction(e,t+1,A),n.setFileSize(Wr.parseLong(A.toString()));break;default:throw U.getFormatInstance()}break;case O.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw U.getFormatInstance()}if(s!==-1){let o=t-s;n.isLastSegment()&&o--,n.setOptionalData(fe.copyOfRange(e,s,s+o))}return t}static textCompaction(e,t,n){let r=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),s=0,o=!1;for(;t<e[0]&&!o;){let a=e[t++];if(a<O.TEXT_COMPACTION_MODE_LATCH)r[s]=a/30,r[s+1]=a%30,s+=2;else switch(a){case O.TEXT_COMPACTION_MODE_LATCH:r[s++]=O.TEXT_COMPACTION_MODE_LATCH;break;case O.BYTE_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH_6:case O.NUMERIC_COMPACTION_MODE_LATCH:case O.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case O.MACRO_PDF417_TERMINATOR:t--,o=!0;break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[s]=O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,a=e[t++],i[s]=a,s++;break}}return O.decodeTextCompaction(r,i,s,n),t}static decodeTextCompaction(e,t,n,r){let i=Oe.ALPHA,s=Oe.ALPHA,o=0;for(;o<n;){let a=e[o],l="";switch(i){case Oe.ALPHA:if(a<26)l=String.fromCharCode(65+a);else switch(a){case 26:l=" ";break;case O.LL:i=Oe.LOWER;break;case O.ML:i=Oe.MIXED;break;case O.PS:s=i,i=Oe.PUNCT_SHIFT;break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case O.TEXT_COMPACTION_MODE_LATCH:i=Oe.ALPHA;break}break;case Oe.LOWER:if(a<26)l=String.fromCharCode(97+a);else switch(a){case 26:l=" ";break;case O.AS:s=i,i=Oe.ALPHA_SHIFT;break;case O.ML:i=Oe.MIXED;break;case O.PS:s=i,i=Oe.PUNCT_SHIFT;break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case O.TEXT_COMPACTION_MODE_LATCH:i=Oe.ALPHA;break}break;case Oe.MIXED:if(a<O.PL)l=O.MIXED_CHARS[a];else switch(a){case O.PL:i=Oe.PUNCT;break;case 26:l=" ";break;case O.LL:i=Oe.LOWER;break;case O.AL:i=Oe.ALPHA;break;case O.PS:s=i,i=Oe.PUNCT_SHIFT;break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case O.TEXT_COMPACTION_MODE_LATCH:i=Oe.ALPHA;break}break;case Oe.PUNCT:if(a<O.PAL)l=O.PUNCT_CHARS[a];else switch(a){case O.PAL:i=Oe.ALPHA;break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case O.TEXT_COMPACTION_MODE_LATCH:i=Oe.ALPHA;break}break;case Oe.ALPHA_SHIFT:if(i=s,a<26)l=String.fromCharCode(65+a);else switch(a){case 26:l=" ";break;case O.TEXT_COMPACTION_MODE_LATCH:i=Oe.ALPHA;break}break;case Oe.PUNCT_SHIFT:if(i=s,a<O.PAL)l=O.PUNCT_CHARS[a];else switch(a){case O.PAL:i=Oe.ALPHA;break;case O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o]);break;case O.TEXT_COMPACTION_MODE_LATCH:i=Oe.ALPHA;break}break}l!==""&&r.append(l),o++}}static byteCompaction(e,t,n,r,i){let s=new Ki,o=0,a=0,l=!1;switch(e){case O.BYTE_COMPACTION_MODE_LATCH:let c=new Int32Array(6),h=t[r++];for(;r<t[0]&&!l;)switch(c[o++]=h,a=900*a+h,h=t[r++],h){case O.TEXT_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH:case O.NUMERIC_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH_6:case O.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case O.MACRO_PDF417_TERMINATOR:r--,l=!0;break;default:if(o%5===0&&o>0){for(let g=0;g<6;++g)s.write(Number(jt(a)>>jt(8*(5-g))));a=0,o=0}break}r===t[0]&&h<O.TEXT_COMPACTION_MODE_LATCH&&(c[o++]=h);for(let g=0;g<o;g++)s.write(c[g]);break;case O.BYTE_COMPACTION_MODE_LATCH_6:for(;r<t[0]&&!l;){let g=t[r++];if(g<O.TEXT_COMPACTION_MODE_LATCH)o++,a=900*a+g;else switch(g){case O.TEXT_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH:case O.NUMERIC_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH_6:case O.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case O.MACRO_PDF417_TERMINATOR:r--,l=!0;break}if(o%5===0&&o>0){for(let A=0;A<6;++A)s.write(Number(jt(a)>>jt(8*(5-A))));a=0,o=0}}break}return i.append(ze.decode(s.toByteArray(),n)),r}static numericCompaction(e,t,n){let r=0,i=!1,s=new Int32Array(O.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let o=e[t++];if(t===e[0]&&(i=!0),o<O.TEXT_COMPACTION_MODE_LATCH)s[r]=o,r++;else switch(o){case O.TEXT_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH:case O.BYTE_COMPACTION_MODE_LATCH_6:case O.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case O.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(r%O.MAX_NUMERIC_CODEWORDS===0||o===O.NUMERIC_COMPACTION_MODE_LATCH||i)&&r>0&&(n.append(O.decodeBase900toBase10(s,r)),r=0)}return t}static decodeBase900toBase10(e,t){let n=jt(0);for(let i=0;i<t;i++)n+=O.EXP900[t-i-1]*jt(e[i]);let r=n.toString();if(r.charAt(0)!=="1")throw new U;return r.substring(1)}}O.TEXT_COMPACTION_MODE_LATCH=900,O.BYTE_COMPACTION_MODE_LATCH=901,O.NUMERIC_COMPACTION_MODE_LATCH=902,O.BYTE_COMPACTION_MODE_LATCH_6=924,O.ECI_USER_DEFINED=925,O.ECI_GENERAL_PURPOSE=926,O.ECI_CHARSET=927,O.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,O.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,O.MACRO_PDF417_TERMINATOR=922,O.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,O.MAX_NUMERIC_CODEWORDS=15,O.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,O.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,O.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,O.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,O.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,O.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,O.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,O.PL=25,O.LL=27,O.AS=27,O.ML=28,O.AL=28,O.PS=29,O.PAL=29,O.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,O.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",O.EXP900=zr()?Qi():[],O.NUMBER_OF_SEQUENCE_CODEWORDS=2;class ge{constructor(){}static decode(e,t,n,r,i,s,o){let a=new tn(e,t,n,r,i),l=null,c=null,h;for(let b=!0;;b=!1){if(t!=null&&(l=ge.getRowIndicatorColumn(e,a,t,!0,s,o)),r!=null&&(c=ge.getRowIndicatorColumn(e,a,r,!1,s,o)),h=ge.merge(l,c),h==null)throw v.getNotFoundInstance();let y=h.getBoundingBox();if(b&&y!=null&&(y.getMinY()<a.getMinY()||y.getMaxY()>a.getMaxY()))a=y;else break}h.setBoundingBox(a);let g=h.getBarcodeColumnCount()+1;h.setDetectionResultColumn(0,l),h.setDetectionResultColumn(g,c);let A=l!=null;for(let b=1;b<=g;b++){let y=A?b:g-b;if(h.getDetectionResultColumn(y)!==void 0)continue;let _;y===0||y===g?_=new Gr(a,y===0):_=new Sn(a),h.setDetectionResultColumn(y,_);let R=-1,H=R;for(let W=a.getMinY();W<=a.getMaxY();W++){if(R=ge.getStartColumn(h,y,W,A),R<0||R>a.getMaxX()){if(H===-1)continue;R=H}let V=ge.detectCodeword(e,a.getMinX(),a.getMaxX(),A,R,W,s,o);V!=null&&(_.setCodeword(W,V),H=R,s=Math.min(s,V.getWidth()),o=Math.max(o,V.getWidth()))}}return ge.createDecoderResult(h)}static merge(e,t){if(e==null&&t==null)return null;let n=ge.getBarcodeMetadata(e,t);if(n==null)return null;let r=tn.merge(ge.adjustBoundingBox(e),ge.adjustBoundingBox(t));return new Nn(n,r)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let n=ge.getMax(t),r=0;for(let o of t)if(r+=n-o,o>0)break;let i=e.getCodewords();for(let o=0;r>0&&i[o]==null;o++)r--;let s=0;for(let o=t.length-1;o>=0&&(s+=n-t[o],!(t[o]>0));o--);for(let o=i.length-1;s>0&&i[o]==null;o--)s--;return e.getBoundingBox().addMissingRows(r,s,e.isLeft())}static getMax(e){let t=-1;for(let n of e)t=Math.max(t,n);return t}static getBarcodeMetadata(e,t){let n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let r;return t==null||(r=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==r.getColumnCount()&&n.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&n.getRowCount()!==r.getRowCount()?null:n}static getRowIndicatorColumn(e,t,n,r,i,s){let o=new Gr(t,r);for(let a=0;a<2;a++){let l=a===0?1:-1,c=Math.trunc(Math.trunc(n.getX()));for(let h=Math.trunc(Math.trunc(n.getY()));h<=t.getMaxY()&&h>=t.getMinY();h+=l){let g=ge.detectCodeword(e,0,e.getWidth(),r,c,h,i,s);g!=null&&(o.setCodeword(h,g),r?c=g.getStartX():c=g.getEndX())}}return o}static adjustCodewordCount(e,t){let n=t[0][1],r=n.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-ge.getNumberOfECCodeWords(e.getBarcodeECLevel());if(r.length===0){if(i<1||i>se.MAX_CODEWORDS_IN_BARCODE)throw v.getNotFoundInstance();n.setValue(i)}else r[0]!==i&&n.setValue(i)}static createDecoderResult(e){let t=ge.createBarcodeMatrix(e);ge.adjustCodewordCount(e,t);let n=new Array,r=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],s=new Array;for(let a=0;a<e.getBarcodeRowCount();a++)for(let l=0;l<e.getBarcodeColumnCount();l++){let c=t[a][l+1].getValue(),h=a*e.getBarcodeColumnCount()+l;c.length===0?n.push(h):c.length===1?r[h]=c[0]:(s.push(h),i.push(c))}let o=new Array(i.length);for(let a=0;a<o.length;a++)o[a]=i[a];return ge.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),r,se.toIntArray(n),se.toIntArray(s),o)}static createDecoderResultFromAmbiguousValues(e,t,n,r,i){let s=new Int32Array(r.length),o=100;for(;o-- >0;){for(let a=0;a<s.length;a++)t[r[a]]=i[a][s[a]];try{return ge.decodeCodewords(t,e,n)}catch(a){if(!(a instanceof te))throw a}if(s.length===0)throw te.getChecksumInstance();for(let a=0;a<s.length;a++)if(s[a]<i[a].length-1){s[a]++;break}else if(s[a]=0,a===s.length-1)throw te.getChecksumInstance()}throw te.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++)t[r][i]=new Tn;let n=0;for(let r of e.getDetectionResultColumns()){if(r!=null){for(let i of r.getCodewords())if(i!=null){let s=i.getRowNumber();if(s>=0){if(s>=t.length)continue;t[s][n].setValue(i.getValue())}}}n++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,n,r){let i=r?1:-1,s=null;if(ge.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodeword(n)),s!=null)return r?s.getEndX():s.getStartX();if(s=e.getDetectionResultColumn(t).getCodewordNearby(n),s!=null)return r?s.getStartX():s.getEndX();if(ge.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodewordNearby(n)),s!=null)return r?s.getEndX():s.getStartX();let o=0;for(;ge.isValidBarcodeColumn(e,t-i);){t-=i;for(let a of e.getDetectionResultColumn(t).getCodewords())if(a!=null)return(r?a.getEndX():a.getStartX())+i*o*(a.getEndX()-a.getStartX());o++}return r?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,n,r,i,s,o,a){i=ge.adjustCodewordStartColumn(e,t,n,r,i,s);let l=ge.getModuleBitCount(e,t,n,r,i,s);if(l==null)return null;let c,h=Ee.sum(l);if(r)c=i+h;else{for(let b=0;b<l.length/2;b++){let y=l[b];l[b]=l[l.length-1-b],l[l.length-1-b]=y}c=i,i=c-h}if(!ge.checkCodewordSkew(h,o,a))return null;let g=At.getDecodedValue(l),A=se.getCodeword(g);return A===-1?null:new On(i,c,ge.getCodewordBucketNumber(g),A)}static getModuleBitCount(e,t,n,r,i,s){let o=i,a=new Int32Array(8),l=0,c=r?1:-1,h=r;for(;(r?o<n:o>=t)&&l<a.length;)e.get(o,s)===h?(a[l]++,o+=c):(l++,h=!h);return l===a.length||o===(r?n:t)&&l===a.length-1?a:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,n,r,i,s){let o=i,a=r?-1:1;for(let l=0;l<2;l++){for(;(r?o>=t:o<n)&&r===e.get(o,s);){if(Math.abs(i-o)>ge.CODEWORD_SKEW_SIZE)return i;o+=a}a=-a,r=!r}return o}static checkCodewordSkew(e,t,n){return t-ge.CODEWORD_SKEW_SIZE<=e&&e<=n+ge.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,n){if(e.length===0)throw U.getFormatInstance();let r=1<<t+1,i=ge.correctErrors(e,n,r);ge.verifyCodewordCount(e,r);let s=O.decode(e,""+t);return s.setErrorsCorrected(i),s.setErasures(n.length),s}static correctErrors(e,t,n){if(t!=null&&t.length>n/2+ge.MAX_ERRORS||n<0||n>ge.MAX_EC_CODEWORDS)throw te.getChecksumInstance();return ge.errorCorrection.decode(e,n,t)}static verifyCodewordCount(e,t){if(e.length<4)throw U.getFormatInstance();let n=e[0];if(n>e.length)throw U.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw U.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),n=0,r=t.length-1;for(;!((e&1)!==n&&(n=e&1,r--,r<0));)t[r]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return ge.getCodewordBucketNumber(ge.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new _n;for(let n=0;n<e.length;n++){t.format("Row %2d: ",n);for(let r=0;r<e[n].length;r++){let i=e[n][r];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}ge.CODEWORD_SKEW_SIZE=2,ge.MAX_ERRORS=3,ge.MAX_EC_CODEWORDS=512,ge.errorCorrection=new Vr;class rt{decode(e,t=null){let n=rt.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw v.getNotFoundInstance();return n[0]}decodeMultiple(e,t=null){try{return rt.decode(e,t,!0)}catch(n){throw n instanceof U||n instanceof te?v.getNotFoundInstance():n}}static decode(e,t,n){const r=new Array,i=ue.detectMultiple(e,t,n);for(const s of i.getPoints()){const o=ge.decode(i.getBits(),s[4],s[5],s[6],s[7],rt.getMinCodewordWidth(s),rt.getMaxCodewordWidth(s)),a=new D(o.getText(),o.getRawBytes(),void 0,s,B.PDF_417);a.putMetadata(de.ERROR_CORRECTION_LEVEL,o.getECLevel());const l=o.getOther();l!=null&&a.putMetadata(de.PDF417_EXTRA_METADATA,l),r.push(a)}return r.map(s=>s)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?K.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(rt.getMaxWidth(e[0],e[4]),rt.getMaxWidth(e[6],e[2])*se.MODULES_IN_CODEWORD/se.MODULES_IN_STOP_PATTERN),Math.max(rt.getMaxWidth(e[1],e[5]),rt.getMaxWidth(e[7],e[3])*se.MODULES_IN_CODEWORD/se.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(rt.getMinWidth(e[0],e[4]),rt.getMinWidth(e[6],e[2])*se.MODULES_IN_CODEWORD/se.MODULES_IN_STOP_PATTERN),Math.min(rt.getMinWidth(e[1],e[5]),rt.getMinWidth(e[7],e[3])*se.MODULES_IN_CODEWORD/se.MODULES_IN_STOP_PATTERN)))}reset(){}}class Wn extends C{}Wn.kind="ReaderException";class Yr{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!p(e)&&e.get(Ce.TRY_HARDER)===!0,n=p(e)?null:e.get(Ce.POSSIBLE_FORMATS),r=new Array;if(!p(n)){const i=n.some(s=>s===B.UPC_A||s===B.UPC_E||s===B.EAN_13||s===B.EAN_8||s===B.CODABAR||s===B.CODE_39||s===B.CODE_93||s===B.CODE_128||s===B.ITF||s===B.RSS_14||s===B.RSS_EXPANDED);i&&!t&&r.push(new hn(e,this.verbose)),n.includes(B.QR_CODE)&&r.push(new Yt),n.includes(B.DATA_MATRIX)&&r.push(new zt),n.includes(B.AZTEC)&&r.push(new Ln),n.includes(B.PDF_417)&&r.push(new rt),i&&t&&r.push(new hn(e,this.verbose))}r.length===0&&(t||r.push(new hn(e,this.verbose)),r.push(new Yt),r.push(new zt),r.push(new Ln),r.push(new rt),t&&r.push(new hn(e,this.verbose))),this.readers=r}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new Wn("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(n){if(n instanceof Wn)continue}throw new v("No MultiFormat Readers were able to detect the code.")}}class Ji extends et{constructor(e=null,t=500){const n=new Yr;n.setHints(e),super(n,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class $i extends et{constructor(e=500){super(new rt,e)}}class es extends et{constructor(e=500){super(new Yt,e)}}var cr;(function(f){f[f.ERROR_CORRECTION=0]="ERROR_CORRECTION",f[f.CHARACTER_SET=1]="CHARACTER_SET",f[f.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",f[f.MIN_SIZE=3]="MIN_SIZE",f[f.MAX_SIZE=4]="MAX_SIZE",f[f.MARGIN=5]="MARGIN",f[f.PDF417_COMPACT=6]="PDF417_COMPACT",f[f.PDF417_COMPACTION=7]="PDF417_COMPACTION",f[f.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",f[f.AZTEC_LAYERS=9]="AZTEC_LAYERS",f[f.QR_VERSION=10]="QR_VERSION"})(cr||(cr={}));var Ke=cr;class ur{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new xt(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let n=t[t.length-1];const r=this.field;for(let i=t.length;i<=e;i++){const s=n.multiply(new xt(r,Int32Array.from([1,r.exp(i-1+r.getGeneratorBase())])));t.push(s),n=s}}return t[e]}encode(e,t){if(t===0)throw new M("No error correction bytes");const n=e.length-t;if(n<=0)throw new M("No data bytes provided");const r=this.buildGenerator(t),i=new Int32Array(n);J.arraycopy(e,0,i,0,n);let s=new xt(this.field,i);s=s.multiplyByMonomial(t,1);const a=s.divide(r)[1].getCoefficients(),l=t-a.length;for(let c=0;c<l;c++)e[n+c]=0;J.arraycopy(a,0,e,n+l,a.length)}}class He{constructor(){}static applyMaskPenaltyRule1(e){return He.applyMaskPenaltyRule1Internal(e,!0)+He.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let s=0;s<i-1;s++){const o=n[s];for(let a=0;a<r-1;a++){const l=o[a];l===o[a+1]&&l===n[s+1][a]&&l===n[s+1][a+1]&&t++}}return He.N2*t}static applyMaskPenaltyRule3(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let s=0;s<i;s++)for(let o=0;o<r;o++){const a=n[s];o+6<r&&a[o]===1&&a[o+1]===0&&a[o+2]===1&&a[o+3]===1&&a[o+4]===1&&a[o+5]===0&&a[o+6]===1&&(He.isWhiteHorizontal(a,o-4,o)||He.isWhiteHorizontal(a,o+7,o+11))&&t++,s+6<i&&n[s][o]===1&&n[s+1][o]===0&&n[s+2][o]===1&&n[s+3][o]===1&&n[s+4][o]===1&&n[s+5][o]===0&&n[s+6][o]===1&&(He.isWhiteVertical(n,o,s-4,s)||He.isWhiteVertical(n,o,s+7,s+11))&&t++}return t*He.N3}static isWhiteHorizontal(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(let r=t;r<n;r++)if(e[r]===1)return!1;return!0}static isWhiteVertical(e,t,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(let i=n;i<r;i++)if(e[i][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let a=0;a<i;a++){const l=n[a];for(let c=0;c<r;c++)l[c]===1&&t++}const s=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-s)*10/s)*He.N4}static getDataMaskBit(e,t,n){let r,i;switch(e){case 0:r=n+t&1;break;case 1:r=n&1;break;case 2:r=t%3;break;case 3:r=(n+t)%3;break;case 4:r=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:i=n*t,r=(i&1)+i%3;break;case 6:i=n*t,r=(i&1)+i%3&1;break;case 7:i=n*t,r=i%3+(n+t&1)&1;break;default:throw new M("Invalid mask pattern: "+e)}return r===0}static applyMaskPenaltyRule1Internal(e,t){let n=0;const r=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),s=e.getArray();for(let o=0;o<r;o++){let a=0,l=-1;for(let c=0;c<i;c++){const h=t?s[o][c]:s[c][o];h===l?a++:(a>=5&&(n+=He.N1+(a-5)),a=1,l=h)}a>=5&&(n+=He.N1+(a-5))}return n}}He.N1=3,He.N2=3,He.N3=40,He.N4=10;class Xn{constructor(e,t){this.width=e,this.height=t;const n=new Array(t);for(let r=0;r!==t;r++)n[r]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,n){this.bytes[t][e]=n}setBoolean(e,t,n){this.bytes[t][e]=n?1:0}clear(e){for(const t of this.bytes)fe.fill(t,e)}equals(e){if(!(e instanceof Xn))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let n=0,r=this.height;n<r;++n){const i=this.bytes[n],s=t.bytes[n];for(let o=0,a=this.width;o<a;++o)if(i[o]!==s[o])return!1}return!0}toString(){const e=new re;for(let t=0,n=this.height;t<n;++t){const r=this.bytes[t];for(let i=0,s=this.width;i<s;++i)switch(r[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class nn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new re;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<nn.NUM_MASK_PATTERNS}}nn.NUM_MASK_PATTERNS=8;class ve extends C{}ve.kind="WriterException";class ie{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,n,r,i){ie.clearMatrix(i),ie.embedBasicPatterns(n,i),ie.embedTypeInfo(t,r,i),ie.maybeEmbedVersionInfo(n,i),ie.embedDataBits(e,r,i)}static embedBasicPatterns(e,t){ie.embedPositionDetectionPatternsAndSeparators(t),ie.embedDarkDotAtLeftBottomCorner(t),ie.maybeEmbedPositionAdjustmentPatterns(e,t),ie.embedTimingPatterns(t)}static embedTypeInfo(e,t,n){const r=new ce;ie.makeTypeInfoBits(e,t,r);for(let i=0,s=r.getSize();i<s;++i){const o=r.get(r.getSize()-1-i),a=ie.TYPE_INFO_COORDINATES[i],l=a[0],c=a[1];if(n.setBoolean(l,c,o),i<8){const h=n.getWidth()-i-1;n.setBoolean(h,8,o)}else{const g=n.getHeight()-7+(i-8);n.setBoolean(8,g,o)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const n=new ce;ie.makeVersionInfoBits(e,n);let r=17;for(let i=0;i<6;++i)for(let s=0;s<3;++s){const o=n.get(r);r--,t.setBoolean(i,t.getHeight()-11+s,o),t.setBoolean(t.getHeight()-11+s,i,o)}}static embedDataBits(e,t,n){let r=0,i=-1,s=n.getWidth()-1,o=n.getHeight()-1;for(;s>0;){for(s===6&&(s-=1);o>=0&&o<n.getHeight();){for(let a=0;a<2;++a){const l=s-a;if(!ie.isEmpty(n.get(l,o)))continue;let c;r<e.getSize()?(c=e.get(r),++r):c=!1,t!==255&&He.getDataMaskBit(t,l,o)&&(c=!c),n.setBoolean(l,o,c)}o+=i}i=-i,o+=i,s-=2}if(r!==e.getSize())throw new ve("Not all bits consumed: "+r+"/"+e.getSize())}static findMSBSet(e){return 32-K.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new M("0 polynomial");const n=ie.findMSBSet(t);for(e<<=n-1;ie.findMSBSet(e)>=n;)e^=t<<ie.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,t,n){if(!nn.isValidMaskPattern(t))throw new ve("Invalid mask pattern");const r=e.getBits()<<3|t;n.appendBits(r,5);const i=ie.calculateBCHCode(r,ie.TYPE_INFO_POLY);n.appendBits(i,10);const s=new ce;if(s.appendBits(ie.TYPE_INFO_MASK_PATTERN,15),n.xor(s),n.getSize()!==15)throw new ve("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const n=ie.calculateBCHCode(e.getVersionNumber(),ie.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new ve("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const n=(t+1)%2;ie.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),ie.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new ve;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,n){for(let r=0;r<8;++r){if(!ie.isEmpty(n.get(e+r,t)))throw new ve;n.setNumber(e+r,t,0)}}static embedVerticalSeparationPattern(e,t,n){for(let r=0;r<7;++r){if(!ie.isEmpty(n.get(e,t+r)))throw new ve;n.setNumber(e,t+r,0)}}static embedPositionAdjustmentPattern(e,t,n){for(let r=0;r<5;++r){const i=ie.POSITION_ADJUSTMENT_PATTERN[r];for(let s=0;s<5;++s)n.setNumber(e+s,t+r,i[s])}}static embedPositionDetectionPattern(e,t,n){for(let r=0;r<7;++r){const i=ie.POSITION_DETECTION_PATTERN[r];for(let s=0;s<7;++s)n.setNumber(e+s,t+r,i[s])}}static embedPositionDetectionPatternsAndSeparators(e){const t=ie.POSITION_DETECTION_PATTERN[0].length;ie.embedPositionDetectionPattern(0,0,e),ie.embedPositionDetectionPattern(e.getWidth()-t,0,e),ie.embedPositionDetectionPattern(0,e.getWidth()-t,e);const n=8;ie.embedHorizontalSeparationPattern(0,n-1,e),ie.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),ie.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);const r=7;ie.embedVerticalSeparationPattern(r,0,e),ie.embedVerticalSeparationPattern(e.getHeight()-r-1,0,e),ie.embedVerticalSeparationPattern(r,e.getHeight()-r,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,r=ie.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let i=0,s=r.length;i!==s;i++){const o=r[i];if(o>=0)for(let a=0;a!==s;a++){const l=r[a];l>=0&&ie.isEmpty(t.get(l,o))&&ie.embedPositionAdjustmentPattern(l-2,o-2,t)}}}}ie.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),ie.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),ie.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),ie.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),ie.VERSION_INFO_POLY=7973,ie.TYPE_INFO_POLY=1335,ie.TYPE_INFO_MASK_PATTERN=21522;class ts{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class ke{constructor(){}static calculateMaskPenalty(e){return He.applyMaskPenaltyRule1(e)+He.applyMaskPenaltyRule2(e)+He.applyMaskPenaltyRule3(e)+He.applyMaskPenaltyRule4(e)}static encode(e,t,n=null){let r=ke.DEFAULT_BYTE_MODE_ENCODING;const i=n!==null&&n.get(Ke.CHARACTER_SET)!==void 0;i&&(r=n.get(Ke.CHARACTER_SET).toString());const s=this.chooseMode(e,r),o=new ce;if(s===ne.BYTE&&(i||ke.DEFAULT_BYTE_MODE_ENCODING!==r)){const W=G.getCharacterSetECIByName(r);W!==void 0&&this.appendECI(W,o)}this.appendModeInfo(s,o);const a=new ce;this.appendBytes(e,s,a,r);let l;if(n!==null&&n.get(Ke.QR_VERSION)!==void 0){const W=Number.parseInt(n.get(Ke.QR_VERSION).toString(),10);l=Q.getVersionForNumber(W);const V=this.calculateBitsNeeded(s,o,a,l);if(!this.willFit(V,l,t))throw new ve("Data too big for requested version")}else l=this.recommendVersion(t,s,o,a);const c=new ce;c.appendBitArray(o);const h=s===ne.BYTE?a.getSizeInBytes():e.length;this.appendLengthInfo(h,l,s,c),c.appendBitArray(a);const g=l.getECBlocksForLevel(t),A=l.getTotalCodewords()-g.getTotalECCodewords();this.terminateBits(A,c);const b=this.interleaveWithECBytes(c,l.getTotalCodewords(),A,g.getNumBlocks()),y=new nn;y.setECLevel(t),y.setMode(s),y.setVersion(l);const _=l.getDimensionForVersion(),R=new Xn(_,_),H=this.chooseMaskPattern(b,t,l,R);return y.setMaskPattern(H),ie.buildMatrix(b,t,l,H,R),y.setMatrix(R),y}static recommendVersion(e,t,n,r){const i=this.calculateBitsNeeded(t,n,r,Q.getVersionForNumber(1)),s=this.chooseVersion(i,e),o=this.calculateBitsNeeded(t,n,r,s);return this.chooseVersion(o,e)}static calculateBitsNeeded(e,t,n,r){return t.getSize()+e.getCharacterCountBits(r)+n.getSize()}static getAlphanumericCode(e){return e<ke.ALPHANUMERIC_TABLE.length?ke.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(G.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return ne.KANJI;let n=!1,r=!1;for(let i=0,s=e.length;i<s;++i){const o=e.charAt(i);if(ke.isDigit(o))n=!0;else if(this.getAlphanumericCode(o.charCodeAt(0))!==-1)r=!0;else return ne.BYTE}return r?ne.ALPHANUMERIC:n?ne.NUMERIC:ne.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=ze.encode(e,G.SJIS)}catch{return!1}const n=t.length;if(n%2!==0)return!1;for(let r=0;r<n;r+=2){const i=t[r]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0}static chooseMaskPattern(e,t,n,r){let i=Number.MAX_SAFE_INTEGER,s=-1;for(let o=0;o<nn.NUM_MASK_PATTERNS;o++){ie.buildMatrix(e,t,n,o,r);let a=this.calculateMaskPenalty(r);a<i&&(i=a,s=o)}return s}static chooseVersion(e,t){for(let n=1;n<=40;n++){const r=Q.getVersionForNumber(n);if(ke.willFit(e,r,t))return r}throw new ve("Data too big")}static willFit(e,t,n){const r=t.getTotalCodewords(),s=t.getECBlocksForLevel(n).getTotalECCodewords(),o=r-s,a=(e+7)/8;return o>=a}static terminateBits(e,t){const n=e*8;if(t.getSize()>n)throw new ve("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(let s=0;s<4&&t.getSize()<n;++s)t.appendBit(!1);const r=t.getSize()&7;if(r>0)for(let s=r;s<8;s++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let s=0;s<i;++s)t.appendBits((s&1)===0?236:17,8);if(t.getSize()!==n)throw new ve("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,n,r,i,s){if(r>=n)throw new ve("Block ID too large");const o=e%n,a=n-o,l=Math.floor(e/n),c=l+1,h=Math.floor(t/n),g=h+1,A=l-h,b=c-g;if(A!==b)throw new ve("EC bytes mismatch");if(n!==a+o)throw new ve("RS blocks mismatch");if(e!==(h+A)*a+(g+b)*o)throw new ve("Total bytes mismatch");r<a?(i[0]=h,s[0]=A):(i[0]=g,s[0]=b)}static interleaveWithECBytes(e,t,n,r){if(e.getSizeInBytes()!==n)throw new ve("Number of bits and data bytes does not match");let i=0,s=0,o=0;const a=new Array;for(let c=0;c<r;++c){const h=new Int32Array(1),g=new Int32Array(1);ke.getNumDataBytesAndNumECBytesForBlockID(t,n,r,c,h,g);const A=h[0],b=new Uint8Array(A);e.toBytes(8*i,b,0,A);const y=ke.generateECBytes(b,g[0]);a.push(new ts(b,y)),s=Math.max(s,A),o=Math.max(o,y.length),i+=h[0]}if(n!==i)throw new ve("Data bytes does not match offset");const l=new ce;for(let c=0;c<s;++c)for(const h of a){const g=h.getDataBytes();c<g.length&&l.appendBits(g[c],8)}for(let c=0;c<o;++c)for(const h of a){const g=h.getErrorCorrectionBytes();c<g.length&&l.appendBits(g[c],8)}if(t!==l.getSizeInBytes())throw new ve("Interleaving error: "+t+" and "+l.getSizeInBytes()+" differ.");return l}static generateECBytes(e,t){const n=e.length,r=new Int32Array(n+t);for(let s=0;s<n;s++)r[s]=e[s]&255;new ur(_e.QR_CODE_FIELD_256).encode(r,t);const i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=r[n+s];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,n,r){const i=n.getCharacterCountBits(t);if(e>=1<<i)throw new ve(e+" is bigger than "+((1<<i)-1));r.appendBits(e,i)}static appendBytes(e,t,n,r){switch(t){case ne.NUMERIC:ke.appendNumericBytes(e,n);break;case ne.ALPHANUMERIC:ke.appendAlphanumericBytes(e,n);break;case ne.BYTE:ke.append8BitBytes(e,n,r);break;case ne.KANJI:ke.appendKanjiBytes(e,n);break;default:throw new ve("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=ke.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=ke.getDigit(e.charAt(r));if(r+2<n){const s=ke.getDigit(e.charAt(r+1)),o=ke.getDigit(e.charAt(r+2));t.appendBits(i*100+s*10+o,10),r+=3}else if(r+1<n){const s=ke.getDigit(e.charAt(r+1));t.appendBits(i*10+s,7),r+=2}else t.appendBits(i,4),r++}}static appendAlphanumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=ke.getAlphanumericCode(e.charCodeAt(r));if(i===-1)throw new ve;if(r+1<n){const s=ke.getAlphanumericCode(e.charCodeAt(r+1));if(s===-1)throw new ve;t.appendBits(i*45+s,11),r+=2}else t.appendBits(i,6),r++}}static append8BitBytes(e,t,n){let r;try{r=ze.encode(e,n)}catch(i){throw new ve(i)}for(let i=0,s=r.length;i!==s;i++){const o=r[i];t.appendBits(o,8)}}static appendKanjiBytes(e,t){let n;try{n=ze.encode(e,G.SJIS)}catch(i){throw new ve(i)}const r=n.length;for(let i=0;i<r;i+=2){const s=n[i]&255,o=n[i+1]&255,a=s<<8&4294967295|o;let l=-1;if(a>=33088&&a<=40956?l=a-33088:a>=57408&&a<=60351&&(l=a-49472),l===-1)throw new ve("Invalid byte sequence");const c=(l>>8)*192+(l&255);t.appendBits(c,13)}}static appendECI(e,t){t.appendBits(ne.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}ke.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),ke.DEFAULT_BYTE_MODE_ENCODING=G.UTF8.getName();class rn{write(e,t,n,r=null){if(e.length===0)throw new M("Found empty contents");if(t<0||n<0)throw new M("Requested dimensions are too small: "+t+"x"+n);let i=Be.L,s=rn.QUIET_ZONE_SIZE;r!==null&&(r.get(Ke.ERROR_CORRECTION)!==void 0&&(i=Be.fromString(r.get(Ke.ERROR_CORRECTION).toString())),r.get(Ke.MARGIN)!==void 0&&(s=Number.parseInt(r.get(Ke.MARGIN).toString(),10)));const o=ke.encode(e,i,r);return this.renderResult(o,t,n,s)}writeToDom(e,t,n,r,i=null){typeof e=="string"&&(e=document.querySelector(e));const s=this.write(t,n,r,i);e&&e.appendChild(s)}renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new Mt;const s=i.getWidth(),o=i.getHeight(),a=s+r*2,l=o+r*2,c=Math.max(t,a),h=Math.max(n,l),g=Math.min(Math.floor(c/a),Math.floor(h/l)),A=Math.floor((c-s*g)/2),b=Math.floor((h-o*g)/2),y=this.createSVGElement(c,h);for(let _=0,R=b;_<o;_++,R+=g)for(let H=0,W=A;H<s;H++,W+=g)if(i.get(H,_)===1){const V=this.createSvgRectElement(W,R,g,g);y.appendChild(V)}return y}createSVGElement(e,t){const n=document.createElementNS(rn.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",t.toString()),n}createSvgRectElement(e,t,n,r){const i=document.createElementNS(rn.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",n.toString()),i.setAttributeNS(null,"width",r.toString()),i.setAttributeNS(null,"fill","#000000"),i}}rn.QUIET_ZONE_SIZE=4,rn.SVG_NS="http://www.w3.org/2000/svg";class gn{encode(e,t,n,r,i){if(e.length===0)throw new M("Found empty contents");if(t!==B.QR_CODE)throw new M("Can only encode QR_CODE, but got "+t);if(n<0||r<0)throw new M(`Requested dimensions are too small: ${n}x${r}`);let s=Be.L,o=gn.QUIET_ZONE_SIZE;i!==null&&(i.get(Ke.ERROR_CORRECTION)!==void 0&&(s=Be.fromString(i.get(Ke.ERROR_CORRECTION).toString())),i.get(Ke.MARGIN)!==void 0&&(o=Number.parseInt(i.get(Ke.MARGIN).toString(),10)));const a=ke.encode(e,s,i);return gn.renderResult(a,n,r,o)}static renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new Mt;const s=i.getWidth(),o=i.getHeight(),a=s+r*2,l=o+r*2,c=Math.max(t,a),h=Math.max(n,l),g=Math.min(Math.floor(c/a),Math.floor(h/l)),A=Math.floor((c-s*g)/2),b=Math.floor((h-o*g)/2),y=new ye(c,h);for(let _=0,R=b;_<o;_++,R+=g)for(let H=0,W=A;H<s;H++,W+=g)i.get(H,_)===1&&y.setRegion(W,R,g,g);return y}}gn.QUIET_ZONE_SIZE=4;class ns{encode(e,t,n,r,i){let s;switch(t){case B.QR_CODE:s=new gn;break;default:throw new M("No encoder available for format "+t)}return s.encode(e,t,n,r,i)}}class Lt extends _t{constructor(e,t,n,r,i,s,o,a){if(super(s,o),this.yuvData=e,this.dataWidth=t,this.dataHeight=n,this.left=r,this.top=i,r+s>t||i+o>n)throw new M("Crop rectangle does not fit within image data.");a&&this.reverseHorizontal(s,o)}getRow(e,t){if(e<0||e>=this.getHeight())throw new M("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return J.arraycopy(this.yuvData,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return J.arraycopy(this.yuvData,i,r,0,n),r;for(let s=0;s<t;s++){const o=s*e;J.arraycopy(this.yuvData,i,r,o,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new Lt(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,n,r,!1)}renderThumbnail(){const e=this.getWidth()/Lt.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/Lt.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*t),r=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let s=0;s<t;s++){const o=s*e;for(let a=0;a<e;a++){const l=r[i+a*Lt.THUMBNAIL_SCALE_FACTOR]&255;n[o+a]=4278190080|l*65793}i+=this.dataWidth*Lt.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/Lt.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Lt.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const n=this.yuvData;for(let r=0,i=this.top*this.dataWidth+this.left;r<t;r++,i+=this.dataWidth){const s=i+e/2;for(let o=i,a=i+e-1;o<s;o++,a--){const l=n[o];n[o]=n[a],n[a]=l}}}invert(){return new Qe(this)}}Lt.THUMBNAIL_SCALE_FACTOR=2;class fr extends _t{constructor(e,t,n,r,i,s,o){if(super(t,n),this.dataWidth=r,this.dataHeight=i,this.left=s,this.top=o,e.BYTES_PER_ELEMENT===4){const a=t*n,l=new Uint8ClampedArray(a);for(let c=0;c<a;c++){const h=e[c],g=h>>16&255,A=h>>7&510,b=h&255;l[c]=(g+A+b)/4&255}this.luminances=l}else this.luminances=e;if(r===void 0&&(this.dataWidth=t),i===void 0&&(this.dataHeight=n),s===void 0&&(this.left=0),o===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+n>this.dataHeight)throw new M("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new M("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return J.arraycopy(this.luminances,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return J.arraycopy(this.luminances,i,r,0,n),r;for(let s=0;s<t;s++){const o=s*e;J.arraycopy(this.luminances,i,r,o,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new fr(this.luminances,n,r,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new Qe(this)}}class jr extends G{static forName(e){return this.getCharacterSetECIByName(e)}}class hr{}hr.ISO_8859_1=G.ISO8859_1;class Zr{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class qr{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class rs{constructor(e){this.previous=e}getPrevious(){return this.previous}}class xn extends rs{constructor(e,t,n){super(e),this.value=t,this.bitCount=n}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new xn(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new xn(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+K.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class dr extends xn{constructor(e,t,n){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=n}appendTo(e,t){for(let n=0;n<this.binaryShiftByteCount;n++)(n===0||n===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):n===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+n],8)}addBinaryShift(e,t){return new dr(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function is(f,e,t){return new dr(f,e,t)}function Rn(f,e,t){return new xn(f,e,t)}const ss=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Zt=0,zn=1,Ot=2,Kr=3,Ft=4,os=new xn(null,0,0),gr=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function as(f){for(let e of f)fe.fill(e,-1);return f[Zt][Ft]=0,f[zn][Ft]=0,f[zn][Zt]=28,f[Kr][Ft]=0,f[Ot][Ft]=0,f[Ot][Zt]=15,f}const Qr=as(fe.createInt32Array(6,6));class Ut{constructor(e,t,n,r){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=r}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let n=this.bitCount,r=this.token;if(e!==this.mode){let s=gr[this.mode][e];r=Rn(r,s&65535,s>>16),n+=s>>16}let i=e===Ot?4:5;return r=Rn(r,t,i),new Ut(r,e,0,n+i)}shiftAndAppend(e,t){let n=this.token,r=this.mode===Ot?4:5;return n=Rn(n,Qr[this.mode][e],r),n=Rn(n,t,5),new Ut(n,this.mode,0,this.bitCount+r+5)}addBinaryShiftChar(e){let t=this.token,n=this.mode,r=this.bitCount;if(this.mode===Ft||this.mode===Ot){let o=gr[n][Zt];t=Rn(t,o&65535,o>>16),r+=o>>16,n=Zt}let i=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,s=new Ut(t,n,this.binaryShiftByteCount+1,r+i);return s.binaryShiftByteCount===2078&&(s=s.endBinaryShift(e+1)),s}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=is(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new Ut(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(gr[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=Ut.calculateBinaryShiftCost(e)-Ut.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let r=this.endBinaryShift(e.length).token;r!==null;r=r.getPrevious())t.unshift(r);let n=new ce;for(const r of t)r.appendTo(n,e);return n}toString(){return $.format("%s bits=%d bytes=%d",ss[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}Ut.INITIAL_STATE=new Ut(os,Zt,0,0);function ls(f){const e=$.getCharCode(" "),t=$.getCharCode("."),n=$.getCharCode(",");f[Zt][e]=1;const r=$.getCharCode("Z"),i=$.getCharCode("A");for(let g=i;g<=r;g++)f[Zt][g]=g-i+2;f[zn][e]=1;const s=$.getCharCode("z"),o=$.getCharCode("a");for(let g=o;g<=s;g++)f[zn][g]=g-o+2;f[Ot][e]=1;const a=$.getCharCode("9"),l=$.getCharCode("0");for(let g=l;g<=a;g++)f[Ot][g]=g-l+2;f[Ot][n]=12,f[Ot][t]=13;const c=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let g=0;g<c.length;g++)f[Kr][$.getCharCode(c[g])]=g;const h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let g=0;g<h.length;g++)$.getCharCode(h[g])>0&&(f[Ft][$.getCharCode(h[g])]=g);return f}const xr=ls(fe.createInt32Array(5,256));class vn{constructor(e){this.text=e}encode(){const e=$.getCharCode(" "),t=$.getCharCode(`
`);let n=qr.singletonList(Ut.INITIAL_STATE);for(let i=0;i<this.text.length;i++){let s,o=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case $.getCharCode("\r"):s=o===t?2:0;break;case $.getCharCode("."):s=o===e?3:0;break;case $.getCharCode(","):s=o===e?4:0;break;case $.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=vn.updateStateListForPair(n,i,s),i++):n=this.updateStateListForChar(n,i)}return qr.min(n,(i,s)=>i.getBitCount()-s.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const n=[];for(let r of e)this.updateStateForChar(r,t,n);return vn.simplifyStates(n)}updateStateForChar(e,t,n){let r=this.text[t]&255,i=xr[e.getMode()][r]>0,s=null;for(let o=0;o<=Ft;o++){let a=xr[o][r];if(a>0){if(s==null&&(s=e.endBinaryShift(t)),!i||o===e.getMode()||o===Ot){const l=s.latchAndAppend(o,a);n.push(l)}if(!i&&Qr[e.getMode()][o]>=0){const l=s.shiftAndAppend(o,a);n.push(l)}}}if(e.getBinaryShiftByteCount()>0||xr[e.getMode()][r]===0){let o=e.addBinaryShiftChar(t);n.push(o)}}static updateStateListForPair(e,t,n){const r=[];for(let i of e)this.updateStateForPair(i,t,n,r);return this.simplifyStates(r)}static updateStateForPair(e,t,n,r){let i=e.endBinaryShift(t);if(r.push(i.latchAndAppend(Ft,n)),e.getMode()!==Ft&&r.push(i.shiftAndAppend(Ft,n)),n===3||n===4){let s=i.latchAndAppend(Ot,16-n).latchAndAppend(Ot,1);r.push(s)}if(e.getBinaryShiftByteCount()>0){let s=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);r.push(s)}}static simplifyStates(e){let t=[];for(const n of e){let r=!0;for(const i of t){if(i.isBetterThanOrEqualTo(n)){r=!1;break}n.isBetterThanOrEqualTo(i)&&(t=t.filter(s=>s!==i))}r&&t.push(n)}return t}}class be{constructor(){}static encodeBytes(e){return be.encode(e,be.DEFAULT_EC_PERCENT,be.DEFAULT_AZTEC_LAYERS)}static encode(e,t,n){let r=new vn(e).encode(),i=K.truncDivision(r.getSize()*t,100)+11,s=r.getSize()+i,o,a,l,c,h;if(n!==be.DEFAULT_AZTEC_LAYERS){if(o=n<0,a=Math.abs(n),a>(o?be.MAX_NB_BITS_COMPACT:be.MAX_NB_BITS))throw new M($.format("Illegal value %s for layers",n));l=be.totalBitsInLayer(a,o),c=be.WORD_SIZE[a];let V=l-l%c;if(h=be.stuffBits(r,c),h.getSize()+i>V)throw new M("Data to large for user specified layer");if(o&&h.getSize()>c*64)throw new M("Data to large for user specified layer")}else{c=0,h=null;for(let V=0;;V++){if(V>be.MAX_NB_BITS)throw new M("Data too large for an Aztec code");if(o=V<=3,a=o?V+1:V,l=be.totalBitsInLayer(a,o),s>l)continue;(h==null||c!==be.WORD_SIZE[a])&&(c=be.WORD_SIZE[a],h=be.stuffBits(r,c));let Ae=l-l%c;if(!(o&&h.getSize()>c*64)&&h.getSize()+i<=Ae)break}}let g=be.generateCheckWords(h,l,c),A=h.getSize()/c,b=be.generateModeMessage(o,a,A),y=(o?11:14)+a*4,_=new Int32Array(y),R;if(o){R=y;for(let V=0;V<_.length;V++)_[V]=V}else{R=y+1+2*K.truncDivision(K.truncDivision(y,2)-1,15);let V=K.truncDivision(y,2),Ae=K.truncDivision(R,2);for(let le=0;le<V;le++){let Ct=le+K.truncDivision(le,15);_[V-le-1]=Ae-Ct-1,_[V+le]=Ae+Ct+1}}let H=new ye(R);for(let V=0,Ae=0;V<a;V++){let le=(a-V)*4+(o?9:12);for(let Ct=0;Ct<le;Ct++){let Dt=Ct*2;for(let pt=0;pt<2;pt++)g.get(Ae+Dt+pt)&&H.set(_[V*2+pt],_[V*2+Ct]),g.get(Ae+le*2+Dt+pt)&&H.set(_[V*2+Ct],_[y-1-V*2-pt]),g.get(Ae+le*4+Dt+pt)&&H.set(_[y-1-V*2-pt],_[y-1-V*2-Ct]),g.get(Ae+le*6+Dt+pt)&&H.set(_[y-1-V*2-Ct],_[V*2+pt])}Ae+=le*8}if(be.drawModeMessage(H,o,R,b),o)be.drawBullsEye(H,K.truncDivision(R,2),5);else{be.drawBullsEye(H,K.truncDivision(R,2),7);for(let V=0,Ae=0;V<K.truncDivision(y,2)-1;V+=15,Ae+=16)for(let le=K.truncDivision(R,2)&1;le<R;le+=2)H.set(K.truncDivision(R,2)-Ae,le),H.set(K.truncDivision(R,2)+Ae,le),H.set(le,K.truncDivision(R,2)-Ae),H.set(le,K.truncDivision(R,2)+Ae)}let W=new Zr;return W.setCompact(o),W.setSize(R),W.setLayers(a),W.setCodeWords(A),W.setMatrix(H),W}static drawBullsEye(e,t,n){for(let r=0;r<n;r+=2)for(let i=t-r;i<=t+r;i++)e.set(i,t-r),e.set(i,t+r),e.set(t-r,i),e.set(t+r,i);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)}static generateModeMessage(e,t,n){let r=new ce;return e?(r.appendBits(t-1,2),r.appendBits(n-1,6),r=be.generateCheckWords(r,28,4)):(r.appendBits(t-1,5),r.appendBits(n-1,11),r=be.generateCheckWords(r,40,4)),r}static drawModeMessage(e,t,n,r){let i=K.truncDivision(n,2);if(t)for(let s=0;s<7;s++){let o=i-3+s;r.get(s)&&e.set(o,i-5),r.get(s+7)&&e.set(i+5,o),r.get(20-s)&&e.set(o,i+5),r.get(27-s)&&e.set(i-5,o)}else for(let s=0;s<10;s++){let o=i-5+s+K.truncDivision(s,5);r.get(s)&&e.set(o,i-7),r.get(s+10)&&e.set(i+7,o),r.get(29-s)&&e.set(o,i+7),r.get(39-s)&&e.set(i-7,o)}}static generateCheckWords(e,t,n){let r=e.getSize()/n,i=new ur(be.getGF(n)),s=K.truncDivision(t,n),o=be.bitsToWords(e,n,s);i.encode(o,s-r);let a=t%n,l=new ce;l.appendBits(0,a);for(const c of Array.from(o))l.appendBits(c,n);return l}static bitsToWords(e,t,n){let r=new Int32Array(n),i,s;for(i=0,s=e.getSize()/t;i<s;i++){let o=0;for(let a=0;a<t;a++)o|=e.get(i*t+a)?1<<t-a-1:0;r[i]=o}return r}static getGF(e){switch(e){case 4:return _e.AZTEC_PARAM;case 6:return _e.AZTEC_DATA_6;case 8:return _e.AZTEC_DATA_8;case 10:return _e.AZTEC_DATA_10;case 12:return _e.AZTEC_DATA_12;default:throw new M("Unsupported word size "+e)}}static stuffBits(e,t){let n=new ce,r=e.getSize(),i=(1<<t)-2;for(let s=0;s<r;s+=t){let o=0;for(let a=0;a<t;a++)(s+a>=r||e.get(s+a))&&(o|=1<<t-1-a);(o&i)===i?(n.appendBits(o&i,t),s--):(o&i)===0?(n.appendBits(o|1,t),s--):n.appendBits(o,t)}return n}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}be.DEFAULT_EC_PERCENT=33,be.DEFAULT_AZTEC_LAYERS=0,be.MAX_NB_BITS=32,be.MAX_NB_BITS_COMPACT=4,be.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Yn{encode(e,t,n,r){return this.encodeWithHints(e,t,n,r,null)}encodeWithHints(e,t,n,r,i){let s=hr.ISO_8859_1,o=be.DEFAULT_EC_PERCENT,a=be.DEFAULT_AZTEC_LAYERS;return i!=null&&(i.has(Ke.CHARACTER_SET)&&(s=jr.forName(i.get(Ke.CHARACTER_SET).toString())),i.has(Ke.ERROR_CORRECTION)&&(o=K.parseInt(i.get(Ke.ERROR_CORRECTION).toString())),i.has(Ke.AZTEC_LAYERS)&&(a=K.parseInt(i.get(Ke.AZTEC_LAYERS).toString()))),Yn.encodeLayers(e,t,n,r,s,o,a)}static encodeLayers(e,t,n,r,i,s,o){if(t!==B.AZTEC)throw new M("Can only encode AZTEC, but got "+t);let a=be.encode($.getBytes(e,i),s,o);return Yn.renderResult(a,n,r)}static renderResult(e,t,n){let r=e.getMatrix();if(r==null)throw new Mt;let i=r.getWidth(),s=r.getHeight(),o=Math.max(t,i),a=Math.max(n,s),l=Math.min(o/i,a/s),c=(o-i*l)/2,h=(a-s*l)/2,g=new ye(o,a);for(let A=0,b=h;A<s;A++,b+=l)for(let y=0,_=c;y<i;y++,_+=l)r.get(y,A)&&g.setRegion(_,b,l,l);return g}}u.AbstractExpandedDecoder=er,u.ArgumentException=P,u.ArithmeticException=Bn,u.AztecCode=Zr,u.AztecCodeReader=Ln,u.AztecCodeWriter=Yn,u.AztecDecoder=Me,u.AztecDetector=Br,u.AztecDetectorResult=Dr,u.AztecEncoder=be,u.AztecHighLevelEncoder=vn,u.AztecPoint=ft,u.BarcodeFormat=B,u.Binarizer=xe,u.BinaryBitmap=ae,u.BitArray=ce,u.BitMatrix=ye,u.BitSource=ir,u.BrowserAztecCodeReader=Bi,u.BrowserBarcodeReader=Ui,u.BrowserCodeReader=et,u.BrowserDatamatrixCodeReader=Gi,u.BrowserMultiFormatReader=Ji,u.BrowserPDF417Reader=$i,u.BrowserQRCodeReader=es,u.BrowserQRCodeSvgWriter=rn,u.CharacterSetECI=G,u.ChecksumException=te,u.Code128Reader=z,u.Code39Reader=Ze,u.DataMatrixDecodedBitStreamParser=Xt,u.DataMatrixReader=zt,u.DecodeHintType=Ce,u.DecoderResult=gt,u.DefaultGridSampler=Mr,u.DetectorResult=Pn,u.EAN13Reader=Jt,u.EncodeHintType=Ke,u.Exception=C,u.FormatException=U,u.GenericGF=_e,u.GenericGFPoly=xt,u.GlobalHistogramBinarizer=Ie,u.GridSampler=Kn,u.GridSamplerInstance=Ht,u.HTMLCanvasElementLuminanceSource=ut,u.HybridBinarizer=oe,u.ITFReader=Re,u.IllegalArgumentException=M,u.IllegalStateException=Mt,u.InvertedLuminanceSource=Qe,u.LuminanceSource=_t,u.MathUtils=Ee,u.MultiFormatOneDReader=hn,u.MultiFormatReader=Yr,u.MultiFormatWriter=ns,u.NotFoundException=v,u.OneDReader=je,u.PDF417DecodedBitStreamParser=O,u.PDF417DecoderErrorCorrection=Vr,u.PDF417Reader=rt,u.PDF417ResultMetadata=Hr,u.PerspectiveTransform=Rt,u.PlanarYUVLuminanceSource=Lt,u.QRCodeByteMatrix=Xn,u.QRCodeDataMask=Tt,u.QRCodeDecodedBitStreamParser=Ue,u.QRCodeDecoderErrorCorrectionLevel=Be,u.QRCodeDecoderFormatInformation=at,u.QRCodeEncoder=ke,u.QRCodeEncoderQRCode=nn,u.QRCodeMaskUtil=He,u.QRCodeMatrixUtil=ie,u.QRCodeMode=ne,u.QRCodeReader=Yt,u.QRCodeVersion=Q,u.QRCodeWriter=gn,u.RGBLuminanceSource=fr,u.RSS14Reader=Ge,u.RSSExpandedReader=L,u.ReaderException=Wn,u.ReedSolomonDecoder=bn,u.ReedSolomonEncoder=ur,u.ReedSolomonException=ln,u.Result=D,u.ResultMetadataType=de,u.ResultPoint=Z,u.StringUtils=$,u.UnsupportedOperationException=bt,u.VideoInputDevice=an,u.WhiteRectangleDetector=Vt,u.WriterException=ve,u.ZXingArrays=fe,u.ZXingCharset=jr,u.ZXingInteger=K,u.ZXingStandardCharsets=hr,u.ZXingStringBuilder=re,u.ZXingStringEncoding=ze,u.ZXingSystem=J,u.createAbstractExpandedDecoder=Fr,Object.defineProperty(u,"__esModule",{value:!0})}))})(Mn,Mn.exports)),Mn.exports}var Le=Ns();const Os=Si(Le),Rs=bs({__proto__:null,default:Os},[Le]);var si=(function(){function x(d,u,p){if(this.formatMap=new Map([[Y.QR_CODE,Le.BarcodeFormat.QR_CODE],[Y.AZTEC,Le.BarcodeFormat.AZTEC],[Y.CODABAR,Le.BarcodeFormat.CODABAR],[Y.CODE_39,Le.BarcodeFormat.CODE_39],[Y.CODE_93,Le.BarcodeFormat.CODE_93],[Y.CODE_128,Le.BarcodeFormat.CODE_128],[Y.DATA_MATRIX,Le.BarcodeFormat.DATA_MATRIX],[Y.MAXICODE,Le.BarcodeFormat.MAXICODE],[Y.ITF,Le.BarcodeFormat.ITF],[Y.EAN_13,Le.BarcodeFormat.EAN_13],[Y.EAN_8,Le.BarcodeFormat.EAN_8],[Y.PDF_417,Le.BarcodeFormat.PDF_417],[Y.RSS_14,Le.BarcodeFormat.RSS_14],[Y.RSS_EXPANDED,Le.BarcodeFormat.RSS_EXPANDED],[Y.UPC_A,Le.BarcodeFormat.UPC_A],[Y.UPC_E,Le.BarcodeFormat.UPC_E],[Y.UPC_EAN_EXTENSION,Le.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Rs)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=u,this.logger=p;var E=this.createZXingFormats(d),w=new Map;w.set(Le.DecodeHintType.POSSIBLE_FORMATS,E),w.set(Le.DecodeHintType.TRY_HARDER,!1),this.hints=w}return x.prototype.decodeAsync=function(d){var u=this;return new Promise(function(p,E){try{p(u.decode(d))}catch(w){E(w)}})},x.prototype.decode=function(d){var u=new Le.MultiFormatReader(this.verbose,this.hints),p=new Le.HTMLCanvasElementLuminanceSource(d),E=new Le.BinaryBitmap(new Le.HybridBinarizer(p)),w=u.decode(E);return{text:w.text,format:Ni.create(this.toHtml5QrcodeSupportedFormats(w.format)),debugData:this.createDebugData()}},x.prototype.createReverseFormatMap=function(){var d=new Map;return this.formatMap.forEach(function(u,p,E){d.set(u,p)}),d},x.prototype.toHtml5QrcodeSupportedFormats=function(d){if(!this.reverseFormatMap.has(d))throw"reverseFormatMap doesn't have ".concat(d);return this.reverseFormatMap.get(d)},x.prototype.createZXingFormats=function(d){for(var u=[],p=0,E=d;p<E.length;p++){var w=E[p];this.formatMap.has(w)?u.push(this.formatMap.get(w)):this.logger.logError("".concat(w," is not supported by")+"ZXingHtml5QrcodeShim")}return u},x.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},x})(),vs=function(x,d,u,p){function E(w){return w instanceof u?w:new u(function(N){N(w)})}return new(u||(u=Promise))(function(w,N){function F(P){try{C(p.next(P))}catch(M){N(M)}}function k(P){try{C(p.throw(P))}catch(M){N(M)}}function C(P){P.done?w(P.value):E(P.value).then(F,k)}C((p=p.apply(x,d||[])).next())})},Ds=function(x,d){var u={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},p,E,w,N;return N={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function F(C){return function(P){return k([C,P])}}function k(C){if(p)throw new TypeError("Generator is already executing.");for(;N&&(N=0,C[0]&&(u=0)),u;)try{if(p=1,E&&(w=C[0]&2?E.return:C[0]?E.throw||((w=E.return)&&w.call(E),0):E.next)&&!(w=w.call(E,C[1])).done)return w;switch(E=0,w&&(C=[C[0]&2,w.value]),C[0]){case 0:case 1:w=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,E=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(w=u.trys,!(w=w.length>0&&w[w.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!w||C[1]>w[0]&&C[1]<w[3])){u.label=C[1];break}if(C[0]===6&&u.label<w[1]){u.label=w[1],w=C;break}if(w&&u.label<w[2]){u.label=w[2],u.ops.push(C);break}w[2]&&u.ops.pop(),u.trys.pop();continue}C=d.call(x,u)}catch(P){C=[6,P],E=0}finally{p=w=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},oi=(function(){function x(d,u,p){if(this.formatMap=new Map([[Y.QR_CODE,"qr_code"],[Y.AZTEC,"aztec"],[Y.CODABAR,"codabar"],[Y.CODE_39,"code_39"],[Y.CODE_93,"code_93"],[Y.CODE_128,"code_128"],[Y.DATA_MATRIX,"data_matrix"],[Y.ITF,"itf"],[Y.EAN_13,"ean_13"],[Y.EAN_8,"ean_8"],[Y.PDF_417,"pdf417"],[Y.UPC_A,"upc_a"],[Y.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!x.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=u,this.logger=p;var E=this.createBarcodeDetectorFormats(d);if(this.detector=new BarcodeDetector(E),!this.detector)throw"BarcodeDetector detector not supported"}return x.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var d=new BarcodeDetector({formats:["qr_code"]});return typeof d<"u"},x.prototype.decodeAsync=function(d){return vs(this,void 0,void 0,function(){var u,p;return Ds(this,function(E){switch(E.label){case 0:return[4,this.detector.detect(d)];case 1:if(u=E.sent(),!u||u.length===0)throw"No barcode or QR code detected.";return p=this.selectLargestBarcode(u),[2,{text:p.rawValue,format:Ni.create(this.toHtml5QrcodeSupportedFormats(p.format)),debugData:this.createDebugData()}]}})})},x.prototype.selectLargestBarcode=function(d){for(var u=null,p=0,E=0,w=d;E<w.length;E++){var N=w[E],F=N.boundingBox.width*N.boundingBox.height;F>p&&(p=F,u=N)}if(!u)throw"No largest barcode found";return u},x.prototype.createBarcodeDetectorFormats=function(d){for(var u=[],p=0,E=d;p<E.length;p++){var w=E[p];this.formatMap.has(w)?u.push(this.formatMap.get(w)):this.logger.warn("".concat(w," is not supported by")+"BarcodeDetectorDelegate")}return{formats:u}},x.prototype.toHtml5QrcodeSupportedFormats=function(d){if(!this.reverseFormatMap.has(d))throw"reverseFormatMap doesn't have ".concat(d);return this.reverseFormatMap.get(d)},x.prototype.createReverseFormatMap=function(){var d=new Map;return this.formatMap.forEach(function(u,p,E){d.set(u,p)}),d},x.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},x})(),ai=function(x,d,u,p){function E(w){return w instanceof u?w:new u(function(N){N(w)})}return new(u||(u=Promise))(function(w,N){function F(P){try{C(p.next(P))}catch(M){N(M)}}function k(P){try{C(p.throw(P))}catch(M){N(M)}}function C(P){P.done?w(P.value):E(P.value).then(F,k)}C((p=p.apply(x,d||[])).next())})},li=function(x,d){var u={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},p,E,w,N;return N={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function F(C){return function(P){return k([C,P])}}function k(C){if(p)throw new TypeError("Generator is already executing.");for(;N&&(N=0,C[0]&&(u=0)),u;)try{if(p=1,E&&(w=C[0]&2?E.return:C[0]?E.throw||((w=E.return)&&w.call(E),0):E.next)&&!(w=w.call(E,C[1])).done)return w;switch(E=0,w&&(C=[C[0]&2,w.value]),C[0]){case 0:case 1:w=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,E=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(w=u.trys,!(w=w.length>0&&w[w.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!w||C[1]>w[0]&&C[1]<w[3])){u.label=C[1];break}if(C[0]===6&&u.label<w[1]){u.label=w[1],w=C;break}if(w&&u.label<w[2]){u.label=w[2],u.ops.push(C);break}w[2]&&u.ops.pop(),u.trys.pop();continue}C=d.call(x,u)}catch(P){C=[6,P],E=0}finally{p=w=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Ms=(function(){function x(d,u,p,E){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=p,u&&oi.isSupported()?(this.primaryDecoder=new oi(d,p,E),this.secondaryDecoder=new si(d,p,E)):this.primaryDecoder=new si(d,p,E)}return x.prototype.decodeAsync=function(d){return ai(this,void 0,void 0,function(){var u;return li(this,function(p){switch(p.label){case 0:u=performance.now(),p.label=1;case 1:return p.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(d)];case 2:return[2,p.sent()];case 3:return this.possiblyLogPerformance(u),[7];case 4:return[2]}})})},x.prototype.decodeRobustlyAsync=function(d){return ai(this,void 0,void 0,function(){var u,p;return li(this,function(E){switch(E.label){case 0:u=performance.now(),E.label=1;case 1:return E.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(d)];case 2:return[2,E.sent()];case 3:if(p=E.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(d)];throw p;case 4:return this.possiblyLogPerformance(u),[7];case 5:return[2]}})})},x.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},x.prototype.possiblyLogPerformance=function(d){if(this.verbose){var u=performance.now()-d;this.executionResults.push(u),this.executions++,this.possiblyFlushPerformanceReport()}},x.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var d=0,u=0,p=this.executionResults;u<p.length;u++){var E=p[u];d+=E}var w=d/this.executionResults.length;console.log("".concat(w," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},x})(),vr=(function(){var x=function(d,u){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,E){p.__proto__=E}||function(p,E){for(var w in E)Object.prototype.hasOwnProperty.call(E,w)&&(p[w]=E[w])},x(d,u)};return function(d,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");x(d,u);function p(){this.constructor=d}d.prototype=u===null?Object.create(u):(p.prototype=u.prototype,new p)}})(),Zn=function(x,d,u,p){function E(w){return w instanceof u?w:new u(function(N){N(w)})}return new(u||(u=Promise))(function(w,N){function F(P){try{C(p.next(P))}catch(M){N(M)}}function k(P){try{C(p.throw(P))}catch(M){N(M)}}function C(P){P.done?w(P.value):E(P.value).then(F,k)}C((p=p.apply(x,d||[])).next())})},qn=function(x,d){var u={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},p,E,w,N;return N={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function F(C){return function(P){return k([C,P])}}function k(C){if(p)throw new TypeError("Generator is already executing.");for(;N&&(N=0,C[0]&&(u=0)),u;)try{if(p=1,E&&(w=C[0]&2?E.return:C[0]?E.throw||((w=E.return)&&w.call(E),0):E.next)&&!(w=w.call(E,C[1])).done)return w;switch(E=0,w&&(C=[C[0]&2,w.value]),C[0]){case 0:case 1:w=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,E=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(w=u.trys,!(w=w.length>0&&w[w.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!w||C[1]>w[0]&&C[1]<w[3])){u.label=C[1];break}if(C[0]===6&&u.label<w[1]){u.label=w[1],w=C;break}if(w&&u.label<w[2]){u.label=w[2],u.ops.push(C);break}w[2]&&u.ops.pop(),u.trys.pop();continue}C=d.call(x,u)}catch(P){C=[6,P],E=0}finally{p=w=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Ri=(function(){function x(d,u){this.name=d,this.track=u}return x.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},x.prototype.apply=function(d){var u={};u[this.name]=d;var p={advanced:[u]};return this.track.applyConstraints(p)},x.prototype.value=function(){var d=this.track.getSettings();if(this.name in d){var u=d[this.name];return u}return null},x})(),Bs=(function(x){vr(d,x);function d(u,p){return x.call(this,u,p)||this}return d.prototype.min=function(){return this.getCapabilities().min},d.prototype.max=function(){return this.getCapabilities().max},d.prototype.step=function(){return this.getCapabilities().step},d.prototype.apply=function(u){var p={};p[this.name]=u;var E={advanced:[p]};return this.track.applyConstraints(E)},d.prototype.getCapabilities=function(){this.failIfNotSupported();var u=this.track.getCapabilities(),p=u[this.name];return{min:p.min,max:p.max,step:p.step}},d.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},d})(Ri),ks=(function(x){vr(d,x);function d(u){return x.call(this,"zoom",u)||this}return d})(Bs),Ps=(function(x){vr(d,x);function d(u){return x.call(this,"torch",u)||this}return d})(Ri),Ls=(function(){function x(d){this.track=d}return x.prototype.zoomFeature=function(){return new ks(this.track)},x.prototype.torchFeature=function(){return new Ps(this.track)},x})(),Fs=(function(){function x(d,u,p){this.isClosed=!1,this.parentElement=d,this.mediaStream=u,this.callbacks=p,this.surface=this.createVideoElement(this.parentElement.clientWidth),d.append(this.surface)}return x.prototype.createVideoElement=function(d){var u=document.createElement("video");return u.style.width="".concat(d,"px"),u.style.display="block",u.muted=!0,u.setAttribute("muted","true"),u.playsInline=!0,u},x.prototype.setupSurface=function(){var d=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var u=function(){var p=d.surface.clientWidth,E=d.surface.clientHeight;d.callbacks.onRenderSurfaceReady(p,E),d.surface.removeEventListener("playing",u)};this.surface.addEventListener("playing",u),this.surface.srcObject=this.mediaStream,this.surface.play()},x.create=function(d,u,p,E){return Zn(this,void 0,void 0,function(){var w,N;return qn(this,function(F){switch(F.label){case 0:return w=new x(d,u,E),p.aspectRatio?(N={aspectRatio:p.aspectRatio},[4,w.getFirstTrackOrFail().applyConstraints(N)]):[3,2];case 1:F.sent(),F.label=2;case 2:return w.setupSurface(),[2,w]}})})},x.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},x.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},x.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},x.prototype.resume=function(d){this.failIfClosed();var u=this,p=function(){setTimeout(d,200),u.surface.removeEventListener("playing",p)};this.surface.addEventListener("playing",p),this.surface.play()},x.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},x.prototype.getSurface=function(){return this.failIfClosed(),this.surface},x.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},x.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},x.prototype.applyVideoConstraints=function(d){return Zn(this,void 0,void 0,function(){return qn(this,function(u){if("aspectRatio"in d)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(d)]})})},x.prototype.close=function(){if(this.isClosed)return Promise.resolve();var d=this;return new Promise(function(u,p){var E=d.mediaStream.getVideoTracks(),w=E.length,N=0;d.mediaStream.getVideoTracks().forEach(function(F){d.mediaStream.removeTrack(F),F.stop(),++N,N>=w&&(d.isClosed=!0,d.parentElement.removeChild(d.surface),u())})})},x.prototype.getCapabilities=function(){return new Ls(this.getFirstTrackOrFail())},x})(),Us=(function(){function x(d){this.mediaStream=d}return x.prototype.render=function(d,u,p){return Zn(this,void 0,void 0,function(){return qn(this,function(E){return[2,Fs.create(d,this.mediaStream,u,p)]})})},x.create=function(d){return Zn(this,void 0,void 0,function(){var u,p;return qn(this,function(E){switch(E.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return u={audio:!1,video:d},[4,navigator.mediaDevices.getUserMedia(u)];case 1:return p=E.sent(),[2,new x(p)]}})})},x})(),ci=function(x,d,u,p){function E(w){return w instanceof u?w:new u(function(N){N(w)})}return new(u||(u=Promise))(function(w,N){function F(P){try{C(p.next(P))}catch(M){N(M)}}function k(P){try{C(p.throw(P))}catch(M){N(M)}}function C(P){P.done?w(P.value):E(P.value).then(F,k)}C((p=p.apply(x,d||[])).next())})},ui=function(x,d){var u={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},p,E,w,N;return N={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function F(C){return function(P){return k([C,P])}}function k(C){if(p)throw new TypeError("Generator is already executing.");for(;N&&(N=0,C[0]&&(u=0)),u;)try{if(p=1,E&&(w=C[0]&2?E.return:C[0]?E.throw||((w=E.return)&&w.call(E),0):E.next)&&!(w=w.call(E,C[1])).done)return w;switch(E=0,w&&(C=[C[0]&2,w.value]),C[0]){case 0:case 1:w=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,E=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(w=u.trys,!(w=w.length>0&&w[w.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!w||C[1]>w[0]&&C[1]<w[3])){u.label=C[1];break}if(C[0]===6&&u.label<w[1]){u.label=w[1],w=C;break}if(w&&u.label<w[2]){u.label=w[2],u.ops.push(C);break}w[2]&&u.ops.pop(),u.trys.pop();continue}C=d.call(x,u)}catch(P){C=[6,P],E=0}finally{p=w=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Vs=(function(){function x(){}return x.failIfNotSupported=function(){return ci(this,void 0,void 0,function(){return ui(this,function(d){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new x]})})},x.prototype.create=function(d){return ci(this,void 0,void 0,function(){return ui(this,function(u){return[2,Us.create(d)]})})},x})(),Gs=function(x,d,u,p){function E(w){return w instanceof u?w:new u(function(N){N(w)})}return new(u||(u=Promise))(function(w,N){function F(P){try{C(p.next(P))}catch(M){N(M)}}function k(P){try{C(p.throw(P))}catch(M){N(M)}}function C(P){P.done?w(P.value):E(P.value).then(F,k)}C((p=p.apply(x,d||[])).next())})},Hs=function(x,d){var u={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},p,E,w,N;return N={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function F(C){return function(P){return k([C,P])}}function k(C){if(p)throw new TypeError("Generator is already executing.");for(;N&&(N=0,C[0]&&(u=0)),u;)try{if(p=1,E&&(w=C[0]&2?E.return:C[0]?E.throw||((w=E.return)&&w.call(E),0):E.next)&&!(w=w.call(E,C[1])).done)return w;switch(E=0,w&&(C=[C[0]&2,w.value]),C[0]){case 0:case 1:w=C;break;case 4:return u.label++,{value:C[1],done:!1};case 5:u.label++,E=C[1],C=[0];continue;case 7:C=u.ops.pop(),u.trys.pop();continue;default:if(w=u.trys,!(w=w.length>0&&w[w.length-1])&&(C[0]===6||C[0]===2)){u=0;continue}if(C[0]===3&&(!w||C[1]>w[0]&&C[1]<w[3])){u.label=C[1];break}if(C[0]===6&&u.label<w[1]){u.label=w[1],w=C;break}if(w&&u.label<w[2]){u.label=w[2],u.ops.push(C);break}w[2]&&u.ops.pop(),u.trys.pop();continue}C=d.call(x,u)}catch(P){C=[6,P],E=0}finally{p=w=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},Ws=(function(){function x(){}return x.retrieve=function(){if(navigator.mediaDevices)return x.getCamerasFromMediaDevices();var d=MediaStreamTrack;return MediaStreamTrack&&d.getSources?x.getCamerasFromMediaStreamTrack():x.rejectWithError()},x.rejectWithError=function(){var d=pn.unableToQuerySupportedDevices();return x.isHttpsOrLocalhost()||(d=pn.insecureContextCameraQueryError()),Promise.reject(d)},x.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var d=location.host.split(":")[0];return d==="127.0.0.1"||d==="localhost"},x.getCamerasFromMediaDevices=function(){return Gs(this,void 0,void 0,function(){var d,u,p,E,w,N,F;return Hs(this,function(k){switch(k.label){case 0:return d=function(C){for(var P=C.getVideoTracks(),M=0,ae=P;M<ae.length;M++){var te=ae[M];te.enabled=!1,te.stop(),C.removeTrack(te)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return u=k.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(p=k.sent(),E=[],w=0,N=p;w<N.length;w++)F=N[w],F.kind==="videoinput"&&E.push({id:F.deviceId,label:F.label});return d(u),[2,E]}})})},x.getCamerasFromMediaStreamTrack=function(){return new Promise(function(d,u){var p=function(w){for(var N=[],F=0,k=w;F<k.length;F++){var C=k[F];C.kind==="video"&&N.push({id:C.id,label:C.label})}d(N)},E=MediaStreamTrack;E.getSources(p)})},x})(),We;(function(x){x[x.UNKNOWN=0]="UNKNOWN",x[x.NOT_STARTED=1]="NOT_STARTED",x[x.SCANNING=2]="SCANNING",x[x.PAUSED=3]="PAUSED"})(We||(We={}));var Xs=(function(){function x(){this.state=We.NOT_STARTED,this.onGoingTransactionNewState=We.UNKNOWN}return x.prototype.directTransition=function(d){this.failIfTransitionOngoing(),this.validateTransition(d),this.state=d},x.prototype.startTransition=function(d){return this.failIfTransitionOngoing(),this.validateTransition(d),this.onGoingTransactionNewState=d,this},x.prototype.execute=function(){if(this.onGoingTransactionNewState===We.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var d=this.onGoingTransactionNewState;this.onGoingTransactionNewState=We.UNKNOWN,this.directTransition(d)},x.prototype.cancel=function(){if(this.onGoingTransactionNewState===We.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=We.UNKNOWN},x.prototype.getState=function(){return this.state},x.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==We.UNKNOWN)throw"Cannot transition to a new state, already under transition"},x.prototype.validateTransition=function(d){switch(this.state){case We.UNKNOWN:throw"Transition from unknown is not allowed";case We.NOT_STARTED:this.failIfNewStateIs(d,[We.PAUSED]);break;case We.SCANNING:break;case We.PAUSED:break}},x.prototype.failIfNewStateIs=function(d,u){for(var p=0,E=u;p<E.length;p++){var w=E[p];if(d===w)throw"Cannot transition from ".concat(this.state," to ").concat(d)}},x})(),zs=(function(){function x(d){this.stateManager=d}return x.prototype.startTransition=function(d){return this.stateManager.startTransition(d)},x.prototype.directTransition=function(d){this.stateManager.directTransition(d)},x.prototype.getState=function(){return this.stateManager.getState()},x.prototype.canScanFile=function(){return this.stateManager.getState()===We.NOT_STARTED},x.prototype.isScanning=function(){return this.stateManager.getState()!==We.NOT_STARTED},x.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===We.SCANNING},x.prototype.isPaused=function(){return this.stateManager.getState()===We.PAUSED},x})(),Ys=(function(){function x(){}return x.create=function(){return new zs(new Xs)},x})(),js=(function(){var x=function(d,u){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,E){p.__proto__=E}||function(p,E){for(var w in E)Object.prototype.hasOwnProperty.call(E,w)&&(p[w]=E[w])},x(d,u)};return function(d,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");x(d,u);function p(){this.constructor=d}d.prototype=u===null?Object.create(u):(p.prototype=u.prototype,new p)}})(),It=(function(x){js(d,x);function d(){return x!==null&&x.apply(this,arguments)||this}return d.DEFAULT_WIDTH=300,d.DEFAULT_WIDTH_OFFSET=2,d.FILE_SCAN_MIN_HEIGHT=300,d.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,d.MIN_QR_BOX_SIZE=50,d.SHADED_LEFT=1,d.SHADED_RIGHT=2,d.SHADED_TOP=3,d.SHADED_BOTTOM=4,d.SHADED_REGION_ELEMENT_ID="qr-shaded-region",d.VERBOSE=!1,d.BORDER_SHADER_DEFAULT_COLOR="#ffffff",d.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",d})(Is),Zs=(function(){function x(d,u){this.logger=u,this.fps=It.SCAN_DEFAULT_FPS,d?(d.fps&&(this.fps=d.fps),this.disableFlip=d.disableFlip===!0,this.qrbox=d.qrbox,this.aspectRatio=d.aspectRatio,this.videoConstraints=d.videoConstraints):this.disableFlip=It.DEFAULT_DISABLE_FLIP}return x.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Oi.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},x.prototype.isShadedBoxEnabled=function(){return!Gt(this.qrbox)},x.create=function(d,u){return new x(d,u)},x})(),qs=(function(){function x(d,u){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(d))throw"HTML Element with id=".concat(d," not found");this.elementId=d,this.verbose=!1;var p;typeof u=="boolean"?this.verbose=u===!0:u&&(p=u,this.verbose=p.verbose===!0,p.experimentalFeatures),this.logger=new Ss(this.verbose),this.qrcode=new Ms(this.getSupportedFormats(u),this.getUseBarCodeDetectorIfSupported(p),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=Ys.create()}return x.prototype.start=function(d,u,p,E){var w=this;if(!d)throw"cameraIdOrConfig is required";if(!p||typeof p!="function")throw"qrCodeSuccessCallback is required and should be a function.";var N;E?N=E:N=this.verbose?this.logger.log:function(){};var F=Zs.create(u,this.logger);this.clearElement();var k=!1;F.videoConstraints&&(F.isMediaStreamConstraintsValid()?k=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var C=k,P=document.getElementById(this.elementId);P.clientWidth?P.clientWidth:It.DEFAULT_WIDTH,P.style.position="relative",this.shouldScan=!0,this.element=P;var M=this,ae=this.stateManagerProxy.startTransition(We.SCANNING);return new Promise(function(te,xe){var J=C?F.videoConstraints:M.createVideoConstraints(d);if(!J){ae.cancel(),xe("videoConstraints should be defined");return}var q={};(!C||F.aspectRatio)&&(q.aspectRatio=F.aspectRatio);var ct={onRenderSurfaceReady:function(fe,K){M.setupUi(fe,K,F),M.isScanning=!0,M.foreverScan(F,p,N)}};Vs.failIfNotSupported().then(function(fe){fe.create(J).then(function(K){return K.render(w.element,q,ct).then(function(ce){M.renderedCamera=ce,ae.execute(),te(null)}).catch(function(ce){ae.cancel(),xe(ce)})}).catch(function(K){ae.cancel(),xe(pn.errorGettingUserMedia(K))})}).catch(function(fe){ae.cancel(),xe(pn.cameraStreamingNotSupported())})})},x.prototype.pause=function(d){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(We.PAUSED),this.showPausedState(),(Gt(d)||d!==!0)&&(d=!1),d&&this.renderedCamera&&this.renderedCamera.pause()},x.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var d=this,u=function(){d.stateManagerProxy.directTransition(We.SCANNING),d.hidePausedState()};if(!this.renderedCamera.isPaused()){u();return}this.renderedCamera.resume(function(){u()})},x.prototype.getState=function(){return this.stateManagerProxy.getState()},x.prototype.stop=function(){var d=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var u=this.stateManagerProxy.startTransition(We.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var p=function(){if(d.element){var w=document.getElementById(It.SHADED_REGION_ELEMENT_ID);w&&d.element.removeChild(w)}},E=this;return this.renderedCamera.close().then(function(){return E.renderedCamera=null,E.element&&(E.element.removeChild(E.canvasElement),E.canvasElement=null),p(),E.qrRegion&&(E.qrRegion=null),E.context&&(E.context=null),u.execute(),E.hidePausedState(),E.isScanning=!1,Promise.resolve()})},x.prototype.scanFile=function(d,u){return this.scanFileV2(d,u).then(function(p){return p.decodedText})},x.prototype.scanFileV2=function(d,u){var p=this;if(!d||!(d instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Gt(u)&&(u=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(E,w){p.possiblyCloseLastScanImageFile(),p.clearElement(),p.lastScanImageFile=URL.createObjectURL(d);var N=new Image;N.onload=function(){var F=N.width,k=N.height,C=document.getElementById(p.elementId),P=C.clientWidth?C.clientWidth:It.DEFAULT_WIDTH,M=Math.max(C.clientHeight?C.clientHeight:k,It.FILE_SCAN_MIN_HEIGHT),ae=p.computeCanvasDrawConfig(F,k,P,M);if(u){var te=p.createCanvasElement(P,M,"qr-canvas-visible");te.style.display="inline-block",C.appendChild(te);var xe=te.getContext("2d");if(!xe)throw"Unable to get 2d context from canvas";xe.canvas.width=P,xe.canvas.height=M,xe.drawImage(N,0,0,F,k,ae.x,ae.y,ae.width,ae.height)}var J=It.FILE_SCAN_HIDDEN_CANVAS_PADDING,q=Math.max(N.width,ae.width),ct=Math.max(N.height,ae.height),fe=q+2*J,K=ct+2*J,ce=p.createCanvasElement(fe,K);C.appendChild(ce);var st=ce.getContext("2d");if(!st)throw"Unable to get 2d context from canvas";st.canvas.width=fe,st.canvas.height=K,st.drawImage(N,0,0,F,k,J,J,q,ct);try{p.qrcode.decodeRobustlyAsync(ce).then(function(Ce){E(ri.createFromQrcodeResult(Ce))}).catch(w)}catch(Ce){w("QR code parse error, error = ".concat(Ce))}},N.onerror=w,N.onabort=w,N.onstalled=w,N.onsuspend=w,N.src=URL.createObjectURL(d)})},x.prototype.clear=function(){this.clearElement()},x.getCameras=function(){return Ws.retrieve()},x.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},x.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},x.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},x.prototype.applyVideoConstraints=function(d){if(d){if(!Oi.isMediaStreamConstraintsValid(d,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(d)},x.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},x.prototype.getSupportedFormats=function(d){var u=[Y.QR_CODE,Y.AZTEC,Y.CODABAR,Y.CODE_39,Y.CODE_93,Y.CODE_128,Y.DATA_MATRIX,Y.MAXICODE,Y.ITF,Y.EAN_13,Y.EAN_8,Y.PDF_417,Y.RSS_14,Y.RSS_EXPANDED,Y.UPC_A,Y.UPC_E,Y.UPC_EAN_EXTENSION];if(!d||typeof d=="boolean"||!d.formatsToSupport)return u;if(!Array.isArray(d.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(d.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var p=[],E=0,w=d.formatsToSupport;E<w.length;E++){var N=w[E];ys(N)?p.push(N):this.logger.warn("Invalid format: ".concat(N," passed in config, ignoring."))}if(p.length===0)throw"None of formatsToSupport match supported values.";return p},x.prototype.getUseBarCodeDetectorIfSupported=function(d){if(Gt(d))return!0;if(!Gt(d.useBarCodeDetectorIfSupported))return d.useBarCodeDetectorIfSupported!==!1;if(Gt(d.experimentalFeatures))return!0;var u=d.experimentalFeatures;return Gt(u.useBarCodeDetectorIfSupported)?!0:u.useBarCodeDetectorIfSupported!==!1},x.prototype.validateQrboxSize=function(d,u,p){var E=this,w=p.qrbox;this.validateQrboxConfig(w);var N=this.toQrdimensions(d,u,w),F=function(C){if(C<It.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(It.MIN_QR_BOX_SIZE,"px.")},k=function(C){return C>d&&(E.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),C=d),C};F(N.width),F(N.height),N.width=k(N.width)},x.prototype.validateQrboxConfig=function(d){if(typeof d!="number"&&typeof d!="function"&&(d.width===void 0||d.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},x.prototype.toQrdimensions=function(d,u,p){if(typeof p=="number")return{width:p,height:p};if(typeof p=="function")try{return p(d,u)}catch(E){throw new Error("qrbox config was passed as a function but it failed with unknown error"+E)}return p},x.prototype.setupUi=function(d,u,p){p.isShadedBoxEnabled()&&this.validateQrboxSize(d,u,p);var E=Gt(p.qrbox)?{width:d,height:u}:p.qrbox;this.validateQrboxConfig(E);var w=this.toQrdimensions(d,u,E);w.height>u&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var N=p.isShadedBoxEnabled()&&w.height<=u,F={x:0,y:0,width:d,height:u},k=N?this.getShadedRegionBounds(d,u,w):F,C=this.createCanvasElement(k.width,k.height),P={willReadFrequently:!0},M=C.getContext("2d",P);M.canvas.width=k.width,M.canvas.height=k.height,this.element.append(C),N&&this.possiblyInsertShadingElement(this.element,d,u,w),this.createScannerPausedUiElement(this.element),this.qrRegion=k,this.context=M,this.canvasElement=C},x.prototype.createScannerPausedUiElement=function(d){var u=document.createElement("div");u.innerText=pn.scannerPaused(),u.style.display="none",u.style.position="absolute",u.style.top="0px",u.style.zIndex="1",u.style.background="rgba(9, 9, 9, 0.46)",u.style.color="#FFECEC",u.style.textAlign="center",u.style.width="100%",d.appendChild(u),this.scannerPausedUiElement=u},x.prototype.scanContext=function(d,u){var p=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(E){return d(E.text,ri.createFromQrcodeResult(E)),p.possiblyUpdateShaders(!0),!0}).catch(function(E){p.possiblyUpdateShaders(!1);var w=pn.codeParseError(E);return u(w,_s.createFrom(w)),!1})},x.prototype.foreverScan=function(d,u,p){var E=this;if(this.shouldScan&&this.renderedCamera){var w=this.renderedCamera.getSurface(),N=w.videoWidth/w.clientWidth,F=w.videoHeight/w.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var k=this.qrRegion.width*N,C=this.qrRegion.height*F,P=this.qrRegion.x*N,M=this.qrRegion.y*F;this.context.drawImage(w,P,M,k,C,0,0,this.qrRegion.width,this.qrRegion.height);var ae=function(){E.foreverScanTimeout=setTimeout(function(){E.foreverScan(d,u,p)},E.getTimeoutFps(d.fps))};this.scanContext(u,p).then(function(te){!te&&d.disableFlip!==!0?(E.context.translate(E.context.canvas.width,0),E.context.scale(-1,1),E.scanContext(u,p).finally(function(){ae()})):ae()}).catch(function(te){E.logger.logError("Error happend while scanning context",te),ae()})}},x.prototype.createVideoConstraints=function(d){if(typeof d=="string")return{deviceId:{exact:d}};if(typeof d=="object"){var u="facingMode",p="deviceId",E={user:!0,environment:!0},w="exact",N=function(xe){if(xe in E)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(xe,"'")},F=Object.keys(d);if(F.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(F.length," keys");var k=Object.keys(d)[0];if(k!==u&&k!==p)throw"Only '".concat(u,"' and '").concat(p,"' ")+" are supported for 'cameraIdOrConfig'";if(k===u){var C=d.facingMode;if(typeof C=="string"){if(N(C))return{facingMode:C}}else if(typeof C=="object")if(w in C){if(N(C["".concat(w)]))return{facingMode:{exact:C["".concat(w)]}}}else throw"'facingMode' should be string or object with"+" ".concat(w," as key.");else{var P=typeof C;throw"Invalid type of 'facingMode' = ".concat(P)}}else{var M=d.deviceId;if(typeof M=="string")return{deviceId:M};if(typeof M=="object"){if(w in M)return{deviceId:{exact:M["".concat(w)]}};throw"'deviceId' should be string or object with"+" ".concat(w," as key.")}else{var ae=typeof M;throw"Invalid type of 'deviceId' = ".concat(ae)}}}var te=typeof d;throw"Invalid type of 'cameraIdOrConfig' = ".concat(te)},x.prototype.computeCanvasDrawConfig=function(d,u,p,E){if(d<=p&&u<=E){var w=(p-d)/2,N=(E-u)/2;return{x:w,y:N,width:d,height:u}}else{var F=d,k=u;return d>p&&(u=p/d*u,d=p),u>E&&(d=E/u*d,u=E),this.logger.log("Image downsampled from "+"".concat(F,"X").concat(k)+" to ".concat(d,"X").concat(u,".")),this.computeCanvasDrawConfig(d,u,p,E)}},x.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var d=document.getElementById(this.elementId);d&&(d.innerHTML="")},x.prototype.possiblyUpdateShaders=function(d){this.qrMatch!==d&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(u){u.style.backgroundColor=d?It.BORDER_SHADER_MATCH_COLOR:It.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=d)},x.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},x.prototype.createCanvasElement=function(d,u,p){var E=d,w=u,N=document.createElement("canvas");return N.style.width="".concat(E,"px"),N.style.height="".concat(w,"px"),N.style.display="none",N.id=Gt(p)?"qr-canvas":p,N},x.prototype.getShadedRegionBounds=function(d,u,p){if(p.width>d||p.height>u)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(d-p.width)/2,y:(u-p.height)/2,width:p.width,height:p.height}},x.prototype.possiblyInsertShadingElement=function(d,u,p,E){if(!(u-E.width<1||p-E.height<1)){var w=document.createElement("div");w.style.position="absolute";var N=(u-E.width)/2,F=(p-E.height)/2;if(w.style.borderLeft="".concat(N,"px solid rgba(0, 0, 0, 0.48)"),w.style.borderRight="".concat(N,"px solid rgba(0, 0, 0, 0.48)"),w.style.borderTop="".concat(F,"px solid rgba(0, 0, 0, 0.48)"),w.style.borderBottom="".concat(F,"px solid rgba(0, 0, 0, 0.48)"),w.style.boxSizing="border-box",w.style.top="0px",w.style.bottom="0px",w.style.left="0px",w.style.right="0px",w.id="".concat(It.SHADED_REGION_ELEMENT_ID),u-E.width<11||p-E.height<11)this.hasBorderShaders=!1;else{var k=5,C=40;this.insertShaderBorders(w,C,k,-k,null,0,!0),this.insertShaderBorders(w,C,k,-k,null,0,!1),this.insertShaderBorders(w,C,k,null,-k,0,!0),this.insertShaderBorders(w,C,k,null,-k,0,!1),this.insertShaderBorders(w,k,C+k,-k,null,-k,!0),this.insertShaderBorders(w,k,C+k,null,-k,-k,!0),this.insertShaderBorders(w,k,C+k,-k,null,-k,!1),this.insertShaderBorders(w,k,C+k,null,-k,-k,!1),this.hasBorderShaders=!0}d.append(w)}},x.prototype.insertShaderBorders=function(d,u,p,E,w,N,F){var k=document.createElement("div");k.style.position="absolute",k.style.backgroundColor=It.BORDER_SHADER_DEFAULT_COLOR,k.style.width="".concat(u,"px"),k.style.height="".concat(p,"px"),E!==null&&(k.style.top="".concat(E,"px")),w!==null&&(k.style.bottom="".concat(w,"px")),F?k.style.left="".concat(N,"px"):k.style.right="".concat(N,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(k),d.appendChild(k)},x.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},x.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},x.prototype.getTimeoutFps=function(d){return 1e3/d},x})(),fi;(function(x){x[x.STATUS_DEFAULT=0]="STATUS_DEFAULT",x[x.STATUS_SUCCESS=1]="STATUS_SUCCESS",x[x.STATUS_WARNING=2]="STATUS_WARNING",x[x.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(fi||(fi={}));var wr,hi;function vi(){if(hi)return wr;hi=1;function x(d){var u=typeof d;return d!=null&&(u=="object"||u=="function")}return wr=x,wr}var mr,di;function Ks(){if(di)return mr;di=1;var x=typeof Qt=="object"&&Qt&&Qt.Object===Object&&Qt;return mr=x,mr}var Ar,gi;function Di(){if(gi)return Ar;gi=1;var x=Ks(),d=typeof self=="object"&&self&&self.Object===Object&&self,u=x||d||Function("return this")();return Ar=u,Ar}var Cr,xi;function Qs(){if(xi)return Cr;xi=1;var x=Di(),d=function(){return x.Date.now()};return Cr=d,Cr}var pr,wi;function Js(){if(wi)return pr;wi=1;var x=/\s/;function d(u){for(var p=u.length;p--&&x.test(u.charAt(p)););return p}return pr=d,pr}var Er,mi;function $s(){if(mi)return Er;mi=1;var x=Js(),d=/^\s+/;function u(p){return p&&p.slice(0,x(p)+1).replace(d,"")}return Er=u,Er}var br,Ai;function Mi(){if(Ai)return br;Ai=1;var x=Di(),d=x.Symbol;return br=d,br}var yr,Ci;function eo(){if(Ci)return yr;Ci=1;var x=Mi(),d=Object.prototype,u=d.hasOwnProperty,p=d.toString,E=x?x.toStringTag:void 0;function w(N){var F=u.call(N,E),k=N[E];try{N[E]=void 0;var C=!0}catch{}var P=p.call(N);return C&&(F?N[E]=k:delete N[E]),P}return yr=w,yr}var Ir,pi;function to(){if(pi)return Ir;pi=1;var x=Object.prototype,d=x.toString;function u(p){return d.call(p)}return Ir=u,Ir}var _r,Ei;function no(){if(Ei)return _r;Ei=1;var x=Mi(),d=eo(),u=to(),p="[object Null]",E="[object Undefined]",w=x?x.toStringTag:void 0;function N(F){return F==null?F===void 0?E:p:w&&w in Object(F)?d(F):u(F)}return _r=N,_r}var Sr,bi;function ro(){if(bi)return Sr;bi=1;function x(d){return d!=null&&typeof d=="object"}return Sr=x,Sr}var Tr,yi;function io(){if(yi)return Tr;yi=1;var x=no(),d=ro(),u="[object Symbol]";function p(E){return typeof E=="symbol"||d(E)&&x(E)==u}return Tr=p,Tr}var Nr,Ii;function so(){if(Ii)return Nr;Ii=1;var x=$s(),d=vi(),u=io(),p=NaN,E=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,N=/^0o[0-7]+$/i,F=parseInt;function k(C){if(typeof C=="number")return C;if(u(C))return p;if(d(C)){var P=typeof C.valueOf=="function"?C.valueOf():C;C=d(P)?P+"":P}if(typeof C!="string")return C===0?C:+C;C=x(C);var M=w.test(C);return M||N.test(C)?F(C.slice(2),M?2:8):E.test(C)?p:+C}return Nr=k,Nr}var Or,_i;function oo(){if(_i)return Or;_i=1;var x=vi(),d=Qs(),u=so(),p="Expected a function",E=Math.max,w=Math.min;function N(F,k,C){var P,M,ae,te,xe,J,q=0,ct=!1,fe=!1,K=!0;if(typeof F!="function")throw new TypeError(p);k=u(k)||0,x(C)&&(ct=!!C.leading,fe="maxWait"in C,ae=fe?E(u(C.maxWait)||0,k):ae,K="trailing"in C?!!C.trailing:K);function ce(re){var ye=P,v=M;return P=M=void 0,q=re,te=F.apply(v,ye),te}function st(re){return q=re,xe=setTimeout(he,k),ct?ce(re):te}function Ce(re){var ye=re-J,v=re-q,Ie=k-ye;return fe?w(Ie,ae-v):Ie}function U(re){var ye=re-J,v=re-q;return J===void 0||ye>=k||ye<0||fe&&v>=ae}function he(){var re=d();if(U(re))return G(re);xe=setTimeout(he,Ce(re))}function G(re){return xe=void 0,K&&P?ce(re):(P=M=void 0,te)}function bt(){xe!==void 0&&clearTimeout(xe),q=0,P=J=M=xe=void 0}function ze(){return xe===void 0?te:G(d())}function $(){var re=d(),ye=U(re);if(P=arguments,M=this,J=re,ye){if(xe===void 0)return st(J);if(fe)return clearTimeout(xe),xe=setTimeout(he,k),ce(J)}return xe===void 0&&(xe=setTimeout(he,k)),te}return $.cancel=bt,$.flush=ze,$}return Or=N,Or}var ao=oo();const lo=Si(ao);function co(x){const d=Ti(),u="POS_REALTIME_DRAFT_V3",p=lt(""),E=lt("all"),w=lt([]),N=lt(!1),F=lt(5),k=lt(""),C=lt([]),P=lt(!1),M=lt(null),ae=lt(null),te=lt(!1),xe=lt("single"),J=lt(null),q=fs({input_type:"realtime",report_date:new Date().toISOString().slice(0,10),items:[],customer_id:null,payment_amount:0,change_amount:0,payment_method:"cash",discount_type:"fixed",discount_value:0,notes:""});hs(async()=>{N.value=!0;try{const B=await Jr.get(route("sales.products.lite"));w.value=B.data}catch(B){console.error("Gagal load produk:",B),d.error("Gagal memuat database produk")}finally{N.value=!1}const I=localStorage.getItem(u);if(I)try{const B=JSON.parse(I);B.items&&(q.items=B.items),q.payment_amount=B.payment_amount||0,q.payment_method=B.payment_method||"cash",q.notes=B.notes||"",q.discount_type=B.discount_type||"fixed",q.discount_value=B.discount_value||0,B.selectedMember&&(M.value=B.selectedMember,q.customer_id=B.selectedMember.id)}catch{localStorage.removeItem(u)}}),$r([()=>q.items,()=>q.customer_id,()=>q.payment_amount,()=>q.discount_value,()=>q.notes],()=>{localStorage.setItem(u,JSON.stringify({items:q.items,customer_id:q.customer_id,payment_amount:q.payment_amount,payment_method:q.payment_method,notes:q.notes,discount_type:q.discount_type,discount_value:q.discount_value,selectedMember:M.value}))},{deep:!0});const ct=async(I,B="single")=>{ae.value=I,xe.value=B,te.value=!0,await gs();const ee=[Y.CODE_128,Y.EAN_13,Y.QR_CODE],de=new qs("reader");J.value=de,de.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:150},formatsToSupport:ee},gt=>{K(gt)},gt=>{}).catch(gt=>{console.log(gt),ae.value=null,te.value=!1,alert("Gagal membuka kamera. Pastikan izin diberikan.")})},fe=()=>{J.value?J.value.stop().then(()=>{J.value.clear(),ae.value=null,te.value=!1}).catch(I=>console.log(I)):(ae.value=null,te.value=!1)},K=I=>{if(ae.value==="product"){const B=x.products.find(ee=>ee.code==I);B?(Ie(B),xe.value==="single"&&fe()):alert(`Produk ${I} tidak ditemukan!`)}else if(ae.value==="member"){const B=x.customers.find(ee=>ee.member_code==I||ee.phone==I);B?(Ye(B),fe(),alert(`Member: ${B.name}`)):alert(`Member ${I} tidak terdaftar!`)}};ds(()=>{J.value&&J.value.isScanning&&J.value.stop()});const ce=qt(()=>{let I=w.value;if(E.value!=="all"&&(I=I.filter(B=>B.category_id===E.value)),p.value){const B=p.value.toLowerCase();I=I.filter(ee=>ee.name.toLowerCase().includes(B)||ee.code.toLowerCase().includes(B))}return I.slice(0,F.value)}),st=()=>{F.value<w.value.length&&(F.value+=20)},Ce=lo(async I=>{if(!I){C.value=[];return}P.value=!0;try{const B=await Jr.get(route("sales.search-customer"),{params:{query:I}});C.value=B.data}catch(B){console.error(B)}finally{P.value=!1}},300);$r(k,I=>{Ce(I)});const U=qt(()=>q.items.reduce((I,B)=>I+(parseFloat(B.subtotal)||0),0)),he=qt(()=>{const I=parseFloat(q.discount_value)||0;if(I<=0)return 0;if(q.discount_type==="percent"){const B=I>100?100:I;return Math.round(U.value*B/100)}return I>U.value?U.value:I}),G=qt(()=>{const I=U.value-he.value;return I>0?I:0}),bt=qt(()=>(parseFloat(q.payment_amount)||0)-G.value),ze=qt(()=>q.payment_method!=="cash"?!0:(parseFloat(q.payment_amount)||0)>=G.value),$=qt(()=>q.items.some(I=>I.quantity<=0||isNaN(I.quantity))),re=qt(()=>{const I=G.value;if(I<=0)return[];const B=[{label:"Uang Pas",value:I}];if([2e3,5e3,1e4,2e4,5e4,1e5].forEach(de=>{de>I&&!B.find(gt=>gt.value===de)&&B.push({label:D(de),value:de})}),I>5e4){const de=Math.ceil(I/5e4)*5e4;B.find(gt=>gt.value===de)||B.push({label:D(de),value:de})}return B.slice(0,4)}),ye=I=>{q.payment_amount=I.value},v=()=>{q.payment_amount=0},Ie=I=>{if(parseFloat(I.stock)<=0){d.error("Stok habis!");return}const B=q.items.find(ee=>ee.product_id===I.id);if(B){if(B.quantity+1>I.stock){d.warning("Stok maksimal!");return}B.quantity++,Qe(B)}else{const ee=parseFloat(I.selling_price||I.price);q.items.push({product_id:I.id,code:I.code,name:I.name,unit:I.unit,stock_max:parseFloat(I.stock),image:I.image_path,selling_price:ee,original_price:ee,quantity:1,subtotal:ee})}},oe=I=>q.items.splice(I,1),_t=(I,B)=>{const ee=q.items[I],de=parseFloat(ee.quantity)+B;if(de>ee.stock_max){d.warning(`Stok sisa ${ee.stock_max}`);return}if(de<=0){confirm("Hapus item ini?")&&oe(I);return}ee.quantity=de,Qe(ee)},Qe=I=>{I.unit?.is_decimal===1||(I.quantity=Math.round(I.quantity),I.quantity<1&&(I.quantity=1)),I.quantity>I.stock_max&&(I.quantity=I.stock_max,d.warning(`Stok sisa ${I.stock_max}`)),I.subtotal=Math.round(I.quantity*I.selling_price)},ut=I=>{const B=parseFloat(I.subtotal)||0,ee=parseFloat(I.selling_price)||0;if(!(ee<=0))if(I.unit?.is_decimal===1){let de=B/ee;de>I.stock_max&&(de=I.stock_max,I.subtotal=Math.round(de*ee),d.warning("Melebihi sisa stok!")),I.quantity=parseFloat(de.toFixed(4))}else confirm(` Ubah harga satuan agar sesuai total Rp ${D(B)}?`)?I.quantity>0&&(I.selling_price=Math.round(B/I.quantity)):I.subtotal=Math.round(I.quantity*I.selling_price)},an=I=>{I.subtotal=Math.round(I.quantity*I.selling_price)},Ye=I=>{M.value=I,q.customer_id=I.id,C.value=[],k.value=""},et=(I=!1,B={})=>{q.change_amount=bt.value,q.payment_amount=parseFloat(q.payment_amount),q.transform(ee=>({...ee,print_invoice:I})).post(route("sales.pos.store"),{onStart:B.onStart,onFinish:B.onFinish,onSuccess:ee=>{localStorage.removeItem(u),q.reset(),q.items=[],M.value=null,B.onSuccess&&B.onSuccess(ee)},onError:ee=>{console.error(ee),d.error("Gagal memproses transaksi")}})},D=I=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(I);return{form:q,allProducts:w,filteredProducts:ce,isFetchingData:N,startScanner:ct,stopScanner:fe,activeScannerType:ae,scannerType:xe,showScanner:te,searchQuery:p,selectedCategory:E,loadMoreProducts:st,memberSearch:k,memberSearchResults:C,isLoadingMember:P,selectedMember:M,selectMember:Ye,removeMember:()=>{M.value=null,q.customer_id=null},subTotal:U,discountAmount:he,grandTotal:G,changeAmount:bt,isPaymentSufficient:ze,hasInvalidQty:$,moneySuggestions:re,addItem:Ie,removeItem:oe,updateQty:_t,recalcFromQty:Qe,recalcFromSubtotal:ut,recalcFromPrice:an,handleMoneyClick:ye,resetPayment:v,submitTransaction:et,rp:D}}const uo={class:"flex flex-col lg:flex-row h-[100dvh] w-full bg-gray-100 dark:bg-gray-900 overflow-hidden font-sans transition-colors duration-300"},fo={class:"relative flex flex-col flex-1 h-full overflow-hidden"},ho={class:"z-10 flex items-center gap-3 px-4 py-3 bg-white border-b shadow-sm shrink-0 dark:bg-gray-800 dark:border-gray-700"},go={class:"relative flex-1"},xo={key:0,class:"absolute right-11 top-3.5 flex items-center gap-2"},wo={class:"px-4 py-2 overflow-x-auto bg-white border-b shadow-sm shrink-0 dark:bg-gray-800 dark:border-gray-700 whitespace-nowrap scrollbar-hide"},mo=["onClick"],Ao={class:"grid grid-cols-2 gap-3 pb-20 md:grid-cols-3 lg:grid-cols-4"},Co=["onClick"],po={class:"relative w-full overflow-hidden bg-gray-100 aspect-square dark:bg-gray-700"},Eo=["src"],bo={key:1,class:"absolute z-10 top-2 right-2"},yo={class:"bg-gray-900/70 backdrop-blur text-white text-[10px] font-bold px-2 py-1 rounded-lg shadow-sm"},Io={key:2,class:"absolute z-10 top-2 left-2"},_o={class:"bg-red-500 text-white text-[10px] font-bold px-2 py-1 rounded-lg shadow-sm animate-pulse"},So={class:"p-3 flex flex-col h-[85px] justify-between"},To={class:"text-xs font-bold leading-snug text-gray-800 sm:text-sm dark:text-gray-100 line-clamp-2"},No={class:"flex items-end justify-between mt-1"},Oo={class:"flex flex-col"},Ro={class:"text-[13px] sm:text-[15px] font-black text-lime-600 dark:text-lime-400 leading-none"},vo={key:0,class:"py-10 text-center"},Do={key:1,class:"py-10 text-center text-gray-400"},Mo={key:2,class:"py-4 text-center text-[10px] text-gray-400"},Bo={key:0,class:"absolute z-30 lg:hidden bottom-4 left-4 right-4"},ko={class:"flex items-center gap-3"},Po={class:"flex items-center justify-center text-xs font-bold text-white rounded-full shadow-sm bg-lime-500 dark:bg-white dark:text-lime-700 w-7 h-7"},Lo={class:"flex flex-col items-start leading-none gap-0.5"},Fo={class:"text-lg font-bold"},Uo={class:"flex items-center justify-between px-5 py-4 border-b shrink-0 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 lg:bg-white lg:dark:bg-gray-800"},Vo={class:"flex items-center gap-2"},Go={class:"px-5 py-3 bg-white border-b shrink-0 dark:border-gray-700 dark:bg-gray-800"},Ho={key:0,class:"relative"},Wo={key:0,class:"absolute left-0 z-50 w-full mt-2 overflow-hidden bg-white border shadow-xl top-full dark:bg-gray-800 dark:border-gray-600 rounded-xl"},Xo=["onClick"],zo={class:"text-gray-400"},Yo={key:1,class:"flex justify-between bg-lime-50 dark:bg-gray-700 p-2.5 rounded-xl border border-lime-200 dark:border-gray-600"},jo={class:"flex items-center gap-3"},Zo={class:"flex items-center justify-center w-8 h-8 text-xs font-bold text-white rounded-full shadow-sm bg-lime-500"},qo={class:"text-xs font-bold text-gray-800 dark:text-white"},Ko={class:"text-[10px] text-gray-500 dark:text-gray-300 tracking-wide"},Qo={class:"flex-1 px-4 py-2 space-y-3 overflow-y-auto bg-gray-50 custom-scroll dark:bg-gray-900"},Jo={key:0,class:"flex flex-col items-center justify-center h-full text-gray-400 dark:text-gray-600 opacity-70"},$o={class:"flex items-start justify-between p-3 pb-2 border-b border-gray-50 dark:border-gray-700/50"},ea={class:"pr-2"},ta={class:"text-sm font-bold leading-tight text-gray-800 dark:text-gray-100"},na={class:"flex items-center gap-2 mt-1"},ra={class:"text-[10px] font-mono text-gray-400 bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded tracking-wide"},ia={key:0,class:"text-[10px] font-bold text-gray-400"},sa=["onClick"],oa={class:"grid grid-cols-12 gap-0 divide-x divide-gray-100 dark:divide-gray-700 bg-gray-50/50 dark:bg-gray-900/30"},aa={class:"flex flex-col justify-center col-span-4 p-2"},la={class:"relative group/price"},ca=["onUpdate:modelValue","onInput"],ua={class:"flex flex-col items-center justify-center col-span-4 p-2"},fa={class:"flex items-center w-full overflow-hidden bg-white border border-gray-200 rounded-lg shadow-sm h-7 dark:bg-gray-800 dark:border-gray-600"},ha=["onClick"],da=["onUpdate:modelValue","onInput","step"],ga=["onClick"],xa={class:"relative flex flex-col justify-center col-span-4 p-2"},wa=["onUpdate:modelValue","onChange"],ma={key:0,class:"absolute top-2 left-2 text-lime-500",title:"Aman: Ubah nominal, Qty menyesuaikan"},Aa={key:1,class:"absolute transition-opacity opacity-0 pointer-events-none top-9 right-2 group-hover:opacity-100"},Ca={class:"shrink-0 bg-white dark:bg-gray-800 border-t dark:border-gray-700 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-20 relative"},pa={class:"absolute left-0 z-10 flex justify-center w-full -top-3"},Ea={class:"px-5 pt-3 pb-5"},ba={class:"mb-4 space-y-4 animate-fade-in-down"},ya={class:"grid grid-cols-2 gap-4"},Ia={class:"flex flex-col gap-1.5"},_a=["onClick"],Sa={key:0},Ta={key:1},Na={key:2},Oa={class:"flex mb-2"},Ra={class:"relative"},va={class:"flex gap-2 pb-1 overflow-x-auto scrollbar-hide"},Da=["onClick"],Ma={class:"flex flex-col gap-3"},Ba={class:"flex items-end justify-between p-4 border border-gray-100 bg-gray-50 dark:bg-gray-900/50 rounded-2xl dark:border-gray-700"},ka={class:"flex flex-col"},Pa={class:"flex items-baseline gap-2"},La={class:"text-3xl font-black leading-none tracking-tight text-gray-800 dark:text-white"},Fa={key:0,class:"text-[10px] font-bold text-white bg-green-500 px-1.5 py-0.5 rounded-md animate-pulse"},Ua={key:0,class:"text-[10px] text-gray-400 mt-1"},Va={class:"line-through"},Ga={class:"w-40"},Ha={class:"text-[10px] font-bold text-right text-gray-400 uppercase block mb-1"},Wa={class:"relative"},Xa={class:"flex items-center gap-3"},za=["disabled"],Ya={key:0},ja={key:1},$a={__name:"index",props:{categories:Array,customers:Array},setup(x){const d=x,{form:u,filteredProducts:p,isFetchingData:E,searchQuery:w,selectedCategory:N,loadMoreProducts:F,startScanner:k,stopScanner:C,activeScannerType:P,showScanner:M,memberSearch:ae,memberSearchResults:te,selectedMember:xe,selectMember:J,addItem:q,removeItem:ct,updateQty:fe,subTotal:K,discountAmount:ce,grandTotal:st,changeAmount:Ce,isPaymentSufficient:U,hasInvalidQty:he,moneySuggestions:G,recalcFromQty:bt,recalcFromSubtotal:ze,recalcFromPrice:$,handleMoneyClick:re,resetPayment:ye,submitTransaction:v,rp:Ie}=co(d),oe=Ti(),_t=lt(!1),Qe=lt(!1),ut=lt(!1),an=et=>{const{scrollTop:D,clientHeight:I,scrollHeight:B}=et.target;D+I>=B-50&&F()},Ye=et=>{if(u.items.length===0)return oe.error("Keranjang kosong!");if(he.value)return oe.error("Qty tidak valid!");if(u.payment_method==="cash"&&!U.value)return oe.error("Uang kurang!");v(et,{onSuccess:D=>{ut.value=!1,_t.value=!1;const I=D.props.flash?.print_url;et&&I?setTimeout(()=>{window.open(I,"_blank","width=300,height=600")},50):et&&!I&&alert("Gagal mendapatkan URL Print dari server.")}})};return(et,D)=>(me(),we(on,null,[Dn(X(xs),{title:"Kasir POS"}),Dn(ps,{showConfirmModal:ut.value,changeAmount:X(Ce),onClose:D[0]||(D[0]=I=>ut.value=!1),onConfirmTransaction:Ye},null,8,["showConfirmModal","changeAmount"]),Dn(Es,{showScanner:X(M),activeScannerType:X(P),onClose:D[1]||(D[1]=I=>M.value=!1),onStopScanner:X(C)},null,8,["showScanner","activeScannerType","onStopScanner"]),T("div",uo,[T("div",fo,[T("div",ho,[Dn(X(ms),{href:et.route("dashboard"),class:"p-2 rounded-lg bg-lime-50 dark:bg-gray-700 text-lime-700 dark:text-lime-400"},{default:ws(()=>[...D[22]||(D[22]=[T("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1},8,["href"]),T("div",go,[Kt(T("input",{"onUpdate:modelValue":D[2]||(D[2]=I=>ei(w)?w.value=I:null),type:"text",placeholder:"Cari Nama / Kode...",class:"w-full pl-9 pr-10 py-2.5 bg-gray-100 dark:bg-gray-900 border-none rounded-xl focus:ring-2 focus:ring-lime-500 text-sm dark:text-white transition-all shadow-inner"},null,512),[[sn,X(w)]]),D[25]||(D[25]=T("span",{class:"absolute text-gray-400 left-3 top-3"},"",-1)),X(E)?(me(),we("div",xo,[...D[23]||(D[23]=[T("span",{class:"text-[10px] text-gray-400 italic"},"Syncing...",-1),T("span",{class:"relative flex w-2 h-2"},[T("span",{class:"absolute inline-flex w-full h-full rounded-full opacity-75 animate-ping bg-lime-400"}),T("span",{class:"relative inline-flex w-2 h-2 rounded-full bg-lime-500"})],-1)])])):Et("",!0),T("button",{onClick:D[3]||(D[3]=I=>X(k)("product")),class:"absolute right-1.5 top-1.5 p-1 bg-white dark:bg-gray-700 rounded-lg shadow-sm text-gray-600 dark:text-gray-200 hover:text-lime-600 hover:bg-lime-50 transition border border-gray-200 dark:border-gray-600",title:"Scan Produk"},[...D[24]||(D[24]=[T("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])])])]),T("div",wo,[T("button",{onClick:D[4]||(D[4]=I=>N.value="all"),class:dt([X(N)==="all"?"bg-lime-500 text-white shadow-lime-500/40":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 border border-gray-200 dark:border-gray-600","px-5 py-2 mr-2 text-xs font-bold transition-all rounded-full active:scale-95"])}," Semua ",2),(me(!0),we(on,null,An(x.categories,I=>(me(),we("button",{key:I.id,onClick:B=>N.value=I.id,class:dt([X(N)===I.id?"bg-lime-500 text-white shadow-lime-500/40":"bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 border border-gray-200 dark:border-gray-600","px-5 py-2 mr-2 text-xs font-bold transition-all rounded-full active:scale-95"])},Pe(I.name),11,mo))),128))]),T("div",{class:"h-[calc(100vh-220px)] flex-1 p-4 overflow-y-auto bg-gray-100 custom-scroll pb-28 lg:pb-4 dark:bg-gray-900",onScroll:an},[T("div",Ao,[(me(!0),we(on,null,An(X(p),I=>(me(),we("div",{key:I.id,onClick:B=>X(q)(I),class:"relative overflow-hidden transition-all bg-white border border-gray-200 shadow-sm cursor-pointer group dark:bg-gray-800 rounded-xl dark:border-gray-700 hover:shadow-md hover:border-lime-500 active:scale-95"},[T("div",po,[I.image_path?(me(),we("img",{key:0,src:I.image_url,loading:"lazy",decoding:"async",alt:"",class:"object-cover w-full h-full transition-opacity duration-500 opacity-0",onload:"this.classList.remove('opacity-0')"},null,8,Eo)):Et("",!0),D[26]||(D[26]=T("div",{class:"absolute inset-0 flex flex-col items-center justify-center text-gray-300 dark:text-gray-600 -z-10"},[T("svg",{class:"w-8 h-8 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})]),T("span",{class:"text-[9px] font-bold mt-1 opacity-50"},"NO IMG")],-1)),I.unit?(me(),we("div",bo,[T("span",yo,Pe(I.unit.name),1)])):Et("",!0),I.stock<=5?(me(),we("div",Io,[T("span",_o," Sisa "+Pe(parseFloat(I.stock)),1)])):Et("",!0),D[27]||(D[27]=T("div",{class:"absolute inset-0 z-20 flex items-center justify-center transition-opacity opacity-0 bg-lime-500/20 group-hover:opacity-100"},[T("div",{class:"p-2 text-white transition-transform duration-300 scale-0 rounded-full shadow-lg bg-lime-500 group-hover:scale-110"},[T("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])])],-1))]),T("div",So,[T("h3",To,Pe(I.name),1),T("div",No,[T("div",Oo,[T("span",Ro,Pe(X(Ie)(I.selling_price||I.price)),1)]),D[28]||(D[28]=T("div",{class:"text-gray-300 transition-colors group-hover:text-lime-500"},[T("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})])],-1))])])],8,Co))),128))]),X(E)&&X(p).length===0?(me(),we("div",vo,[...D[29]||(D[29]=[T("div",{class:"w-8 h-8 mx-auto mb-2 border-b-2 rounded-full animate-spin border-lime-500"},null,-1),T("span",{class:"text-xs text-gray-400"},"Memuat database produk...",-1)])])):X(p).length===0?(me(),we("div",Do,[...D[30]||(D[30]=[T("span",{class:"block mb-2 text-2xl"},"",-1),Cn(" Produk tidak ditemukan ",-1)])])):Et("",!0),X(p).length>0&&X(p).length%20===0?(me(),we("div",Mo," Scroll untuk memuat lebih banyak... ")):Et("",!0)],32),X(u).items.length>0?(me(),we("div",Bo,[T("button",{onClick:D[5]||(D[5]=I=>_t.value=!0),class:"w-full bg-gray-900 dark:bg-lime-600 text-white p-3.5 rounded-2xl shadow-xl shadow-gray-900/20 flex justify-between items-center animate-bounce-subtle"},[T("div",ko,[T("span",Po,Pe(X(u).items.reduce((I,B)=>I+parseFloat(B.quantity),0)),1),T("div",Lo,[D[31]||(D[31]=T("span",{class:"text-[9px] text-gray-400 dark:text-lime-100 uppercase font-bold tracking-wider"},"Total Belanja",-1)),T("span",Fo,Pe(X(Ie)(X(st))),1)])]),D[32]||(D[32]=T("span",{class:"flex items-center gap-1 px-4 py-2 text-xs font-bold bg-gray-700 dark:bg-lime-800/30 rounded-xl"},[Cn(" Bayar "),T("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})])],-1))])])):Et("",!0)]),T("div",{class:dt(["lg:static lg:w-[420px] lg:border-l lg:border-gray-200 dark:lg:border-gray-700","fixed inset-0 z-40 bg-white dark:bg-gray-800 transition-transform duration-300 ease-in-out flex flex-col h-full",_t.value?"translate-y-0":"translate-y-full lg:translate-y-0"])},[T("div",Uo,[T("div",Vo,[D[33]||(D[33]=T("h2",{class:"text-lg font-black text-gray-800 dark:text-white"},[T("span",{class:"text-lime-500"},""),Cn(" Keranjang ")],-1)),X(u).items.length?(me(),we("button",{key:0,onClick:D[6]||(D[6]=I=>X(u).items=[]),class:"text-[10px] text-red-500 font-bold bg-red-50 px-2 py-1 rounded ml-2 hover:bg-red-100 transition"}," Reset ")):Et("",!0)]),T("button",{onClick:D[7]||(D[7]=I=>_t.value=!1),class:"p-2 text-gray-500 bg-gray-100 rounded-full lg:hidden dark:bg-gray-700"},[...D[34]||(D[34]=[T("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),T("div",Go,[X(xe)?(me(),we("div",Yo,[T("div",jo,[T("div",Zo,Pe(X(xe).name[0]),1),T("div",null,[T("div",qo,Pe(X(xe).name),1),T("div",Ko,Pe(X(xe).member_code),1)])]),T("button",{onClick:D[10]||(D[10]=I=>X(J)(null)),class:"p-1 text-gray-400 hover:text-red-500"},[...D[36]||(D[36]=[T("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):(me(),we("div",Ho,[Kt(T("input",{"onUpdate:modelValue":D[8]||(D[8]=I=>ei(ae)?ae.value=I:null),type:"text",placeholder:"Cari / Scan Member...",class:"w-full text-xs border border-gray-200 dark:border-gray-600 rounded-xl p-2.5 pr-10 bg-gray-50 dark:bg-gray-900 dark:text-white focus:ring-lime-500 transition"},null,512),[[sn,X(ae)]]),T("button",{onClick:D[9]||(D[9]=I=>X(k)("member")),class:"absolute right-1.5 top-1.5 p-1 bg-white dark:bg-gray-700 rounded-lg shadow-sm text-gray-500 dark:text-gray-300 hover:text-lime-600 border border-gray-200 dark:border-gray-600",title:"Scan Kartu Member"},[...D[35]||(D[35]=[T("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])]),X(te).length?(me(),we("div",Wo,[(me(!0),we(on,null,An(X(te),I=>(me(),we("div",{key:I.id,onClick:B=>X(J)(I),class:"p-3 text-xs text-gray-800 border-b cursor-pointer hover:bg-lime-50 dark:hover:bg-gray-700 dark:border-gray-700 dark:text-gray-200 last:border-0"},[T("b",null,Pe(I.name),1),T("span",zo,"("+Pe(I.phone)+")",1)],8,Xo))),128))])):Et("",!0)]))]),T("div",Qo,[X(u).items.length===0?(me(),we("div",Jo,[...D[37]||(D[37]=[T("div",{class:"p-6 mb-4 bg-white rounded-full shadow-sm dark:bg-gray-800"},[T("span",{class:"text-5xl"},"")],-1),T("span",{class:"text-sm font-bold tracking-wide uppercase"},"Keranjang Kosong",-1),T("span",{class:"mt-1 text-xs font-normal"},"Scan barcode atau cari produk...",-1)])])):Et("",!0),(me(!0),we(on,null,An(X(u).items,(I,B)=>(me(),we("div",{key:B,class:"relative overflow-hidden transition-colors duration-200 bg-white border border-gray-100 shadow-sm dark:bg-gray-800 rounded-xl dark:border-gray-700 group hover:border-lime-300"},[T("div",$o,[T("div",ea,[T("h4",ta,Pe(I.name),1),T("div",na,[T("span",ra,Pe(I.code),1),I.unit?(me(),we("span",ia," / "+Pe(I.unit.name),1)):Et("",!0),T("span",{class:dt(["text-[10px] font-bold",I.stock_max<=5?"text-red-500":"text-green-500"])},"( Stok : "+Pe(I.stock_max)+" )",3)])]),T("button",{onClick:ee=>X(ct)(B),class:"text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg p-1.5 transition"},[...D[38]||(D[38]=[T("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,sa)]),T("div",oa,[T("div",aa,[D[40]||(D[40]=T("label",{class:"text-[9px] font-bold text-gray-400 uppercase mb-0.5 ml-1"},"Harga @",-1)),T("div",la,[Kt(T("input",{type:"number","onUpdate:modelValue":ee=>I.selling_price=ee,onInput:ee=>X($)(I),class:"w-full py-1 pl-2 pr-1 text-xs font-bold text-gray-600 bg-transparent border-none rounded focus:ring-1 focus:ring-lime-500 dark:text-gray-300 tabular-nums",onFocus:D[11]||(D[11]=ee=>ee.target.select())},null,40,ca),[[sn,I.selling_price]]),D[39]||(D[39]=T("div",{class:"absolute right-1 top-1.5 opacity-0 group-hover/price:opacity-100 transition-opacity"},[T("svg",{class:"w-3 h-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})])],-1))])]),T("div",ua,[D[41]||(D[41]=T("label",{class:"text-[9px] font-bold text-gray-400 uppercase mb-0.5"},"Qty",-1)),T("div",fa,[T("button",{onClick:ee=>X(fe)(B,-1),class:"flex items-center justify-center w-8 h-full text-gray-400 transition hover:text-red-500 hover:bg-red-50 active:scale-95"}," - ",8,ha),Kt(T("input",{type:"number","onUpdate:modelValue":ee=>I.quantity=ee,onInput:ee=>X(bt)(I),step:I.unit?.is_decimal?"0.001":"1",class:"z-10 w-full h-full p-0 text-xs font-black text-center text-gray-800 border-none focus:ring-0 dark:text-white tabular-nums",onFocus:D[12]||(D[12]=ee=>ee.target.select())},null,40,da),[[sn,I.quantity]]),T("button",{onClick:ee=>X(fe)(B,1),class:"flex items-center justify-center w-8 h-full text-gray-400 transition hover:text-lime-600 hover:bg-lime-50 active:scale-95"}," + ",8,ga)])]),T("div",xa,[D[44]||(D[44]=T("label",{class:"text-[9px] font-bold text-gray-400 uppercase mb-0.5 text-right mr-1"},"Subtotal",-1)),Kt(T("input",{type:"number","onUpdate:modelValue":ee=>I.subtotal=ee,onChange:ee=>X(ze)(I),class:dt(["w-full px-2 py-1 text-xs font-black text-right transition-all border rounded focus:ring-2 focus:ring-lime-500 tabular-nums",[I.unit?.is_decimal?"bg-lime-50 border-lime-200 text-lime-700 placeholder-lime-300 dark:bg-lime-900/20 dark:border-lime-800 dark:text-lime-400":"bg-white border-gray-200 text-gray-800 focus:bg-yellow-50 focus:border-yellow-400 dark:bg-gray-700 dark:border-gray-600 dark:text-white"]]),onFocus:D[13]||(D[13]=ee=>ee.target.select())},null,42,wa),[[sn,I.subtotal]]),I.unit?.is_decimal?(me(),we("div",ma,[...D[42]||(D[42]=[T("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])])):(me(),we("div",Aa,[...D[43]||(D[43]=[T("span",{class:"text-[8px] bg-yellow-100 text-yellow-800 px-1 rounded border border-yellow-200 shadow-sm"},"  Ubah = Ganti Harga ",-1)])]))])])]))),128))]),T("div",Ca,[T("div",pa,[T("button",{onClick:D[14]||(D[14]=I=>Qe.value=!Qe.value),class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-full px-4 py-0.5 text-[10px] font-bold text-gray-400 uppercase tracking-widest hover:text-lime-600 hover:border-lime-500 shadow-sm transition-all flex items-center gap-1"},[Cn(Pe(Qe.value?"Tutup":"Opsi")+" ",1),(me(),we("svg",{class:dt([{"rotate-180":Qe.value},"w-3 h-3 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...D[45]||(D[45]=[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])]),T("div",Ea,[Kt(T("div",ba,[T("div",ya,[T("div",null,[D[46]||(D[46]=T("label",{class:"text-[10px] font-bold text-gray-400 uppercase mb-1.5 block"},"Pembayaran",-1)),T("div",Ia,[(me(),we(on,null,An(["cash","transfer","qris"],I=>T("button",{key:I,onClick:B=>X(u).payment_method=I,class:dt([X(u).payment_method===I?"bg-lime-100 text-lime-700 border-lime-300 font-bold":"bg-gray-50 text-gray-500 border-gray-100 hover:bg-gray-100","px-3 py-1.5 rounded-lg text-xs uppercase border transition-all flex items-center gap-2"])},[I==="cash"?(me(),we("span",Sa,"")):I==="transfer"?(me(),we("span",Ta,"")):(me(),we("span",Na,"")),Cn(" "+Pe(I),1)],10,_a)),64))])]),T("div",null,[D[47]||(D[47]=T("label",{class:"text-[10px] font-bold text-gray-400 uppercase mb-1.5 block"},"Diskon Global",-1)),T("div",Oa,[T("button",{onClick:D[15]||(D[15]=I=>X(u).discount_type="fixed"),class:dt([X(u).discount_type==="fixed"?"bg-lime-500 text-white":"bg-gray-100 text-gray-500","px-2 py-1 text-xs font-bold border border-r-0 border-gray-200 rounded-l-lg dark:border-gray-600"])}," Rp ",2),T("button",{onClick:D[16]||(D[16]=I=>X(u).discount_type="percent"),class:dt([X(u).discount_type==="percent"?"bg-lime-500 text-white":"bg-gray-100 text-gray-500","px-2 py-1 text-xs font-bold border border-l-0 border-gray-200 rounded-r-lg dark:border-gray-600"])}," % ",2),Kt(T("input",{"onUpdate:modelValue":D[17]||(D[17]=I=>X(u).discount_value=I),type:"number",placeholder:"0",class:"w-full px-2 py-1 ml-2 text-sm font-bold bg-white border border-gray-200 rounded-lg focus:ring-lime-500"},null,512),[[sn,X(u).discount_value]])])])]),T("div",null,[T("div",Ra,[Kt(T("input",{"onUpdate:modelValue":D[18]||(D[18]=I=>X(u).notes=I),type:"text",placeholder:"Catatan transaksi (opsional)...",class:"w-full py-2 pl-8 pr-3 text-xs transition-colors border border-gray-200 rounded-lg bg-gray-50 focus:bg-white focus:ring-lime-500"},null,512),[[sn,X(u).notes]]),D[48]||(D[48]=T("span",{class:"absolute left-2.5 top-2 text-gray-400"},"",-1))])]),T("div",null,[T("div",va,[T("button",{onClick:D[19]||(D[19]=(...I)=>X(ye)&&X(ye)(...I)),class:"px-3 py-1.5 bg-red-50 text-red-500 border border-red-100 rounded-lg text-xs font-bold whitespace-nowrap active:scale-95"}," Reset "),(me(!0),we(on,null,An(X(G),I=>(me(),we("button",{key:I.label,onClick:B=>X(re)(I),class:"px-3 py-1.5 bg-white border border-gray-200 text-gray-600 rounded-lg text-xs font-bold whitespace-nowrap shadow-sm hover:border-lime-500 hover:text-lime-600 active:scale-95 transition"},Pe(I.label),9,Da))),128))])])],512),[[As,Qe.value]]),T("div",Ma,[T("div",Ba,[T("div",ka,[D[50]||(D[50]=T("span",{class:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Total Tagihan",-1)),T("div",Pa,[T("span",La,Pe(X(Ie)(X(st))),1),X(ce)>0?(me(),we("span",Fa," Hemat "+Pe(X(Ie)(X(ce))),1)):Et("",!0)]),X(K)!==X(st)?(me(),we("span",Ua,[D[49]||(D[49]=Cn(" Subtotal: ",-1)),T("span",Va,Pe(X(Ie)(X(K))),1)])):Et("",!0)]),T("div",Ga,[T("label",Ha," Bayar ("+Pe(X(u).payment_method)+") ",1),T("div",Wa,[Dn(Cs,{modelValue:X(u).payment_amount,"onUpdate:modelValue":D[20]||(D[20]=I=>X(u).payment_amount=I),placeholder:"0",class:dt(["w-full p-0 text-2xl font-black text-right placeholder-gray-300 transition-colors bg-transparent border-none focus:ring-0",X(U)?"text-lime-600 dark:text-lime-400":"text-red-500"])},null,8,["modelValue","class"]),T("div",{class:dt(["w-full h-1 mt-1 transition-colors rounded-full",X(U)?"bg-lime-500":"bg-red-200"])},null,2)])])]),T("div",Xa,[X(u).payment_amount>0?(me(),we("div",{key:0,class:dt(["flex items-center justify-between flex-1 px-4 py-2 transition-colors border rounded-xl",X(U)?"bg-lime-50 border-lime-200":"bg-red-50 border-red-200"])},[T("span",{class:dt(["text-xs font-bold uppercase",X(U)?"text-lime-700":"text-red-500"])},Pe(X(U)?"Kembalian":"Kurang"),3),T("span",{class:dt(["text-lg font-black",X(U)?"text-lime-700":"text-red-600"])},Pe(X(Ie)(Math.abs(X(Ce)))),3)],2)):Et("",!0),T("button",{onClick:D[21]||(D[21]=I=>ut.value=!0),disabled:!X(u).items.length,class:dt([[X(u).items.length?!X(U)&&X(u).payment_method==="cash"?"bg-gray-800 text-white cursor-not-allowed opacity-80":"bg-lime-500 hover:bg-lime-600 shadow-lg shadow-lime-500/40":"opacity-50 cursor-not-allowed bg-gray-300"],"flex-1 py-3.5 text-white font-bold rounded-xl text-sm transition-all active:scale-95 flex justify-center items-center gap-2 group h-[58px]"])},[!X(U)&&X(u).payment_method==="cash"?(me(),we("span",Ya,"UANG KURANG")):(me(),we("span",ja,"PROSES")),D[51]||(D[51]=T("svg",{class:"w-5 h-5 transition group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[T("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})],-1))],10,za)])])])])],2)])],64))}};export{$a as default};
