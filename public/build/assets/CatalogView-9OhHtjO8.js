import{v as s,D as R,K as A,x as E,l as o,o as r,f as l,z as k,p as S,A as G,g as N,n as I,k as P,F as b,I as m,t as V,L as B,y as J,d as Q,a as W}from"./vendor-core-B46KUNyc.js";import{j as X}from"./vendor-common-GpUWqhKr.js";import Y from"./CatalogCard-DujJjNJL.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-charts-Bw6UNgWf.js";const ee={class:"flex flex-col h-full bg-gray-50 dark:bg-gray-900"},ae={class:"sticky top-0 z-20 bg-white border-b shadow-sm dark:bg-gray-800 dark:border-gray-700"},le={class:"pb-2 px-4 py-3 flex items-center gap-3"},re={class:"relative flex-1"},te={key:0,class:"absolute right-3 top-3"},oe={class:"flex flex-col gap-3 px-4 pb-3"},se={class:"flex items-center gap-2 overflow-x-auto md:overflow-visible md:flex-wrap no-scrollbar scroll-smooth pb-1"},ne=["onClick"],ie={class:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2"},de=["value"],ue=["value"],ge=["value"],ve={class:"flex-1 py-3 overflow-y-auto md:p-3 custom-scrollbar"},pe={key:0,class:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4"},ce={key:1,class:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"},ye={key:2,class:"flex flex-col items-center justify-center py-10 text-gray-400"},be={key:3,class:"flex justify-center py-4"},me={__name:"CatalogView",props:{supplierId:{type:[Number,String],required:!0},items:Object,stagingItem:Object,categories:Array,brands:Array},emits:["select-product"],setup(H,{emit:$}){const d=H,L=$,u=s([]),f=s(!1),x=s(!1),z=s(1),w=s(!0),c=s(""),M=s(null),n=s("all"),g=s("all"),y=s("all"),v=s("all"),i=s(""),U=s([]),j=s([]),h=s([]),_=s([]);R(()=>{if(n.value==="all")return[];const t=d.categories.find(e=>e.id==n.value);return t?t.product_types||[]:[]});const C=async(t=!1)=>{if(d.supplierId){t?(f.value=!0,z.value=1,u.value=[],w.value=!0):x.value=!0;try{const a=(await W.get(`/purchases/products/${d.supplierId}`,{params:{page:z.value,search:c.value,category_id:n.value==="all"?null:n.value,product_type_id:g.value==="all"?null:g.value,brand_id:y.value==="all"?null:y.value,size_id:v.value==="all"?null:v.value,stock_status:i.value||null}})).data,T=a.products.data;a.available_brands&&(j.value=a.available_brands),a.available_sizes&&(h.value=a.available_sizes),t?u.value=T:u.value=[...u.value,...T],w.value=!!a.products.next_page_url,w.value&&z.value++}catch(e){console.error("Gagal load katalog:",e)}finally{f.value=!1,x.value=!1}}},p=()=>{c.value&&(c.value=""),C(!0)},q=X(()=>{C(!0)},500),D=()=>{c.value="",n.value="all",g.value="all",y.value="all",v.value="all",i.value="",U.value=d.categories||[],j.value=d.brands||[],_.value=[],h.value=[]};A(n,t=>{t==="all"&&(_.value=[]),g.value="all",v.value="all"}),A(y,()=>{g.value="all",v.value="all"});const K=t=>{t[0].isIntersecting&&w.value&&!f.value&&!x.value&&C(!1)};E(()=>{const t=new IntersectionObserver(K,{threshold:.1});M.value&&t.observe(M.value)}),A(()=>d.supplierId,t=>{t?(D(),C(!0)):u.value=[]},{immediate:!0});const F=t=>d.items.find(e=>e.product_id===t),O=t=>{L("select-product",t)};return(t,e)=>(r(),o("div",ee,[l("div",ae,[l("div",le,[l("div",re,[k(l("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),onInput:e[1]||(e[1]=(...a)=>N(q)&&N(q)(...a)),onFocus:e[2]||(e[2]=a=>a.target.select()),type:"search",placeholder:"Cari produk...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-100 dark:bg-gray-800 border-none rounded-xl focus:ring-2 focus:ring-lime-500 text-sm font-medium text-gray-800 dark:text-white placeholder-gray-400 transition-all"},null,544),[[G,c.value]]),e[10]||(e[10]=l("span",{class:"absolute left-3.5 top-2.5 text-gray-400"},[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),f.value?(r(),o("div",te,[...e[9]||(e[9]=[l("span",{class:"relative flex h-3 w-3"},[l("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-lime-400 opacity-75"}),l("span",{class:"relative inline-flex rounded-full h-3 w-3 bg-lime-500"})],-1)])])):S("",!0)])]),l("div",oe,[l("div",se,[l("button",{onClick:e[3]||(e[3]=a=>{i.value=i.value==="low_empty"?"":"low_empty",p()}),class:I(["px-3 py-1.5 text-xs font-bold rounded-full border transition-all whitespace-nowrap flex items-center gap-1 shrink-0 shadow-sm",i.value==="low_empty"?"bg-red-50 text-red-600 border-red-200 dark:bg-red-900/40 dark:text-red-400 dark:border-red-800":"bg-white border-gray-200 text-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"])},[...e[11]||(e[11]=[l("span",null,"ðŸš¨",-1),P(" Butuh Restok ",-1)])],2),e[12]||(e[12]=l("div",{class:"w-px h-5 bg-gray-300 dark:bg-gray-600 shrink-0 mx-1"},null,-1)),l("button",{onClick:e[4]||(e[4]=a=>{n.value="all",p()}),class:I(["px-3 py-1.5 text-xs font-bold rounded-full transition-all whitespace-nowrap shrink-0 border shadow-sm",n.value==="all"?"bg-gray-800 text-white border-gray-800 dark:bg-gray-100 dark:text-gray-900 border-transparent":"bg-white text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"])}," Semua Kategori ",2),(r(!0),o(b,null,m(U.value,a=>(r(),o("button",{key:a.id,onClick:T=>{n.value=a.id,p()},class:I(["px-3 py-1.5 text-xs font-bold rounded-full transition-all whitespace-nowrap shrink-0 border shadow-sm",n.value===a.id?"bg-gray-800 text-white border-gray-800 dark:bg-gray-100 dark:text-gray-900 border-transparent":"bg-white text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"])},V(a.name),11,ne))),128))]),l("div",ie,[k(l("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>y.value=a),onChange:p,class:"w-full text-xs font-medium py-1.5 px-2 bg-white border border-gray-200 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white transition-all shadow-sm"},[e[13]||(e[13]=l("option",{value:"all"},"Semua Brand",-1)),(r(!0),o(b,null,m(j.value,a=>(r(),o("option",{key:a.id,value:a.id},V(a.name),9,de))),128))],544),[[B,y.value]]),n.value!=="all"&&_.value.length>0?k((r(),o("select",{key:0,"onUpdate:modelValue":e[6]||(e[6]=a=>g.value=a),onChange:p,class:"w-full text-xs font-medium py-1.5 px-2 bg-white border border-gray-200 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white transition-all shadow-sm"},[e[14]||(e[14]=l("option",{value:"all"},"Semua Tipe",-1)),(r(!0),o(b,null,m(_.value,a=>(r(),o("option",{key:a.id,value:a.id},V(a.name),9,ue))),128))],544)),[[B,g.value]]):S("",!0),h.value.length>0?k((r(),o("select",{key:1,"onUpdate:modelValue":e[7]||(e[7]=a=>v.value=a),onChange:p,class:"w-full text-xs font-medium py-1.5 px-2 bg-white border border-gray-200 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white transition-all shadow-sm"},[e[15]||(e[15]=l("option",{value:"all"},"Semua Ukuran",-1)),(r(!0),o(b,null,m(h.value,a=>(r(),o("option",{key:a.id,value:a.id},V(a.name),9,ge))),128))],544)),[[B,v.value]]):S("",!0),k(l("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>i.value=a),onChange:p,class:I(["w-full text-xs font-medium py-1.5 px-2 bg-white border border-gray-200 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white transition-all shadow-sm",{"border-red-500 ring-1 ring-red-500":i.value==="low_empty"}])},[...e[16]||(e[16]=[J('<option value="" data-v-55bf78c3>Status Stok (Semua)</option><option value="empty" data-v-55bf78c3>Habis (0)</option><option value="low" data-v-55bf78c3>Menipis (â‰¤ Min)</option><option value="safe" data-v-55bf78c3>Aman</option><option value="low_empty" data-v-55bf78c3>Butuh Restok (Habis/Menipis)</option>',5)])],34),[[B,i.value]])])])]),l("div",ve,[f.value?(r(),o("div",pe,[(r(),o(b,null,m(8,a=>l("div",{key:a,class:"flex flex-col p-2 bg-white rounded-lg shadow dark:bg-gray-800 animate-pulse"},[...e[17]||(e[17]=[l("div",{class:"w-full mb-2 bg-gray-200 rounded aspect-square dark:bg-gray-700"},null,-1),l("div",{class:"w-3/4 h-4 mb-2 bg-gray-200 rounded dark:bg-gray-700"},null,-1),l("div",{class:"w-1/2 h-3 mt-auto bg-gray-200 rounded dark:bg-gray-700"},null,-1)])])),64))])):u.value.length>0?(r(),o("div",ce,[(r(!0),o(b,null,m(u.value,a=>(r(),Q(Y,{key:a.id,item:a,"is-selected":H.stagingItem.product_id===a.id,"is-in-cart":!!F(a.id),"cart-qty":F(a.id)?.quantity||0,onSelect:O},null,8,["item","is-selected","is-in-cart","cart-qty"]))),128))])):(r(),o("div",ye,[...e[18]||(e[18]=[l("svg",{class:"w-12 h-12 mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),l("p",{class:"text-sm"},"Tidak ada produk ditemukan",-1)])])),x.value?(r(),o("div",be,[...e[19]||(e[19]=[l("svg",{class:"w-5 h-5 text-blue-500 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):S("",!0),l("div",{ref_key:"observerTarget",ref:M,class:"w-full h-4"},null,512)])]))}},_e=Z(me,[["__scopeId","data-v-55bf78c3"]]);export{_e as default};
