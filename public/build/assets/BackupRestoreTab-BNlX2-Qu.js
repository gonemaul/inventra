import{x as j,X as S,g as o,o as n,b as t,n as c,f as r,t as l,d as k,i as x,a as b,w as f,F,q as R,s as g}from"./app-CHQSHO3f.js";import{u as E}from"./useActionLoading-Bk-hXxe0.js";const N={class:"space-y-8 animate-fade-in"},T={class:"flex items-center justify-between p-6 bg-white border border-gray-200 shadow-sm dark:bg-gray-800 rounded-2xl dark:border-gray-700"},I={class:"flex items-center gap-4"},L={class:"text-sm text-gray-500"},_=["disabled"],M={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},O={class:"flex flex-col justify-between p-6 border border-indigo-100 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl dark:border-indigo-800"},D=["disabled"],H={key:0,class:"w-4 h-4 animate-spin",viewBox:"0 0 24 24"},K={key:0,class:"flex justify-between mt-1"},U={class:"text-xs text-indigo-700 dark:text-indigo-300"},V={class:"text-xs text-indigo-700 dark:text-indigo-300"},z={key:1,class:"text-xs text-center text-indigo-700 dark:text-indigo-300"},P={class:"flex flex-col justify-between p-6 border border-orange-100 bg-orange-50 dark:bg-orange-900/20 rounded-2xl dark:border-orange-800"},Z=["disabled"],$={key:0,class:"flex justify-between mt-1"},G={class:"text-xs text-orange-700 dark:text-orange-300"},q={class:"text-xs text-orange-700 dark:text-orange-300"},J={class:"text-xs text-orange-700 dark:text-orange-300"},W={key:1,class:"mt-3 text-xs text-center text-orange-700 dark:text-orange-300"},X={class:"overflow-hidden bg-white border border-gray-200 shadow-sm dark:bg-gray-800 dark:border-gray-700 rounded-2xl"},Q={class:"overflow-x-auto"},Y={class:"w-full text-sm text-left"},tt={class:"divide-y divide-gray-100 dark:divide-gray-700"},et={class:"px-6 py-4 font-bold text-gray-700 dark:text-gray-300 whitespace-nowrap"},at={class:"px-6 py-4 font-mono text-xs text-gray-500 dark:text-gray-300"},st={class:"px-6 py-4"},ot={class:"px-2 py-1 text-xs font-bold text-gray-600 bg-gray-100 rounded dark:bg-gray-700 dark:text-gray-300"},nt={class:"flex justify-end gap-2 px-6 py-4 text-right"},rt=["onClick"],lt=["href"],it=["onClick"],dt={key:0},ct={__name:"BackupRestoreTab",props:{backups:Array,autoBackupEnabled:Boolean,lastRestore:Object,lastBackup:Object},setup(a){const m=a,p=j(null),{isActionLoading:s}=E(),y=()=>{g.post(route("backups.update-setting"),{enabled:!m.autoBackupEnabled},{preserveScroll:!0,onStart:()=>s.value=!0,onFinish:()=>s.value=!1})},h=()=>{confirm("Buat backup database sekarang?")&&(s.value=!0,g.post(route("backups.store"),{},{onFinish:()=>s.value=!1,preserveScroll:!0}))},v=i=>{confirm(`⚠️ PERINGATAN KERAS!

Anda akan me-restore database ke titik waktu file ini dibuat.
Semua data transaksi SETELAH waktu file tersebut akan HILANG dan TIDAK BISA KEMBALI.

Apakah Anda yakin ingin melanjutkan?`)&&(s.value=!0,g.post(route("backups.restore",i),{},{onFinish:()=>s.value=!1,preserveScroll:!0}))},w=()=>p.value.click(),B=i=>{const e=i.target.files[0];if(e&&confirm(`Upload file "${e.name}" dan restore database menggunakan file ini?`)){const u=new FormData;u.append("backup_file",e),s.value=!0,g.post(route("backups.upload-restore"),u,{onFinish:()=>{s.value=!1,p.value.value=null}})}},A=i=>{confirm("Hapus file backup ini permanen?")&&(s.value=!0,g.delete(route("backups.destroy",i),{preserveScroll:!0,onFinish:()=>s.value=!1}))};return(i,e)=>{const u=S("Strong");return n(),o("div",N,[t("div",T,[t("div",I,[t("div",{class:c(["p-3 rounded-full",a.autoBackupEnabled?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"])},[...e[0]||(e[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],2),t("div",null,[e[2]||(e[2]=t("h3",{class:"text-lg font-bold text-gray-800 dark:text-white"}," Backup Otomatis ",-1)),t("p",L,[e[1]||(e[1]=r(" Status: ",-1)),t("span",{class:c(["font-bold",a.autoBackupEnabled?"text-green-600":"text-gray-400"])},l(a.autoBackupEnabled?"AKTIF (Setiap Jam 22:00)":"NON-AKTIF"),3)])])]),t("button",{onClick:y,disabled:k(s).value==!0,class:c(["relative inline-flex items-center h-6 transition-colors rounded-full w-11 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",a.autoBackupEnabled?"bg-green-500":"bg-gray-200 dark:bg-gray-700"])},[e[3]||(e[3]=t("span",{class:"sr-only"},"Toggle Backup",-1)),t("span",{class:c(["inline-block w-4 h-4 transition-transform transform bg-white rounded-full",a.autoBackupEnabled?"translate-x-6":"translate-x-1"])},null,2)],10,_)]),t("div",M,[t("div",O,[e[8]||(e[8]=t("div",null,[t("h4",{class:"mb-1 text-lg font-bold text-indigo-900 dark:text-indigo-100"}," Backup Sekarang "),t("p",{class:"mb-4 text-xs text-indigo-700 dark:text-indigo-300"}," Buat salinan database saat ini secara manual. Disarankan sebelum melakukan perubahan besar. ")],-1)),t("button",{onClick:h,disabled:k(s).value==!0,class:"flex items-center justify-center w-full gap-2 py-2 text-sm font-bold text-white transition bg-indigo-600 rounded-lg shadow-md hover:bg-indigo-700 disabled:opacity-50"},[k(s).value==!0?(n(),o("svg",H,[...e[4]||(e[4]=[t("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".3"},null,-1),t("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},null,-1)])])):x("",!0),e[5]||(e[5]=t("span",null,"+ Buat Backup Baru",-1))],8,D),Object.keys(a.lastBackup).length>0?(n(),o("span",K,[t("p",U,[e[6]||(e[6]=r(" Terakhir dibakcup tanggal : ",-1)),t("strong",null,l(a.lastBackup.date),1)]),t("p",V,[e[7]||(e[7]=r(" Oleh : ",-1)),t("strong",null,l(a.lastBackup.user),1)])])):(n(),o("p",z," Belum pernah dibackup "))]),t("div",P,[e[13]||(e[13]=t("div",null,[t("h4",{class:"mb-1 text-lg font-bold text-orange-900 dark:text-orange-100"}," Restore dari File "),t("p",{class:"mb-4 text-xs text-orange-700 dark:text-orange-300"}," Punya file backup (.zip) dari komputer lain? Upload disini untuk memulihkan database. ")],-1)),t("input",{type:"file",ref_key:"fileInput",ref:p,class:"hidden",accept:".zip",onChange:B},null,544),t("button",{onClick:w,disabled:k(s).value==!0,class:"flex items-center justify-center w-full gap-2 py-2 text-sm font-bold text-white transition bg-orange-600 rounded-lg shadow-md hover:bg-orange-700 disabled:opacity-50"},[...e[9]||(e[9]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),t("span",null,"Upload & Restore",-1)])],8,Z),Object.keys(a.lastRestore).length>0?(n(),o("span",$,[t("p",G,[e[10]||(e[10]=r(" Terakhir dipulihkan tanggal : ",-1)),b(u,null,{default:f(()=>[r(l(a.lastRestore.date),1)]),_:1})]),t("p",q,[e[11]||(e[11]=r(" Oleh : ",-1)),b(u,null,{default:f(()=>[r(l(a.lastRestore.user),1)]),_:1})]),t("p",J,[e[12]||(e[12]=r(" Dari : ",-1)),t("strong",null,l(a.lastRestore.filename),1)])])):(n(),o("p",W," Belum pernah pemulihan "))])]),t("div",X,[e[18]||(e[18]=t("div",{class:"p-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800"},[t("h4",{class:"text-sm font-bold text-gray-800 dark:text-white"}," Riwayat Backup (Restore Points) ")],-1)),t("div",Q,[t("table",Y,[e[17]||(e[17]=t("thead",{class:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-gray-700/50 dark:text-gray-300"},[t("tr",null,[t("th",{class:"px-6 py-3"},"Waktu Backup"),t("th",{class:"px-6 py-3"},"Nama File"),t("th",{class:"px-6 py-3"},"Ukuran"),t("th",{class:"px-6 py-3 text-right"},"Aksi")])],-1)),t("tbody",tt,[(n(!0),o(F,null,R(a.backups,d=>(n(),o("tr",{key:d.name,class:"transition hover:bg-gray-50 dark:hover:bg-gray-700/30"},[t("td",et,l(d.date),1),t("td",at,l(d.name),1),t("td",st,[t("span",ot,l(d.size),1)]),t("td",nt,[t("button",{onClick:C=>v(d.name),class:"flex items-center gap-1 px-3 py-1.5 bg-orange-50 border border-orange-200 text-orange-700 rounded-lg hover:bg-orange-100 transition text-xs font-bold",title:"Pulihkan database ke titik ini"},[...e[14]||(e[14]=[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),r(" Restore ",-1)])],8,rt),t("a",{href:i.route("backups.download",d.name),class:"flex items-center gap-1 px-3 py-1.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:text-blue-600 transition text-xs font-bold",title:"Download ke Komputer"}," ⬇️ ",8,lt),t("button",{onClick:C=>A(d.name),class:"p-1.5 text-gray-400 hover:text-red-600 rounded transition",title:"Hapus File"},[...e[15]||(e[15]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,it)])]))),128)),!a.backups||a.backups.length===0?(n(),o("tr",dt,[...e[16]||(e[16]=[t("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-400"}," Belum ada file backup tersimpan. ",-1)])])):x("",!0)])])])])])}}};export{ct as default};
