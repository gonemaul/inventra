import{v as S,u as H,x as N,D as R,l as s,o,d as T,p as m,f as r,n as b,g as a,t as n,e as p,k as x,z as g,L as k,F as c,I as y,A as I,N as $,w as V,C as A,j as D}from"./vendor-core-B46KUNyc.js";import{_ as f}from"./TextInput-DDwApxbn.js";import{P as K}from"./PrimaryButton-H-fN45pr.js";import{_ as O}from"./SecondaryButton-BDyiAFyF.js";import{u as E}from"./useActionLoading-pomD9vky.js";import{_ as J}from"./BarcodeScanner-BWk-Obnv.js";import{_ as M}from"./InputRupiah-B1VRU30-.js";import"./vendor-common-GpUWqhKr.js";import"./vendor-charts-Bw6UNgWf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-scanner-og__AIM6.js";const q={class:"flex-1 p-4 space-y-5 overflow-y-auto md:p-6 md:space-y-6 custom-scrollbar"},G={class:"flex flex-col gap-5 md:flex-row md:gap-8"},Q={class:"flex justify-center flex-shrink-0 md:justify-start"},W={class:"flex flex-col items-center w-full"},X=["src"],Y={key:1,class:"flex flex-col items-center justify-center px-2 pt-5 pb-6 text-center"},Z={key:0,class:"mt-1 text-xs text-center text-red-500"},ee={class:"flex-1 space-y-4"},te={class:"relative"},re={key:0,class:"mt-1 text-xs text-red-500"},le={key:0,class:"mt-1 text-xs text-red-500"},ae={class:"grid grid-cols-2 gap-4 md:grid-cols-3"},oe={class:"col-span-2 md:col-span-1"},se=["value"],de={key:0,class:"mt-1 text-xs text-red-500"},ie=["disabled"],ne={value:null},ue=["value"],me={key:0,class:"mt-1 text-xs text-red-500"},pe=["value"],ge={key:0,class:"mt-1 text-xs text-red-500"},ce=["value"],xe=["value"],ye=["value"],be={key:0,class:"mt-1 text-xs text-red-500"},ke={class:"p-4 space-y-4 border border-gray-100 bg-gray-50 dark:bg-gray-900/40 rounded-xl dark:border-gray-700"},fe={class:"text-xs font-bold tracking-wide text-gray-500 uppercase dark:text-white"},ve={key:0,class:"text-[10px] text-red-500"},_e={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},we={class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},he={key:0,class:"text-red-500"},Ve={key:0,class:"text-xs text-red-500"},Me={class:"block mb-1 text-sm font-medium text-gray-700 dark:!text-gray-200"},Fe={key:0,class:"text-red-500"},Se={key:0,class:"text-xs text-red-500"},Ue={class:"grid grid-cols-2 gap-4 md:grid-cols-4"},Pe={class:"relative"},Ce={class:"text-[12px] ml-3 text-gray-400 mt-1 text-left"},je={key:0,class:"mt-1 text-xs text-red-500"},Be={class:"flex items-center gap-4"},ze=["onUpdate:modelValue","value"],Le={class:"ml-2 text-sm text-gray-700 capitalize dark:text-gray-300"},He={class:"z-10 flex justify-end gap-3 p-4 border-t border-gray-200 md:p-6 dark:border-gray-700"},qe={__name:"FormProduct",props:{dropdowns:Object,product:{type:Object,default:()=>({})},mode:String},setup(u){const i=u,{isActionLoading:_}=E(),w=S(!1),t=H({type:"",category_id:i.product?.category_id||null,unit_id:i.product?.unit_id||null,size_id:i.product?.size_id||null,supplier_id:i.product?.supplier_id||null,brand_id:i.product?.brand_id||null,product_type_id:i.product?.product_type_id||null,name:i.product?.name||"",code:i.product?.code||"",description:i.product?.description||"",status:i.product?.status||"active",purchase_price:i.product?.purchase_price||0,selling_price:i.product?.selling_price||0,stock:i.product?.stock||0,min_stock:i.product?.min_stock||0,target_margin_percent:i.product?.target_margin_percent||10,margin_nominal:0,markup:0,image:null}),v=S(i.product?.image_url??null);function U(d){const e=d.target.files[0];e&&(t.image=e,v.value=URL.createObjectURL(e))}N(async()=>{const d=parseFloat(t.purchase_price)||0,l=(parseFloat(t.selling_price)||0)-d;t.margin_nominal=Math.ceil(l)});const h=R(()=>i.dropdowns.types.filter(d=>d.category_id===t.category_id)),F=()=>{const d=parseFloat(t.purchase_price)||0,e=parseFloat(t.target_margin_percent)||0;if(e<100){const l=d/(1-e/100);t.margin_nominal=Math.ceil(l-d),i.mode=="create"&&(t.selling_price=Math.round(l))}},P=()=>{const d=parseFloat(t.purchase_price)||0,e=parseFloat(t.selling_price)||0,l=e-d;t.margin_nominal=l,d>0?(t.target_margin_percent=parseFloat((l/e*100).toFixed(2)),t.markup=parseFloat((l/d*100).toFixed(2))):t.target_margin_percent=100},C=()=>{F()},j=()=>{const d=parseFloat(t.purchase_price)||0,e=parseFloat(t.margin_nominal)||0,l=d+e;t.selling_price=Math.round(l),l>0&&(t.target_margin_percent=parseFloat((e/l*100).toFixed(2)),t.markup=parseFloat((e/d*100).toFixed(2)))},B=()=>{_.value=!0,i.mode==="create"?t.post(route("products.store"),{onFinish:()=>_.value=!1}):(t.type="full",t.transform(d=>({...d,_method:"put"})).post(route("products.update",{product:i.product.slug}),{onFinish:()=>_.value=!1}))},z=d=>{alert(d),t.code=d,showScanner.value=!1};return(d,e)=>(o(),s(c,null,[w.value?(o(),T(J,{key:0,onResult:z,onClose:e[0]||(e[0]=l=>w.value=!1)})):m("",!0),r("form",{class:"flex flex-col h-full",onSubmit:D(B,["prevent"])},[r("div",q,[r("div",G,[r("div",Q,[r("div",W,[r("label",{for:"image-upload",class:b(["relative flex flex-col items-center justify-center w-32 h-32 md:w-40 md:h-40 rounded-xl cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 transition border-2 border-dashed",v.value?"border-transparent":"border-gray-300 dark:border-gray-500"])},[v.value?(o(),s("img",{key:0,src:v.value,class:"object-cover w-full h-full rounded-xl",alt:"Preview"},null,8,X)):(o(),s("div",Y,[...e[17]||(e[17]=[r("svg",{class:"w-8 h-8 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),r("p",{class:"text-xs text-gray-500 dark:text-gray-300"}," Upload Foto ",-1),r("p",{class:"text-[10px] text-gray-400 mt-1"}," Max 2MB ",-1)])])),r("input",{id:"image-upload",type:"file",class:"hidden",onChange:U},null,32)],2),a(t).errors.image?(o(),s("p",Z,n(a(t).errors.image),1)):m("",!0)])]),r("div",ee,[r("div",null,[e[19]||(e[19]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Kode Barang",-1)),r("div",te,[p(f,{class:"w-full pr-10",id:"kode",type:"text",placeholder:"Scan / Input Kode",modelValue:a(t).code,"onUpdate:modelValue":e[1]||(e[1]=l=>a(t).code=l)},null,8,["modelValue"]),r("button",{type:"button",onClick:e[2]||(e[2]=l=>w.value=!0),class:"absolute right-1 top-1 p-1.5 bg-gray-100 dark:bg-gray-600 rounded-md text-gray-500 dark:text-gray-200 hover:text-lime-600 border border-gray-200 dark:border-gray-500",title:"Scan Barcode"},[...e[18]||(e[18]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1)])])]),a(t).errors.code?(o(),s("p",re,n(a(t).errors.code),1)):m("",!0)]),r("div",null,[e[20]||(e[20]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},[x("Nama Barang "),r("span",{class:"text-red-500"},"*")],-1)),p(f,{class:"w-full",id:"nama",type:"text",placeholder:"Nama Produk Lengkap",modelValue:a(t).name,"onUpdate:modelValue":e[3]||(e[3]=l=>a(t).name=l)},null,8,["modelValue"]),a(t).errors.name?(o(),s("p",le,n(a(t).errors.name),1)):m("",!0)])])]),e[42]||(e[42]=r("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1)),r("div",ae,[r("div",oe,[e[22]||(e[22]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},[x("Kategori "),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[4]||(e[4]=l=>a(t).category_id=l)},[e[21]||(e[21]=r("option",{value:null},"Pilih Kategori",-1)),(o(!0),s(c,null,y(u.dropdowns.categories,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,se))),128))],512),[[k,a(t).category_id]]),a(t).errors.category_id?(o(),s("p",de,n(a(t).errors.category_id),1)):m("",!0)]),r("div",null,[e[23]||(e[23]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Tipe",-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[5]||(e[5]=l=>a(t).product_type_id=l),disabled:h.value.length===0},[r("option",ne,n(h.value.length===0?"Tidak Ada Tipe":"Pilih Tipe"),1),(o(!0),s(c,null,y(h.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,ue))),128))],8,ie),[[k,a(t).product_type_id]]),a(t).errors.product_type_id?(o(),s("p",me,n(a(t).errors.product_type_id),1)):m("",!0)]),r("div",null,[e[25]||(e[25]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Satuan",-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[6]||(e[6]=l=>a(t).unit_id=l)},[e[24]||(e[24]=r("option",{value:null},"Pilih Satuan",-1)),(o(!0),s(c,null,y(u.dropdowns.units,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,pe))),128))],512),[[k,a(t).unit_id]]),a(t).errors.unit_id?(o(),s("p",ge,n(a(t).errors.unit_id),1)):m("",!0)]),r("div",null,[e[27]||(e[27]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Ukuran",-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[7]||(e[7]=l=>a(t).size_id=l)},[e[26]||(e[26]=r("option",{value:null},"Pilih Ukuran",-1)),(o(!0),s(c,null,y(u.dropdowns.sizes,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,ce))),128))],512),[[k,a(t).size_id]])]),r("div",null,[e[29]||(e[29]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Merk",-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[8]||(e[8]=l=>a(t).brand_id=l)},[e[28]||(e[28]=r("option",{value:null},"Pilih Merk",-1)),(o(!0),s(c,null,y(u.dropdowns.brands,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,xe))),128))],512),[[k,a(t).brand_id]])]),r("div",null,[e[31]||(e[31]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Supplier",-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[9]||(e[9]=l=>a(t).supplier_id=l)},[e[30]||(e[30]=r("option",{value:null},"Pilih Supplier",-1)),(o(!0),s(c,null,y(u.dropdowns.suppliers,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,ye))),128))],512),[[k,a(t).supplier_id]])])]),r("div",null,[e[32]||(e[32]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Deskripsi",-1)),g(r("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>a(t).description=l),name:"description",id:"description",rows:"2",placeholder:"Deskripsi / Keterangan tambahan barang",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:border-lime-500 focus:ring-lime-500"},null,512),[[I,a(t).description]]),a(t).errors.description?(o(),s("p",be,n(a(t).errors.description),1)):m("",!0)]),r("div",ke,[r("h3",fe,[e[33]||(e[33]=x(" Harga & Stok ",-1)),u.mode=="edit"?(o(),s("p",ve," Atur Harga & Stok hanya bisa dilakukan di edit stok & harga ")):m("",!0)]),r("div",_e,[r("div",null,[r("label",we,[e[34]||(e[34]=x("Harga Beli (HPP) ",-1)),u.mode!=="edit"?(o(),s("span",he,"*")):m("",!0)]),p(M,{modelValue:a(t).purchase_price,"onUpdate:modelValue":e[11]||(e[11]=l=>a(t).purchase_price=l),class:b(["w-full !py-2 !pr-3 !pl-9",u.mode=="edit"?"!bg-gray-300/50 !text-gray-500 dark:!bg-gray-900/50 dark:!text-gray-200":"dark:!bg-gray-700 dark:!text-white"]),onInput:F,disabled:u.mode=="edit",id:"price_buy",min:"0",placeholder:"Rp 0"},null,8,["modelValue","class","disabled"]),a(t).errors.purchase_price?(o(),s("p",Ve,n(a(t).errors.purchase_price),1)):m("",!0)]),r("div",null,[r("label",Me,[e[35]||(e[35]=x("Harga Jual ",-1)),u.mode!=="edit"?(o(),s("span",Fe,"*")):m("",!0)]),p(M,{modelValue:a(t).selling_price,"onUpdate:modelValue":e[12]||(e[12]=l=>a(t).selling_price=l),class:b(["w-full !py-2 !pr-3 !pl-9 ",u.mode=="edit"?"!bg-gray-300/50 dark:!bg-gray-900/50 !text-gray-500 dark:!text-gray-200":"!text-lime-600 !dark:text-lime-400 !font-semibold dark:!bg-gray-700 dark:!text-white"]),id:"price_sell",min:"0",disabled:u.mode=="edit",onInput:P,placeholder:"Rp 0"},null,8,["modelValue","class","disabled"]),a(t).errors.selling_price?(o(),s("p",Se,n(a(t).errors.selling_price),1)):m("",!0)])]),r("div",Ue,[r("div",null,[e[36]||(e[36]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Target Margin (Rp)",-1)),p(M,{modelValue:a(t).margin_nominal,"onUpdate:modelValue":e[13]||(e[13]=l=>a(t).margin_nominal=l),class:b(["w-full !py-2 text-sm dark:!bg-gray-700 dark:!text-white"]),id:"margin_nominal",onInput:j},null,8,["modelValue"])]),r("div",null,[e[38]||(e[38]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Target Margin (%)",-1)),r("div",Pe,[p(f,{modelValue:a(t).target_margin_percent,"onUpdate:modelValue":e[14]||(e[14]=l=>a(t).target_margin_percent=l),class:b(["w-full py-2 pr-7 text-sm"]),id:"target_margin_percent",type:"number",step:"any",onInput:C},null,8,["modelValue"]),e[37]||(e[37]=r("span",{class:"absolute text-sm text-gray-500 dark:text-white right-2 top-2"},"%",-1))]),r("p",Ce," Setara Markup: "+n(a(t).markup)+"% ",1)]),r("div",null,[e[39]||(e[39]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Stok Saat Ini",-1)),p(f,{modelValue:a(t).stock,"onUpdate:modelValue":e[15]||(e[15]=l=>a(t).stock=l),id:"stock",type:"number",class:b(["w-full py-1.5",u.mode=="edit"?"bg-gray-300/50 text-gray-500 dark:!bg-gray-900/50 dark:!text-gray-200":""]),placeholder:"0",disabled:u.mode=="edit"},null,8,["modelValue","class","disabled"]),a(t).errors.stock?(o(),s("p",je,n(a(t).errors.stock),1)):m("",!0)]),r("div",null,[e[40]||(e[40]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Min. Stok",-1)),p(f,{modelValue:a(t).min_stock,"onUpdate:modelValue":e[16]||(e[16]=l=>a(t).min_stock=l),id:"min_stock",type:"number",class:"w-full py-1.5 text-red-600",placeholder:"0",min:"1"},null,8,["modelValue"])])]),r("div",null,[e[41]||(e[41]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"},"Status Produk",-1)),r("div",Be,[(o(!0),s(c,null,y(u.dropdowns.productStatuses,l=>(o(),s("label",{key:l,class:"inline-flex items-center cursor-pointer"},[g(r("input",{type:"radio","onUpdate:modelValue":L=>a(t).status=L,value:l,class:"w-4 h-4 border-gray-300 text-lime-600 focus:ring-lime-500 dark:bg-gray-700"},null,8,ze),[[$,a(t).status]]),r("span",Le,n(l),1)]))),128))])])]),e[43]||(e[43]=r("div",{class:"h-2"},null,-1))]),r("div",He,[p(a(A),{href:d.route("products.index"),class:"w-full md:w-auto"},{default:V(()=>[p(O,{class:"justify-center w-full md:w-auto"},{default:V(()=>[...e[44]||(e[44]=[x(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),p(K,{type:"submit",disabled:a(t).processing,class:"justify-center w-full md:w-auto dark:bg-gray-900"},{default:V(()=>[x(n(a(t).processing?"Menyimpan...":"Simpan Produk"),1)]),_:1},8,["disabled"])])],32)],64))}};export{qe as default};
