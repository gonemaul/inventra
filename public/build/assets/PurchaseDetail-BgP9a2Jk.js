const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DesktopDetail-YwBBpvXQ.js","assets/vendor-core-5xBySu3Y.js","assets/vendor-common-pmZ7KOuE.js","assets/vendor-charts-Bw6UNgWf.js","assets/vendor-core-DnojJsHo.css","assets/Tabs-CzJxR_UE.js","assets/PrimaryButton-Cxy6ePjq.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/HeaderDetail-Cy5yi8IA.js","assets/InfoCard-CduULfkr.js","assets/usePurchaseAnalytics-DnFmBEDr.js","assets/invoiceTable-CtTvJ2e7.js","assets/DataTable-1Rs-7zLT.js","assets/ImageModal-BE5YdGl-.js","assets/BottomSheet-Dqr7fYKf.js","assets/BottomSheet-_RmS2FQk.css","assets/productTable-DRMVSh3L.js","assets/StatusModalMobile-hQUoUIR7.js","assets/useActionLoading-EL6uCNX6.js","assets/MobileDetail-CEoxPzgr.js","assets/HeadMobile-y7UAKBu7.js","assets/HeadMobile-Etapf-Xy.css","assets/InvoiceMobile-C8yT9jnA.js","assets/ProdukMobile-CeNgY5Ty.js","assets/useSidebar-B3r-HMJy.js","assets/MobileDetail-Chsqj0fs.css"])))=>i.map(i=>d[i]);
import{_ as B}from"./app-DBj7CbE2.js";import{_ as O}from"./AuthenticatedLayout-BHUnLsIa.js";import{x as H,y as s,d as q,o as m,w as S,f as y,l as k,m as K,t as T,k as z,e as i,g as b,I as U,z as W,N as Y,p as E,i as G,a1 as j,_ as F,F as J}from"./vendor-core-5xBySu3Y.js";import{_ as Q}from"./DeleteConfirm-DXQY9Q-x.js";import{_ as X}from"./Modal-CvxaYuhL.js";import{D as Z}from"./DangerButton-BtEy7HXD.js";import{_ as ee}from"./SecondaryButton-bHJ7AARo.js";import{u as ae}from"./useActionLoading-EL6uCNX6.js";import te from"./FinalizeModal-CU4QcYJy.js";import se from"./OrderImageModal-DWlMnynX.js";import ne from"./InvoiceForm-DCy1iGAV.js";import"./vendor-common-pmZ7KOuE.js";import"./vendor-charts-Bw6UNgWf.js";import"./useSidebar-B3r-HMJy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./PrimaryButton-Cxy6ePjq.js";import"./InputLabel-BwubbiQ3.js";import"./TextInput-9oNUKZ2x.js";import"./BottomSheet-Dqr7fYKf.js";import"./InputError-30a7QS26.js";const ie={class:"p-6"},oe={class:"mb-4 text-xl font-bold text-red-600"},le={class:"mb-4 text-gray-700 dark:text-gray-300"},re={key:0,class:"mb-6 text-lg font-semibold"},ue={class:"text-red-700 dark:text-red-400"},ce={class:"flex justify-end gap-3 mt-4"},de={key:0},me={key:1},pe={__name:"ConfirmModal",emits:["close","success"],setup(l,{expose:$,emit:x}){const{isActionLoading:a}=ae(),p=H(),c=s(!1),r=s("Konfirmasi Aksi"),v=s("Anda yakin ingin melanjutkan aksi ini?"),d=s(""),h=s(""),u=s("post"),g=s({});$({open:n=>{r.value=n.title||"Konfirmasi Penghapusan",v.value=n.message||"Anda yakin ingin menghapus data ini?",d.value=n.itemName||"",h.value=n.url||"",u.value=n.method||"post",g.value=n.data||{},c.value=!0}});const f=()=>{c.value=!1,_("close")},D=()=>{if(!h.value){p.error("URL aksi tidak terdefinisi.");return}a.value=!0;const n=u.value.toLowerCase();U[n](h.value,g.value||{},{preserveScroll:!0,onSuccess:()=>{f(),_("close")},onError:o=>{p.error(o.message||"Terjadi kesalahan saat menghapus data.")},onFinish:()=>{a.value=!1,h.value=""}})},_=x;return(n,o)=>(m(),q(X,{show:c.value,onClose:o[0]||(o[0]=C=>_("close")),maxWidth:"md"},{default:S(()=>[y("div",ie,[y("h3",oe,T(r.value),1),y("p",le,T(v.value),1),d.value?(m(),k("p",re,[o[1]||(o[1]=z(" Item: ",-1)),y("span",ue,T(d.value),1)])):K("",!0),y("div",ce,[i(ee,{onClick:f,type:"button"},{default:S(()=>[...o[2]||(o[2]=[z(" Batal ",-1)])]),_:1}),i(Z,{onClick:D,disabled:b(a)},{default:S(()=>[b(a)?(m(),k("span",de,"Memproses...")):(m(),k("span",me,"Ya"))]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},ve={key:0},he={key:1},Ve={__name:"PurchaseDetail",props:{purchase:Object,invoices:Object,invoice:Object,paymentStatuses:Array,isCheckingMode:Boolean},setup(l){const $=j(()=>B(()=>import("./DesktopDetail-YwBBpvXQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),x=j(()=>B(()=>import("./MobileDetail-CEoxPzgr.js"),__vite__mapDeps([19,14,1,2,3,4,7,15,20,10,21,22,13,23,17,18,24,25]))),a=l,p=s(!1),c=s(null),r=s(!1),v=s(null),d=s(!1),h=s(!1),u=s(window.innerWidth<1024),g=()=>{u.value=window.innerWidth<1024};W(()=>{window.addEventListener("resize",g),a.purchase.status==="diterima"&&!a.invoice.id&&C()}),Y(()=>window.removeEventListener("resize",g));const M=s(a.purchase.items.map(e=>({...e,rejected_quantity:e.rejected_quantity||0,is_valid:e.quantity-(e.rejected_quantity||0)>0}))),f=E(()=>{const e=a.purchase;if(e.status!=="checking"||e.items.some(I=>I.item_status==="pending")||e.invoices.length===0)return!1;const w=e.invoices.every(I=>{const L=I.status==="validated",R=I.items&&I.items.length>0;return L&&R});return console.log(w),w}),D=E(()=>["diterima","checking"].includes(a.purchase.status)),_=E(()=>a.purchase.status==="draft"||a.purchase.status==="dipesan"),n=E(()=>a.purchase.status==="draft"),o=()=>{f.value&&(d.value=!0)},C=()=>{v.value=null,r.value=!0},V=e=>{v.value=e,r.value=!0},P=e=>{const t={title:"Hapus Nota Keuangan",message:`Hapus Nota No. ${e.invoice_number}? Ini akan menghapus file foto dan mengembalikan status transaksi ke RECEIVED jika tidak ada nota lain.`,itemName:e.invoice_number,url:route("purchases.destroyInvoice",{purchase:a.purchase.id,invoice:e.id})};c.value.open(t)},A=()=>{r.value=!1,router.reload({preserveScroll:!0,preserveState:!0})},N={openCreateInvoiceModal:C,handleEditInvoice:V,handleDeleteInvoice:P,handleDelete:()=>{const e={title:"Hapus Pembelian",message:`Apakah Anda yakin ingin menghapus pembelian #${a.purchase.reference_no}? Tindakan ini tidak dapat dibatalkan.`,url:route("purchases.destroy",a.purchase.id)};c.value.open(e)},openFinalizeModal:o,getActions:e=>{const t=[];switch(e.status){case"draft":t.push({label:"Tandai Dipesan",icon:"play",type:"status",newStatus:"dipesan"});break;case"dipesan":t.push({label:"Tandai Dikirim",icon:"truck",type:"status",newStatus:"dikirim"});break;case"dikirim":t.push({label:"Tandai Diterima",icon:"receive",type:"status",newStatus:"diterima"});break;case"diterima":t.push({label:"Batalkan Terima",icon:"undo",type:"status",newStatus:"dikirim"});break}return t},openImageModal:()=>p.value=!0};return(e,t)=>(m(),k(J,null,[i(b(G),{title:`Detail - ${l.purchase.reference_no}`},null,8,["title"]),i(Q,{ref_key:"deleteModalRef",ref:c,onSuccess:A},null,512),i(pe,{ref_key:"showConfirmModal",ref:h,onSuccess:A},null,512),i(te,{show:d.value,purchase:l.purchase,onClose:t[0]||(t[0]=w=>d.value=!1)},null,8,["show","purchase"]),i(se,{show:p.value,purchase:l.purchase,"store-name":e.$page.props.auth.user.store_name||"INVENTRA STORE",onClose:t[1]||(t[1]=w=>p.value=!1)},null,8,["show","purchase","store-name"]),i(ne,{show:r.value,purchaseId:l.purchase.id,editingInvoice:v.value,paymentStatuses:l.paymentStatuses,onClose:t[2]||(t[2]=w=>r.value=!1),onInvoiceSaved:A},null,8,["show","purchaseId","editingInvoice","paymentStatuses"]),i(O,{showSidebar:!u.value,showHeader:!u.value,showBottomBar:!u.value,headerTitle:`Detail - ${l.purchase.reference_no}`},{default:S(()=>[u.value?(m(),k("div",ve,[i(b(x),F(a,{actions:N,validationItems:M.value,allowFinalize:f.value,canEditDeleteInvoice:D.value,isEditing:_.value,isDeleted:n.value}),null,16,["validationItems","allowFinalize","canEditDeleteInvoice","isEditing","isDeleted"])])):(m(),k("div",he,[i(b($),F(a,{actions:N,validationItems:M.value,allowFinalize:f.value,canEditDeleteInvoice:D.value,isEditing:_.value,isDeleted:n.value}),null,16,["validationItems","allowFinalize","canEditDeleteInvoice","isEditing","isDeleted"])]))]),_:1},8,["showSidebar","showHeader","showBottomBar","headerTitle"])],64))}};export{Ve as default};
