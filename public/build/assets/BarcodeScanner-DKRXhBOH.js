import{H as x,a as b}from"./vendor-scanner-og__AIM6.js";import{v as n,x as y,S as C,l as i,o as d,f as r,p as v,y as g,n as S}from"./vendor-core-By7Plnkm.js";const z={class:"fixed inset-0 z-[9999] bg-black flex flex-col justify-center"},B={key:0,class:"absolute inset-0 flex items-center justify-center bg-black z-[10000]"},F={class:"absolute z-10 bottom-4 right-4"},M={class:"absolute top-0 left-0 right-0 p-6 flex justify-between items-start z-[10001]"},_={__name:"BarcodeScanner",emits:["result","close"],setup(j,{emit:f}){const a=f;let o=null;const s=n(!1),l=n(!1),c=n(!0),h=async()=>{const t="global-reader";try{o=new x(t);const e={fps:10,qrbox:{width:250,height:250},aspectRatio:1,disableFlip:!1},m={facingMode:"environment",focusMode:"continuous",width:{min:640,ideal:1280},height:{min:480,ideal:720}};await o.start({facingMode:"environment"},{...e,videoConstraints:m},p,w),s.value=!0,c.value=!1}catch(e){console.error("Error starting scanner:",e),alert("Gagal mengakses kamera. Pastikan izin diberikan."),c.value=!1,a("close")}},p=(t,e)=>{o&&o.pause(),navigator.vibrate&&navigator.vibrate(300),a("result",t),u(),a("close")},w=t=>{},u=async()=>{if(o)try{const t=o.getState();(t===b.SCANNING||t===b.PAUSED)&&await o.stop(),o.clear()}catch(t){console.error("Failed to stop scanner",t)}o=null,s.value=!1,l.value=!1},k=()=>{if(!o)return;const t=!l.value;o.applyVideoConstraints({advanced:[{torch:t}]}).then(()=>{l.value=t}).catch(e=>{console.error("Fitur Flash error",e),alert("Flash tidak didukung atau kamera sedang sibuk.")})};return y(()=>{setTimeout(()=>{h()},100)}),C(()=>{u()}),(t,e)=>(d(),i("div",z,[e[5]||(e[5]=r("div",{id:"global-reader",class:"w-full h-full bg-black"},null,-1)),s.value?v("",!0):(d(),i("div",B,[...e[1]||(e[1]=[g('<div class="text-center"><svg class="w-10 h-10 mx-auto mb-2 animate-spin text-lime-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p class="text-sm font-medium text-white">Membuka Kamera...</p></div>',1)])])),r("div",F,[s.value?(d(),i("button",{key:0,onClick:k,class:S(["p-3 transition-colors rounded-full shadow-lg",l.value?"bg-yellow-400 text-black":"bg-white text-gray-800"])},[...e[2]||(e[2]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})],-1)])],2)):v("",!0)]),r("div",M,[e[4]||(e[4]=r("div",{class:"px-4 py-2 text-sm font-medium text-white border rounded-full bg-black/50 backdrop-blur-sm border-white/20"}," Arahkan ke Barcode ",-1)),r("button",{onClick:e[0]||(e[0]=m=>t.$emit("close")),class:"flex items-center justify-center w-10 h-10 text-white transition rounded-full bg-white/20 backdrop-blur-md hover:bg-white/40"},[...e[3]||(e[3]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e[6]||(e[6]=g('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-[10000]"><div class="relative w-64 h-64 border-2 border-lime-500/50 rounded-2xl"><div class="absolute top-0 left-0 w-5 h-5 border-t-4 border-l-4 border-lime-500 -mt-0.5 -ml-0.5 rounded-tl-lg"></div><div class="absolute top-0 right-0 w-5 h-5 border-t-4 border-r-4 border-lime-500 -mt-0.5 -mr-0.5 rounded-tr-lg"></div><div class="absolute bottom-0 left-0 w-5 h-5 border-b-4 border-l-4 border-lime-500 -mb-0.5 -ml-0.5 rounded-bl-lg"></div><div class="absolute bottom-0 right-0 w-5 h-5 border-b-4 border-r-4 border-lime-500 -mb-0.5 -mr-0.5 rounded-br-lg"></div><div class="absolute top-1/2 left-4 right-4 h-0.5 bg-red-500 shadow-[0_0_15px_rgba(239,68,68,0.8)] animate-scan"></div></div></div>',1))]))}};export{_};
