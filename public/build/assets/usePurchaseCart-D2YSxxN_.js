import{E as k,p as l,H as z,L as b}from"./vendor-core-DyO1rNNh.js";const c="inventra_purchase_cart_temp";function x(_=!1,r={}){const e=k([]);function f(){if(_){r&&r.items&&(e.value=[],p(r.items));return}const a=localStorage.getItem(c);if(a)try{e.value=JSON.parse(a)}catch{localStorage.removeItem(c)}}function d(a,t,n,q=!1){const u=a.product_id,i=parseInt(t),s=parseFloat(n),o=e.value.find(S=>S.product_id===u);o&&q?(o.quantity+=i,o.purchase_price=s,o.subtotal=o.quantity*s):e.value.push({id:u?a.id:"",product_id:u??a.id,name:a.name,code:a.code,category:a.category?.name||a.category||"-",unit:a.unit?.name||a.unit||"-",size:a.size?.name||a.size||"-",current_stock:a.stock||a.current_stock,image_url:a.image_url||"",quantity:i,purchase_price:s,subtotal:i*s})}function v(a){const t=e.value.findIndex(n=>n.product_id===a.product_id);t!==-1&&(e.value[t].quantity=parseInt(a.quantity),e.value[t].purchase_price=parseFloat(a.purchase_price),e.value[t].subtotal=e.value[t].quantity*e.value[t].purchase_price)}function g(a){e.value=e.value.filter(t=>t.product_id!==a)}function h(){e.value=[],localStorage.removeItem(c)}function p(a){a.forEach(t=>{const n={id:t.id??"",product_id:t.product_id,name:t.product_snapshot?.name??t.name,code:t.product_snapshot?.code??t.code,unit:t.product_snapshot?.unit??t.unit,size:t.product_snapshot?.size??t.size,category:t.product_snapshot?.category??t.category,stock:t.product_snapshot?.stock??t.current_stock,image_url:t.product_snapshot?.image_url??""};d(n,t.quantity,t.purchase_price)})}const y=l(()=>e.value.reduce((a,t)=>a+t.quantity,0)),m=l(()=>e.value.reduce((a,t)=>a+t.subtotal,0)),I=l(()=>e.value.length);return z(e,a=>{localStorage.setItem(c,JSON.stringify(a))},{deep:!0}),b(()=>{f()}),{cartItems:e,addToCart:d,updateCartItem:v,removeItem:g,clearCart:h,totalUnit:y,totalBelanja:m,totalMacam:I,addMultipleItems:p}}export{x as u};
