import{G as w,p as k,u as h,H as S,l as r,m as f,o as i,f as e,j as M,q as m,I as b,g as l,t as d,J as _,F as B,C}from"./vendor-core-PGoj2oEu.js";import"./vendor-common-BBegFRNv.js";import{u as D}from"./useActionLoading-Ch10BqBo.js";import"./vendor-charts-Bw6UNgWf.js";const I={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},F={class:"w-full max-w-md overflow-hidden bg-white shadow-2xl rounded-xl animate-fade-in-down"},V={class:"flex items-center justify-between p-4 border-b bg-gray-50"},T={class:"relative"},U=["max"],j={class:"mt-1 text-xs text-right text-gray-400"},A={key:0,class:"mt-1 text-xs text-red-500"},N={class:"grid grid-cols-2 gap-4"},O=["value"],$={key:0,class:"mt-1 text-xs text-red-500"},L={class:"flex gap-3 pt-2"},P=["disabled"],G={__name:"PaymentModal",props:{show:Boolean,paymentMethods:Array,invoice:Object},emits:["close"],setup(u,{emit:x}){const a=u,y=x;w();const{isActionLoading:g}=D(),c=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),p=k(()=>a.invoice?a.invoice.total_amount-a.invoice.amount_paid:0),o=h({payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"transfer",proof_image:null,notes:""});S(()=>a.show,n=>{n&&(o.reset(),o.clearErrors(),o.amount=p.value,o.payment_date=new Date().toISOString().split("T")[0])});const v=()=>{g.value=!0,o.post(route("finance.store",a.invoice.id),{onSuccess:()=>{y("close"),g.value=!1}})};return(n,t)=>u.show?(i(),r("div",I,[e("div",F,[e("div",V,[t[7]||(t[7]=e("h3",{class:"font-bold text-gray-800"},"Input Pembayaran",-1)),e("button",{onClick:t[0]||(t[0]=s=>n.$emit("close")),class:"text-xl font-bold text-gray-400 hover:text-red-500"}," Ã— ")]),e("form",{onSubmit:M(v,["prevent"]),class:"p-5 space-y-4"},[e("div",null,[t[9]||(t[9]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Nominal Bayar",-1)),e("div",T,[t[8]||(t[8]=e("span",{class:"absolute font-bold text-gray-500 left-3 top-2"},"Rp",-1)),m(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=s=>l(o).amount=s),class:"w-full py-2 pl-10 pr-3 text-lg font-bold border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",max:p.value,placeholder:"0"},null,8,U),[[b,l(o).amount]])]),e("div",j," Maks: "+d(c(p.value)),1),l(o).errors.amount?(i(),r("div",A,d(l(o).errors.amount),1)):f("",!0)]),e("div",N,[e("div",null,[t[10]||(t[10]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Tanggal",-1)),m(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>l(o).payment_date=s),class:"w-full p-2 text-sm border rounded-lg"},null,512),[[b,l(o).payment_date]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Metode",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>l(o).payment_method=s),class:"w-full p-2 text-sm border rounded-lg"},[(i(!0),r(B,null,C(u.paymentMethods,s=>(i(),r("option",{key:s,value:s},d(s.charAt(0).toUpperCase()+s.slice(1)),9,O))),128))],512),[[_,l(o).payment_method]])])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Bukti Foto / Struk",-1)),e("input",{type:"file",onInput:t[4]||(t[4]=s=>l(o).proof_image=s.target.files[0]),class:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),l(o).errors.proof_image?(i(),r("div",$,d(l(o).errors.proof_image),1)):f("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Catatan (Opsional)",-1)),m(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>l(o).notes=s),rows:"2",class:"w-full p-2 text-sm border rounded-lg",placeholder:"Contoh: Cicilan pertama"},null,512),[[b,l(o).notes]])]),e("div",L,[e("button",{type:"button",onClick:t[6]||(t[6]=s=>n.$emit("close")),class:"flex-1 py-2 text-gray-600 rounded-lg hover:bg-gray-100"}," Batal "),e("button",{type:"submit",disabled:l(o).processing,class:"flex-1 py-2 font-bold text-white rounded-lg bg-lime-600 hover:bg-lime-700 disabled:opacity-50"},d(l(o).processing?"Menyimpan...":"Bayar Sekarang"),9,P)])],32)])])):f("",!0)}};export{G as default};
