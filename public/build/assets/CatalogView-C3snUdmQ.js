import{v as o,D as E,K as j,x as G,l as s,o as t,f as a,z as k,p as I,A as P,g as H,L as S,F as m,I as b,t as z,n as L,d as J,a as Q}from"./vendor-core-By7Plnkm.js";import{j as R}from"./vendor-common-GpUWqhKr.js";import W from"./CatalogCard-CDk-Qd0H.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-charts-Bw6UNgWf.js";const Y={class:"flex flex-col h-full bg-gray-50 dark:bg-gray-900"},Z={class:"sticky top-0 z-20 bg-white border-b shadow-sm dark:bg-gray-800 dark:border-gray-700"},ee={class:"pb-2 px-4 py-3 flex items-center gap-3"},le={class:"relative flex-1"},ae={key:0,class:"absolute right-3 top-3"},te={class:"px-3 pb-3 overflow-x-auto no-scrollbar scroll-smooth mask-fade-right"},re={class:"flex items-center gap-2"},se=["value"],oe=["value"],ne=["value"],ie=["value"],de={class:"flex-1 py-3 overflow-y-auto md:p-3 custom-scrollbar"},ue={key:0,class:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4"},ge={key:1,class:"grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"},ve={key:2,class:"flex flex-col items-center justify-center py-10 text-gray-400"},pe={key:3,class:"flex justify-center py-4"},ce={__name:"CatalogView",props:{supplierId:{type:[Number,String],required:!0},items:Object,stagingItem:Object,categories:Array,brands:Array},emits:["select-product"],setup(T,{emit:$}){const d=T,D=$,u=o([]),f=o(!1),x=o(!1),V=o(1),w=o(!0),p=o(""),B=o(null),n=o("all"),g=o("all"),c=o("all"),v=o("all"),i=o(""),U=o([]),M=o([]),h=o([]),_=o([]);E(()=>{if(n.value==="all")return[];const r=d.categories.find(e=>e.id==n.value);return r?r.product_types||[]:[]});const C=async(r=!1)=>{if(d.supplierId){r?(f.value=!0,V.value=1,u.value=[],w.value=!0):x.value=!0;try{const l=(await Q.get(`/purchases/products/${d.supplierId}`,{params:{page:V.value,search:p.value,category_id:n.value==="all"?null:n.value,product_type_id:g.value==="all"?null:g.value,brand_id:c.value==="all"?null:c.value,size_id:v.value==="all"?null:v.value,stock_status:i.value||null}})).data,F=l.products.data;l.available_brands&&(M.value=l.available_brands),l.available_sizes&&(h.value=l.available_sizes),r?u.value=F:u.value=[...u.value,...F],w.value=!!l.products.next_page_url,w.value&&V.value++}catch(e){console.error("Gagal load katalog:",e)}finally{f.value=!1,x.value=!1}}},y=()=>{p.value&&(p.value=""),C(!0)},q=R(()=>{C(!0)},500),K=()=>{p.value="",n.value="all",g.value="all",c.value="all",v.value="all",i.value="",U.value=d.categories||[],M.value=d.brands||[],_.value=[],h.value=[]};j(n,r=>{r==="all"&&(_.value=[]),g.value="all",v.value="all"}),j(c,()=>{g.value="all",v.value="all"});const N=r=>{r[0].isIntersecting&&w.value&&!f.value&&!x.value&&C(!1)};G(()=>{const r=new IntersectionObserver(N,{threshold:.1});B.value&&r.observe(B.value)}),j(()=>d.supplierId,r=>{r?(K(),C(!0)):u.value=[]},{immediate:!0});const A=r=>d.items.find(e=>e.product_id===r),O=r=>{D("select-product",r)};return(r,e)=>(t(),s("div",Y,[a("div",Z,[a("div",ee,[a("div",le,[k(a("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),onInput:e[1]||(e[1]=(...l)=>H(q)&&H(q)(...l)),onFocus:e[2]||(e[2]=l=>l.target.select()),type:"search",placeholder:"Cari produk...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-100 dark:bg-gray-800 border-none rounded-xl focus:ring-2 focus:ring-lime-500 text-sm font-medium text-gray-800 dark:text-white placeholder-gray-400 transition-all"},null,544),[[P,p.value]]),e[10]||(e[10]=a("span",{class:"absolute left-3.5 top-2.5 text-gray-400"},[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),f.value?(t(),s("div",ae,[...e[9]||(e[9]=[a("span",{class:"relative flex h-3 w-3"},[a("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-lime-400 opacity-75"}),a("span",{class:"relative inline-flex rounded-full h-3 w-3 bg-lime-500"})],-1)])])):I("",!0)])]),a("div",te,[a("div",re,[k(a("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>n.value=l),onChange:y,class:"text-xs font-medium py-1.5 pl-2 pr-8 bg-white border border-gray-300 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all"},[e[11]||(e[11]=a("option",{value:"all"},"Semua Kategori",-1)),(t(!0),s(m,null,b(U.value,l=>(t(),s("option",{key:l.id,value:l.id},z(l.name),9,se))),128))],544),[[S,n.value]]),k(a("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>c.value=l),onChange:y,class:"text-xs font-medium py-1.5 pl-2 pr-8 bg-white border border-gray-300 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all"},[e[12]||(e[12]=a("option",{value:"all"},"Semua Brand",-1)),(t(!0),s(m,null,b(M.value,l=>(t(),s("option",{key:l.id,value:l.id},z(l.name),9,oe))),128))],544),[[S,c.value]]),n.value!=="all"&&_.value.length>0?k((t(),s("select",{key:0,"onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),onChange:y,class:"text-xs font-medium py-1.5 pl-2 pr-8 bg-white border border-gray-300 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-300 animate-fade-in"},[e[13]||(e[13]=a("option",{value:"all"},"Semua Tipe",-1)),(t(!0),s(m,null,b(_.value,l=>(t(),s("option",{key:l.id,value:l.id},z(l.name),9,ne))),128))],544)),[[S,g.value]]):I("",!0),h.value.length>0?k((t(),s("select",{key:1,"onUpdate:modelValue":e[6]||(e[6]=l=>v.value=l),onChange:y,class:"text-xs font-medium py-1.5 pl-2 pr-8 bg-white border border-gray-300 rounded-lg focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-300 animate-fade-in"},[e[14]||(e[14]=a("option",{value:"all"},"Semua Ukuran",-1)),(t(!0),s(m,null,b(h.value,l=>(t(),s("option",{key:l.id,value:l.id},z(l.name),9,ie))),128))],544)),[[S,v.value]]):I("",!0),e[15]||(e[15]=a("div",{class:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"},null,-1)),a("button",{onClick:e[7]||(e[7]=l=>{i.value=i.value==="empty"?"":"empty",y()}),class:L(["px-3 py-1.5 text-xs font-bold rounded-full border transition-all whitespace-nowrap",i.value==="empty"?"bg-red-500 text-white border-red-500 shadow-md shadow-red-500/30":"bg-white border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300 hover:border-gray-300"])}," Habis ",2),a("button",{onClick:e[8]||(e[8]=l=>{i.value=i.value==="low"?"":"low",y()}),class:L(["px-3 py-1.5 text-xs font-bold rounded-full border transition-all whitespace-nowrap",i.value==="low"?"bg-yellow-500 text-white border-yellow-500 shadow-md shadow-yellow-500/30":"bg-white border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300 hover:border-gray-300"])}," Menipis ",2)])])]),a("div",de,[f.value?(t(),s("div",ue,[(t(),s(m,null,b(8,l=>a("div",{key:l,class:"flex flex-col p-2 bg-white rounded-lg shadow dark:bg-gray-800 animate-pulse"},[...e[16]||(e[16]=[a("div",{class:"w-full mb-2 bg-gray-200 rounded aspect-square dark:bg-gray-700"},null,-1),a("div",{class:"w-3/4 h-4 mb-2 bg-gray-200 rounded dark:bg-gray-700"},null,-1),a("div",{class:"w-1/2 h-3 mt-auto bg-gray-200 rounded dark:bg-gray-700"},null,-1)])])),64))])):u.value.length>0?(t(),s("div",ge,[(t(!0),s(m,null,b(u.value,l=>(t(),J(W,{key:l.id,item:l,"is-selected":T.stagingItem.product_id===l.id,"is-in-cart":!!A(l.id),"cart-qty":A(l.id)?.quantity||0,onSelect:O},null,8,["item","is-selected","is-in-cart","cart-qty"]))),128))])):(t(),s("div",ve,[...e[17]||(e[17]=[a("svg",{class:"w-12 h-12 mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),a("p",{class:"text-sm"},"Tidak ada produk ditemukan",-1)])])),x.value?(t(),s("div",pe,[...e[18]||(e[18]=[a("svg",{class:"w-5 h-5 text-blue-500 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):I("",!0),a("div",{ref_key:"observerTarget",ref:B,class:"w-full h-4"},null,512)])]))}},xe=X(ce,[["__scopeId","data-v-de31323a"]]);export{xe as default};
