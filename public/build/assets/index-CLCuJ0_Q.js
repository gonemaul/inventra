import{x as r,s as f,z as c,j as V,g as $,o as g,a as o,d as h,h as D,w as n,b as a,k as F,v as A,c as v,l as _,f as w,n as M,t as b,F as N}from"./app-OOVJa1pD.js";import{_ as P}from"./AuthenticatedLayout-CL35wTeb.js";import{_ as U}from"./DataTable-DdkiKaOx.js";import{_ as E}from"./Filter-DZHBq5Rl.js";import K from"./modalFilter-DXJcG9zh.js";import{u as L}from"./useActionLoading-1e1XIs5r.js";import{_ as z}from"./DeleteConfirm-DDbBHyPE.js";import{_ as R}from"./ConfirmModal-C_jIKyYx.js";import{l as S}from"./lodash-DyM2-MAi.js";import"./TextInput-DJ0hRKLP.js";import"./PrimaryButton-cGu7IqtH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-CeAPgi98.js";import"./DangerButton-C3yXGm0L.js";import"./SecondaryButton-34kUvxFC.js";const q={class:"w-full min-h-screen space-y-6"},G={class:"p-4 space-y-6 bg-gray-100 border shadow-md rounded-xl dark:bg-customBg-tableDark"},H={class:"flex items-center space-x-2 cursor-pointer"},I={class:"flex flex-col"},J={class:"font-medium"},Q={class:"text-xs text-gray-500"},W={class:"inline-flex w-full gap-2"},me={__name:"index",props:{dropdowns:Object,filters:Object,purchases:Object},setup(i){const l=i;r(null),r({top:0,left:0});const d=r(l.filters.search||""),p=r(!1),{isActionLoading:x}=L(),C=r(null),m=r(!1),j=r(!1),B=[{key:"transaction_date",label:"Tanggal Order",sortable:!0,format:"tanggal"},{key:"reference_no",label:"No. Referensi",sortable:!0},{key:"supplier",label:"Supplier",slot:"supplier"},{key:"items_sum_subtotal",label:"Total Belanja",sortable:!0,format:"rupiah"},{key:"status",label:"Status",sortable:!0,slot:"status"},{key:"aksi",label:"Aksi",width:"120px",slot:"aksi"}],u=r({search:l.filters.search||"",sort:l.filters.sort||"transaction_date",order:l.filters.order||"desc",page:l.purchases.current_page||1}),y=()=>{f.reload({only:["purchases","filters"],preserveScroll:!0})},O=S.throttle(()=>{const s={...l.filters};s.search=d.value,s.search||delete s.search,f.get(route("purchases.index"),s,{preserveState:!0,replace:!0})},300);c(m,s=>{s===!0?u.value.trashed=!0:delete u.value.trashed}),c(u,S.throttle(s=>{const t=Object.fromEntries(Object.entries(s).filter(([e,k])=>k!=null&&k!==""));x.value=!0,f.get(route("purchases.index"),t,{preserveState:!0,preserveScroll:!0,replace:!0,only:["purchases","filters"],onFinish:()=>{x.value=!1}})},300),{deep:!0}),c(d,O);const T=V(()=>{const s=Object.keys(l.filters),t=["search","page","per_page"];return s.filter(e=>!t.includes(e)).length});return(s,t)=>(g(),$(N,null,[o(h(D),{title:"Pembelian"}),o(P,{headerTitle:"Pembelian"},{default:n(()=>[o(z,{ref_key:"showConfirmDelete",ref:C,onSuccess:y},null,512),o(R,{ref_key:"showConfirmModal",ref:j,onSuccess:y},null,512),a("div",q,[o(E,{filters:i.filters,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),onShowFilter:t[1]||(t[1]=e=>p.value=!0),filterCount:T.value,actions:[{route:s.route("purchases.create"),buttonText:"RAB"}]},null,8,["filters","modelValue","filterCount","actions"]),o(K,{show:p.value,onClose:t[2]||(t[2]=e=>p.value=!1),filters:i.filters,dropdowns:i.dropdowns},null,8,["show","filters","dropdowns"]),a("div",G,[a("div",null,[t[6]||(t[6]=a("h2",{class:"text-base font-semibold text-gray-900 dark:text-white sm:text-lg lg:text-xl"}," Daftar Pembelian ",-1)),t[7]||(t[7]=a("p",{class:"mt-1 text-xs text-gray-600 dark:text-gray-300 sm:text-sm lg:text-base"}," Kelola semua pembelian. ",-1)),a("label",H,[F(a("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>m.value=e),class:"rounded dark:bg-gray-900 border-gray-300 dark:border-gray-700 ..."},null,512),[[A,m.value]]),t[5]||(t[5]=a("span",{class:"text-sm text-gray-600 dark:text-gray-400"}," Tampilkan Sampah ",-1))])]),o(U,{serverSide:"true",data:i.purchases.data,columns:B,perPageOptions:[5,10,25,50,100],params:u.value,"onUpdate:params":t[4]||(t[4]=e=>u.value=e),pagination:i.purchases},{supplier:n(({row:e})=>[a("div",I,[a("span",J,b(e.supplier?e.supplier.name:"Umum/Cash"),1),a("span",Q,b(e.supplier?e.supplier.phone:"-"),1)])]),status:n(({row:e})=>[a("span",{class:M(["px-2 py-1 text-xs font-bold uppercase rounded",{"bg-gray-200 text-gray-600":e.status==="draft","bg-blue-100 text-blue-600":e.status==="dipesan","bg-yellow-100 text-yellow-600":e.status==="dikirim","bg-purple-100 text-purple-600":e.status==="diterima","bg-teal-100 text-teal-600":e.status==="checking","bg-green-100 text-green-600":e.status==="selesai","bg-red-100 text-red-600":e.status==="dibatalkan"}])},b(e.status),3)]),aksi:n(({row:e})=>[a("div",W,[e.status=="checking"?(g(),v(h(_),{key:0,href:s.route("purchases.checking",e.id),class:"px-3 py-1 text-sm font-medium text-teal-600 transition border border-teal-200 rounded hover:text-teal-900 hover:bg-teal-300"},{default:n(()=>[...t[8]||(t[8]=[w(" Validasi Barang ",-1)])]),_:2},1032,["href"])):(g(),v(h(_),{key:1,href:s.route("purchases.show",e.id),class:"px-3 py-1 text-sm font-medium text-indigo-600 transition border border-indigo-200 rounded hover:text-indigo-900 hover:bg-indigo-300"},{default:n(()=>[...t[9]||(t[9]=[w(" Lihat Detail ",-1)])]),_:2},1032,["href"]))])]),_:1},8,["data","params","pagination"])])])]),_:1})],64))}};export{me as default};
