import{u as P,x as B,g as o,o as a,b as r,i,n as S,d as s,t as n,a as p,f as m,k as g,B as y,F as _,q as b,A as D,w as v,l as I,e as N}from"./app-CojE2Nhg.js";import{_ as x}from"./TextInput-C5_XdFB5.js";import{P as j}from"./PrimaryButton-DUx9qtmT.js";import{_ as C}from"./SecondaryButton-R9Cu_VDx.js";import{u as R}from"./useActionLoading-CfpAqoVk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"flex flex-col gap-4 md:flex-row"},K={class:"flex flex-col lg:w-2/5"},L=["src"],z={key:1,class:"flex flex-col items-center justify-center w-full h-full pt-5 pb-6"},A={key:0,class:"mt-1 text-sm text-red-500"},T={class:"flex flex-col justify-center flex-1 gap-3"},O={key:0,class:"mt-1 text-sm text-red-500"},q={key:0,class:"mt-1 text-sm text-red-500"},E={class:"grid grid-cols-1 gap-3 mt-5 md:grid-cols-3"},J={key:0,value:null},$=["value"],G={key:0,class:"mt-1 text-sm text-red-500"},W={key:0,value:null},Q=["value"],X={key:0,class:"mt-1 text-sm text-red-500"},Y={key:0,value:null},Z=["value"],ee={key:0,class:"mt-1 text-sm text-red-500"},te={key:0,value:null},re=["value"],se={key:0,class:"mt-1 text-sm text-red-500"},le={key:0,value:null},oe=["value"],ae={key:0,class:"mt-1 text-sm text-red-500"},ne={key:0,value:null},de=["value"],ie={key:0,class:"mt-1 text-sm text-red-500"},ue={class:"mt-4"},me={key:0,class:"mt-1 text-sm text-red-500"},pe={class:"flex flex-col gap-3 mt-4 md:flex-row"},ce={class:"flex-1"},ge={class:"relative"},xe={class:"flex justify-between"},ye={class:"ml-2 text-sm text-gray-500"},_e={key:0,class:"mt-1 text-sm text-red-500"},be={class:"flex-1"},fe={class:"relative"},ke={class:"flex justify-between"},ve={class:"ml-2 text-sm text-gray-500"},we={key:0,class:"mt-1 text-sm text-red-500"},he={class:"grid grid-cols-1 gap-3 mt-4 md:grid-cols-5"},Ve={key:0,class:"mt-1 text-sm text-red-500"},Fe={key:0,class:"mt-1 text-sm text-red-500"},Ue={class:"relative"},Me={class:"ml-2 text-sm text-gray-500"},Pe={class:"relative"},Be={key:0,class:"mt-1 text-sm text-red-500"},Se=["value"],De={key:0,class:"mt-1 text-sm text-red-500"},Ie={class:"flex justify-end gap-3 mt-6"},Le={__name:"form-create-edit",props:{dropdowns:Object,product:{type:Object,default:null},mode:String},setup(c){const d=c,{isActionLoading:k}=R(),e=P({category_id:d.product?.category_id||null,unit_id:d.product?.unit_id||null,size_id:d.product?.size_id||null,supplier_id:d.product?.supplier_id||null,brand_id:d.product?.brand_id||null,product_type_id:d.product?.product_type_id||null,name:d.product?.name||"",code:d.product?.code||"",description:d.product?.description||"",status:d.product?.status||"active",purchase_price:d.product?.purchase_price||0,selling_price:d.product?.selling_price||0,stock:d.product?.stock||0,min_stock:d.product?.min_stock||0,target_margin_percent:d.product?.target_margin_percent||20,margin_nominal:0,image:null}),f=B(d.product?.image_url??null),w=()=>{const u=parseFloat(e.purchase_price)||0,t=parseFloat(e.target_margin_percent)||0,l=u*(t/100);e.margin_nominal=Math.round(l),e.selling_price=Math.round(u+l)},h=()=>{const u=parseFloat(e.purchase_price)||0,l=(parseFloat(e.selling_price)||0)-u;e.margin_nominal=l,u>0?e.target_margin_percent=parseFloat((l/u*100).toFixed(2)):e.target_margin_percent=100},V=()=>{const u=parseFloat(e.purchase_price)||0,t=parseFloat(e.target_margin_percent)||0,l=u*(t/100);e.margin_nominal=Math.round(l),e.selling_price=Math.round(u+l)},F=()=>{const u=parseFloat(e.purchase_price)||0,t=parseFloat(e.margin_nominal)||0;e.selling_price=Math.round(u+t),u>0&&(e.target_margin_percent=parseFloat((t/u*100).toFixed(2)))};function U(u){const t=u.target.files[0];t&&(e.image=t,f.value=URL.createObjectURL(t))}const M=()=>{k.value=!0,d.mode==="create"?e.post(route("products.store"),{onFinish:()=>k.value=!1}):e.transform(u=>({...u,_method:"put"})).post(route("products.update",{product:d.product.id}),{onFinish:()=>k.value=!1})};return(u,t)=>(a(),o("form",{class:"p-6 bg-gray-100 rounded-lg shadow dark:bg-customBg-tableDark",onSubmit:N(M,["prevent"])},[r("div",H,[r("div",K,[r("label",{for:"image-upload",class:S(["flex flex-col items-center justify-center w-40 mt-2 rounded-lg cursor-pointer aspect-square bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600",{"border-2 border-gray-300 border-dashed":!f.value}])},[f.value?(a(),o("img",{key:0,src:f.value,alt:"Preview",class:"object-cover w-full h-full rounded-lg"},null,8,L)):(a(),o("div",z,[...t[16]||(t[16]=[r("p",{class:"mb-2 text-sm text-gray-500 dark:text-gray-200"},[r("span",{class:"font-semibold"},"Klik untuk Upload")],-1),r("p",{class:"text-xs text-gray-500 dark:text-gray-200"}," WEBP, PNG (max. 1MB) ",-1)])])),r("input",{id:"image-upload",type:"file",name:"image",class:"hidden",onChange:U},null,32)],2),s(e).errors.image?(a(),o("p",A,n(s(e).errors.image),1)):i("",!0)]),r("div",T,[r("div",null,[t[17]||(t[17]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},"Kode Barang",-1)),p(x,{class:"w-full max-h-10",id:"kode",type:"text",name:"kode",placeholder:"Kode Barang",modelValue:s(e).code,"onUpdate:modelValue":t[0]||(t[0]=l=>s(e).code=l)},null,8,["modelValue"]),s(e).errors.code?(a(),o("p",O,n(s(e).errors.code),1)):i("",!0)]),r("div",null,[t[18]||(t[18]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Nama Barang"),r("span",{class:"text-red-500"},"*")],-1)),p(x,{class:"w-full max-h-10",id:"nama",type:"text",name:"nama",placeholder:"Nama Barang",modelValue:s(e).name,"onUpdate:modelValue":t[1]||(t[1]=l=>s(e).name=l)},null,8,["modelValue"]),s(e).errors.name?(a(),o("p",q,n(s(e).errors.name),1)):i("",!0)])])]),r("div",E,[r("div",null,[t[19]||(t[19]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Kategori"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":t[2]||(t[2]=l=>s(e).category_id=l)},[d.mode=="create"?(a(),o("option",J," Pilih Kategori ")):i("",!0),(a(!0),o(_,null,b(c.dropdowns.categories,l=>(a(),o("option",{key:l.id,value:l.id},n(l.name),9,$))),128))],512),[[y,s(e).category_id]]),s(e).errors.category_id?(a(),o("p",G,n(s(e).errors.category_id),1)):i("",!0)]),r("div",null,[t[20]||(t[20]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Type"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":t[3]||(t[3]=l=>s(e).product_type_id=l)},[d.mode=="create"?(a(),o("option",W," Pilih Type ")):i("",!0),(a(!0),o(_,null,b(c.dropdowns.types,l=>(a(),o("option",{key:l.id,value:l.id},n(l.name),9,Q))),128))],512),[[y,s(e).product_type_id]]),s(e).errors.product_type_id?(a(),o("p",X,n(s(e).errors.product_type_id),1)):i("",!0)]),r("div",null,[t[21]||(t[21]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Satuan"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>s(e).unit_id=l),class:"w-full px-3 py-2 text-sm border border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[d.mode=="create"?(a(),o("option",Y," Pilih Satuan ")):i("",!0),(a(!0),o(_,null,b(c.dropdowns.units,l=>(a(),o("option",{key:l.id,value:l.id},n(l.name),9,Z))),128))],512),[[y,s(e).unit_id]]),s(e).errors.unit_id?(a(),o("p",ee,n(s(e).errors.unit_id),1)):i("",!0)]),r("div",null,[t[22]||(t[22]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Ukuran"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(e).size_id=l),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[d.mode=="create"?(a(),o("option",te," Pilih Ukuran ")):i("",!0),(a(!0),o(_,null,b(c.dropdowns.sizes,l=>(a(),o("option",{key:l.id,value:l.id},n(l.name),9,re))),128))],512),[[y,s(e).size_id]]),s(e).errors.size_id?(a(),o("p",se,n(s(e).errors.size_id),1)):i("",!0)]),r("div",null,[t[23]||(t[23]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Merk"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>s(e).brand_id=l),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[d.mode=="create"?(a(),o("option",le," Pilih Merk ")):i("",!0),(a(!0),o(_,null,b(c.dropdowns.brands,l=>(a(),o("option",{key:l.id,value:l.id},n(l.name),9,oe))),128))],512),[[y,s(e).brand_id]]),s(e).errors.brand_id?(a(),o("p",ae,n(s(e).errors.brand_id),1)):i("",!0)]),r("div",null,[t[24]||(t[24]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Supplier"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>s(e).supplier_id=l),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[d.mode=="create"?(a(),o("option",ne," Pilih Supplier ")):i("",!0),(a(!0),o(_,null,b(c.dropdowns.suppliers,l=>(a(),o("option",{key:l.id,value:l.id},n(l.name),9,de))),128))],512),[[y,s(e).supplier_id]]),s(e).errors.supplier_id?(a(),o("p",ie,n(s(e).errors.supplier_id),1)):i("",!0)])]),r("div",ue,[t[25]||(t[25]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Deskripsi"),r("span",{class:"text-red-500"},"*")],-1)),g(r("textarea",{"onUpdate:modelValue":t[8]||(t[8]=l=>s(e).description=l),name:"description",id:"description",rows:"3",placeholder:"Deskripsi Barang",class:"w-full px-3 py-2 border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},null,512),[[D,s(e).description]]),s(e).errors.description?(a(),o("p",me,n(s(e).errors.description),1)):i("",!0)]),r("div",pe,[r("div",ce,[t[27]||(t[27]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Harga Beli (HPP)"),r("span",{class:"text-red-500"},"*")],-1)),r("div",ge,[t[26]||(t[26]=r("span",{class:"absolute text-sm text-gray-500 left-3 top-2"},"Rp",-1)),p(x,{modelValue:s(e).purchase_price,"onUpdate:modelValue":t[9]||(t[9]=l=>s(e).purchase_price=l),class:"w-full py-2 pr-3 max-h-10 pl-9",onInput:w,id:"price_buy",type:"number",min:"0",name:"price_buy",placeholder:"Harga Beli"},null,8,["modelValue"])]),r("span",xe,[r("p",ye,n(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(e).purchase_price)||0),1),s(e).errors.purchase_price?(a(),o("p",_e,n(s(e).errors.purchase_price),1)):i("",!0)])]),r("div",be,[t[29]||(t[29]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Harga Jual"),r("span",{class:"text-red-500"},"*")],-1)),r("div",fe,[t[28]||(t[28]=r("span",{class:"absolute text-sm text-gray-500 left-3 top-2"},"Rp",-1)),p(x,{modelValue:s(e).selling_price,"onUpdate:modelValue":t[10]||(t[10]=l=>s(e).selling_price=l),class:"w-full py-2 pr-3 max-h-10 pl-9",id:"price_sell",type:"number",min:"0",onInput:h,name:"price_sell",placeholder:"Harga Jual"},null,8,["modelValue"])]),r("span",ke,[r("p",ve,n(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(e).selling_price)||0),1),s(e).errors.selling_price?(a(),o("p",we,n(s(e).errors.selling_price),1)):i("",!0)])])]),r("div",he,[r("div",null,[t[30]||(t[30]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Stock"),r("span",{class:"text-red-500"},"*")],-1)),p(x,{class:"w-full max-h-10",id:"stock",type:"number",name:"stock",min:"0",placeholder:"Stock",modelValue:s(e).stock,"onUpdate:modelValue":t[11]||(t[11]=l=>s(e).stock=l)},null,8,["modelValue"]),s(e).errors.stock?(a(),o("p",Ve,n(s(e).errors.stock),1)):i("",!0)]),r("div",null,[t[31]||(t[31]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Min Stock"),r("span",{class:"text-red-500"},"*")],-1)),p(x,{modelValue:s(e).min_stock,"onUpdate:modelValue":t[12]||(t[12]=l=>s(e).min_stock=l),class:"w-full max-h-10",id:"min_stock",min:"0",type:"number",name:"min_stock",placeholder:"Min Stock"},null,8,["modelValue"]),s(e).errors.min_stock?(a(),o("p",Fe,n(s(e).errors.min_stock),1)):i("",!0)]),r("div",null,[t[33]||(t[33]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Margin (Rp)"),r("span",{class:"text-red-500"},"*")],-1)),r("div",Ue,[t[32]||(t[32]=r("span",{class:"absolute text-sm text-gray-500 left-3 top-2"},"Rp",-1)),p(x,{modelValue:s(e).margin_nominal,"onUpdate:modelValue":t[13]||(t[13]=l=>s(e).margin_nominal=l),class:"w-full py-2 pr-3 pl-9 max-h-10",id:"margin_nominal",type:"number",min:"0",onInput:F,name:"margin_nominal",placeholder:"Margin Nominal"},null,8,["modelValue"]),r("p",Me,n(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(e).margin_nominal)||0),1)])]),r("div",null,[t[35]||(t[35]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Margin (%)"),r("span",{class:"text-red-500"},"*")],-1)),r("div",Pe,[p(x,{modelValue:s(e).target_margin_percent,"onUpdate:modelValue":t[14]||(t[14]=l=>s(e).target_margin_percent=l),class:"w-full py-2 pl-3 pr-8 max-h-10",id:"target_margin_percent",type:"text",min:"0",onInput:V,name:"target_margin_percent",placeholder:"Margin Percent"},null,8,["modelValue"]),t[34]||(t[34]=r("span",{class:"absolute text-sm font-bold text-gray-500 right-3 top-2"},"%",-1)),s(e).errors.target_margin_percent?(a(),o("p",Be,n(s(e).errors.target_margin_percent),1)):i("",!0)])]),r("div",null,[t[36]||(t[36]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Status"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":t[15]||(t[15]=l=>s(e).status=l),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg focus:border-lime-500 focus:ring-lime-500 dark:bg-gray-700 dark:text-white"},[(a(!0),o(_,null,b(c.dropdowns.productStatuses,l=>(a(),o("option",{key:l,value:l},n(l.charAt(0).toUpperCase()+l.slice(1)),9,Se))),128))],512),[[y,s(e).status]]),s(e).errors.status?(a(),o("p",De,n(s(e).errors.status),1)):i("",!0)])]),r("div",Ie,[p(s(I),{href:u.route("products.index")},{default:v(()=>[p(C,null,{default:v(()=>[...t[37]||(t[37]=[m("Batal",-1)])]),_:1})]),_:1},8,["href"]),p(j,{type:"submit",disabled:s(e).processing},{default:v(()=>[m(n(s(e).processing?"Menyimpan...":"Simpan"),1)]),_:1},8,["disabled"])])],32))}};export{Le as default};
