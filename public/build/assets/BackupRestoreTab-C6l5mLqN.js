import{p as H,q as j,a0 as B,a3 as V,l,o as d,e as h,f as e,n as S,m as M,y as m,z as x,K as N,x as O,k as u,t as g,w as R,F as A,H as E,I as c}from"./vendor-core-B1zCOcYd.js";import{P as J,_ as q}from"./PremiumConfirmModal-JL8LLOOC.js";import"./vendor-common-GpUWqhKr.js";import"./vendor-charts-Bw6UNgWf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"space-y-8 animate-fade-in"},I={class:"flex flex-col p-6 space-y-6 bg-white border border-gray-200 shadow-sm dark:bg-gray-800 rounded-2xl dark:border-gray-700"},$={class:"flex items-center justify-between"},G={class:"flex items-center gap-4"},Y={class:"flex items-center gap-3"},K=["disabled"],W={key:0,class:"grid grid-cols-1 gap-6 pt-6 border-t border-gray-100 md:grid-cols-2 lg:grid-cols-3 dark:border-gray-700"},Q={key:1,class:"flex justify-end"},X=["disabled"],Z={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},ee={class:"flex flex-col justify-between p-6 border border-indigo-100 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl dark:border-indigo-800"},te=["disabled"],ae={key:0,class:"flex justify-between mt-1"},se={class:"text-xs text-indigo-700 dark:text-indigo-300"},ne={class:"text-xs text-indigo-700 dark:text-indigo-300"},oe={key:1,class:"text-xs text-center text-indigo-700 dark:text-indigo-300"},re={class:"flex flex-col justify-between p-6 border border-orange-100 bg-orange-50 dark:bg-orange-900/20 rounded-2xl dark:border-orange-800"},ie=["disabled"],le={key:0,class:"flex justify-between mt-1"},de={class:"text-xs text-orange-700 dark:text-orange-300"},ue={class:"text-xs text-orange-700 dark:text-orange-300"},ge={class:"text-xs text-orange-700 dark:text-orange-300"},pe={key:1,class:"mt-3 text-xs text-center text-orange-700 dark:text-orange-300"},be={class:"overflow-hidden bg-white border border-gray-200 shadow-sm dark:bg-gray-800 dark:border-gray-700 rounded-2xl"},me={class:"overflow-x-auto"},ke={class:"w-full text-sm text-left"},xe={class:"divide-y divide-gray-100 dark:divide-gray-700"},ce={class:"px-6 py-4 font-bold text-gray-700 dark:text-gray-300 whitespace-nowrap"},ye={class:"px-6 py-4 font-mono text-xs text-gray-500 dark:text-gray-300"},fe={class:"px-6 py-4"},ve={class:"px-2 py-1 text-xs font-bold text-gray-600 bg-gray-100 rounded dark:bg-gray-700 dark:text-gray-300"},he={class:"flex justify-end gap-2 px-6 py-4 text-right"},we=["onClick"],_e=["href"],Be=["onClick"],Se={key:0},Fe={__name:"BackupRestoreTab",props:{backups:Array,autoBackupEnabled:Boolean,lastRestore:Object,lastBackup:Object,settings:{type:Object,default:()=>({})}},setup(r){const p=r,y=H(),w=j(null),n=j(!1),f=B({message:"Memproses...",subMessage:"Mohon tunggu sebentar..."}),k=(i,t)=>{f.message=i,f.subMessage=t},o=B({show:!1,title:"",message:"",type:"info",confirmText:"Ya, Lanjutkan",onConfirm:null}),v=({title:i,message:t,type:b,confirmText:s,action:_})=>{o.title=i,o.message=t,o.type=b||"info",o.confirmText=s||"Ya, Lanjutkan",o.onConfirm=_,o.show=!0},F=()=>{o.show=!1,o.onConfirm&&o.onConfirm()},a=B({enabled:p.autoBackupEnabled,backup_daily_time:p.settings.backup_daily_time||"22:00",backup_frequency:p.settings.backup_frequency||"3",report_morning_time:p.settings.report_morning_time||"06:30",report_financial_time:p.settings.report_financial_time||"12:30",report_closing_time:p.settings.report_closing_time||"21:00",insight_generate_time:p.settings.insight_generate_time||"21:30"}),C=()=>{k("Menyimpan Pengaturan...","Sedang memperbarui jadwal backup otomatis."),c.post(route("backups.update-setting"),{enabled:a.enabled,backup_daily_time:a.backup_daily_time,backup_frequency:a.backup_frequency,report_morning_time:a.report_morning_time,report_financial_time:a.report_financial_time,report_closing_time:a.report_closing_time,insight_generate_time:a.insight_generate_time},{preserveScroll:!0,onStart:()=>n.value=!0,onFinish:()=>n.value=!1,onSuccess:()=>y.success("Pengaturan jadwal berhasil disimpan!"),onError:()=>y.error("Gagal menyimpan pengaturan.")})},T=()=>{v({title:"Buat Backup Database?",message:"Sistem akan membuat salinan database saat ini. Proses ini aman dilakukan kapan saja.",type:"info",confirmText:"Buat Backup",action:()=>{k("Membuat Backup...","Proses ini mungkin memakan waktu beberapa detik."),n.value=!0,c.post(route("backups.store"),{},{onFinish:()=>n.value=!1,preserveScroll:!0,onSuccess:()=>y.success("Backup berhasil dibuat!")})}})},L=i=>{v({title:"Peringatan Restore Database!",message:"Anda akan mengembalikan database ke titik waktu file ini dibuat. Semua data transaksi SETELAH waktu file tersebut akan HILANG PERMANEN. Apakah Anda yakin?",type:"danger",confirmText:"Ya, Restore Sekarang",action:()=>{k("Memulihkan Database...","Sistem sedang mengembalikan data dari file backup. JANGAN refresh halaman."),n.value=!0,c.post(route("backups.restore",i),{},{onFinish:()=>n.value=!1,preserveScroll:!0})}})},U=()=>w.value.click(),D=i=>{const t=i.target.files[0];t&&v({title:"Upload & Restore?",message:`Anda akan me-restore database menggunakan file "${t.name}". Data saat ini akan ditimpa. Lanjutkan?`,type:"warning",confirmText:"Upload & Restore",action:()=>{const b=new FormData;b.append("backup_file",t),k("Upload & Restore...","Sedang mengupload dan merestore database Anda."),n.value=!0,c.post(route("backups.upload-restore"),b,{onFinish:()=>{n.value=!1,w.value.value=null}})}})},P=i=>{v({title:"Hapus File Backup?",message:"File backup ini akan dihapus permanen dari server dan tidak bisa dikembalikan.",type:"danger",confirmText:"Hapus",action:()=>{k("Menghapus Backup...","Sedang menghapus file dari server."),n.value=!0,c.delete(route("backups.destroy",i),{preserveScroll:!0,onFinish:()=>n.value=!1,onSuccess:()=>y.success("File backup dihapus.")})}})};return(i,t)=>{const b=V("Strong");return d(),l(A,null,[h(J,{show:n.value,message:f.message,subMessage:f.subMessage},null,8,["show","message","subMessage"]),h(q,{show:o.show,title:o.title,message:o.message,type:o.type,confirmText:o.confirmText,onConfirm:F,onClose:t[0]||(t[0]=s=>o.show=!1)},null,8,["show","title","message","type","confirmText"]),e("div",z,[e("div",I,[e("div",$,[e("div",G,[e("div",{class:S(["p-3 rounded-full",a.enabled?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"])},[...t[8]||(t[8]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],2),t[9]||(t[9]=e("div",null,[e("h3",{class:"text-lg font-bold text-gray-800 dark:text-white"},"Jadwal Otomatis"),e("p",{class:"text-sm text-gray-500"},"Atur kapan backup dan laporan digenerate secara otomatis.")],-1))]),e("div",Y,[e("button",{onClick:t[1]||(t[1]=s=>a.enabled=!a.enabled),class:S(["relative inline-flex items-center h-6 transition-colors rounded-full w-11 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",a.enabled?"bg-green-500":"bg-gray-200 dark:bg-gray-700"])},[t[10]||(t[10]=e("span",{class:"sr-only"},"Toggle Backup",-1)),e("span",{class:S(["inline-block w-4 h-4 transition-transform transform bg-white rounded-full",a.enabled?"translate-x-6":"translate-x-1"])},null,2)],2),a.enabled?(d(),l("button",{key:0,onClick:C,disabled:n.value,class:"px-4 py-2 text-sm font-bold text-white transition bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 disabled:opacity-50"}," Simpan Pengaturan ",8,K)):M("",!0)])]),a.enabled?(d(),l("div",W,[e("div",null,[t[11]||(t[11]=e("label",{class:"block mb-1 text-xs font-bold text-gray-500 uppercase"},"Backup Utama (Harian)",-1)),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.backup_daily_time=s),type:"time",class:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,a.backup_daily_time]]),t[12]||(t[12]=e("p",{class:"mt-1 text-xs text-gray-400"},"Backup lengkap (DB + File) + Upload Cloud.",-1))]),e("div",null,[t[14]||(t[14]=e("label",{class:"block mb-1 text-xs font-bold text-gray-500 uppercase"},"Frekuensi Backup Ringan",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.backup_frequency=s),class:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600 dark:text-white"},[...t[13]||(t[13]=[O('<option value="1">Setiap 1 Jam</option><option value="2">Setiap 2 Jam</option><option value="3">Setiap 3 Jam</option><option value="4">Setiap 4 Jam</option><option value="6">Setiap 6 Jam</option><option value="12">Setiap 12 Jam</option>',6)])],512),[[N,a.backup_frequency]]),t[15]||(t[15]=e("p",{class:"mt-1 text-xs text-gray-400"},"Backup Cepat (Hanya DB, Lokal).",-1))]),e("div",null,[t[16]||(t[16]=e("label",{class:"block mb-1 text-xs font-bold text-gray-500 uppercase"},"Generating Laporan Pagi",-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.report_morning_time=s),type:"time",class:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,a.report_morning_time]]),t[17]||(t[17]=e("p",{class:"mt-1 text-xs text-gray-400"},"Rencana Restock & Insight Harian.",-1))]),e("div",null,[t[18]||(t[18]=e("label",{class:"block mb-1 text-xs font-bold text-gray-500 uppercase"},"Laporan Finansial (Siang)",-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.report_financial_time=s),type:"time",class:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,a.report_financial_time]]),t[19]||(t[19]=e("p",{class:"mt-1 text-xs text-gray-400"},"Cek Omzet & Cash Flow siang hari.",-1))]),e("div",null,[t[20]||(t[20]=e("label",{class:"block mb-1 text-xs font-bold text-gray-500 uppercase"},"Generate Insight (Analisa)",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.insight_generate_time=s),type:"time",class:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,a.insight_generate_time]]),t[21]||(t[21]=e("p",{class:"mt-1 text-xs text-gray-400"},"Analisa berat (Dead Stock, Tren) untuk besok.",-1))]),e("div",null,[t[22]||(t[22]=e("label",{class:"block mb-1 text-xs font-bold text-gray-500 uppercase"},"Laporan Closing (Malam)",-1)),m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.report_closing_time=s),type:"time",class:"w-full px-4 py-2 border rounded-lg focus:ring-indigo-500 dark:bg-gray-900 dark:border-gray-600 dark:text-white"},null,512),[[x,a.report_closing_time]]),t[23]||(t[23]=e("p",{class:"mt-1 text-xs text-gray-400"},"Rekap Akhir Hari & Laporan Laba.",-1))])])):(d(),l("div",Q,[e("button",{onClick:C,disabled:n.value,class:"px-4 py-2 text-sm font-bold text-white transition bg-indigo-600 rounded-lg shadow-sm hover:bg-indigo-700 disabled:opacity-50"}," Simpan Perubahan ",8,X)]))]),e("div",Z,[e("div",ee,[t[27]||(t[27]=e("div",null,[e("h4",{class:"mb-1 text-lg font-bold text-indigo-900 dark:text-indigo-100"},"Backup Sekarang"),e("p",{class:"mb-4 text-xs text-indigo-700 dark:text-indigo-300"},"Buat salinan database saat ini secara manual. Disarankan sebelum melakukan perubahan besar.")],-1)),e("button",{onClick:T,disabled:n.value,class:"flex items-center justify-center w-full gap-2 py-2 text-sm font-bold text-white transition bg-indigo-600 rounded-lg shadow-md hover:bg-indigo-700 disabled:opacity-50"},[...t[24]||(t[24]=[e("span",null,"+ Buat Backup Baru",-1)])],8,te),Object.keys(r.lastBackup).length>0?(d(),l("span",ae,[e("p",se,[t[25]||(t[25]=u("Terakhir dibakcup tanggal : ",-1)),e("strong",null,g(r.lastBackup.date),1)]),e("p",ne,[t[26]||(t[26]=u("Oleh : ",-1)),e("strong",null,g(r.lastBackup.user),1)])])):(d(),l("p",oe,"Belum pernah dibackup"))]),e("div",re,[t[32]||(t[32]=e("div",null,[e("h4",{class:"mb-1 text-lg font-bold text-orange-900 dark:text-orange-100"},"Restore dari File"),e("p",{class:"mb-4 text-xs text-orange-700 dark:text-orange-300"},"Punya file backup (.zip) dari komputer lain? Upload disini untuk memulihkan database.")],-1)),e("input",{type:"file",ref_key:"fileInput",ref:w,class:"hidden",accept:".zip",onChange:D},null,544),e("button",{onClick:U,disabled:n.value,class:"flex items-center justify-center w-full gap-2 py-2 text-sm font-bold text-white transition bg-orange-600 rounded-lg shadow-md hover:bg-orange-700 disabled:opacity-50"},[...t[28]||(t[28]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),e("span",null,"Upload & Restore",-1)])],8,ie),Object.keys(r.lastRestore).length>0?(d(),l("span",le,[e("p",de,[t[29]||(t[29]=u("Terakhir dipulihkan tanggal : ",-1)),h(b,null,{default:R(()=>[u(g(r.lastRestore.date),1)]),_:1})]),e("p",ue,[t[30]||(t[30]=u("Oleh : ",-1)),h(b,null,{default:R(()=>[u(g(r.lastRestore.user),1)]),_:1})]),e("p",ge,[t[31]||(t[31]=u("Dari : ",-1)),e("strong",null,g(r.lastRestore.filename),1)])])):(d(),l("p",pe,"Belum pernah pemulihan"))])]),e("div",be,[t[37]||(t[37]=e("div",{class:"p-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800"},[e("h4",{class:"text-sm font-bold text-gray-800 dark:text-white"},"Riwayat Backup (Restore Points)")],-1)),e("div",me,[e("table",ke,[t[36]||(t[36]=e("thead",{class:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-gray-700/50 dark:text-gray-300"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Waktu Backup"),e("th",{class:"px-6 py-3"},"Nama File"),e("th",{class:"px-6 py-3"},"Ukuran"),e("th",{class:"px-6 py-3 text-right"},"Aksi")])],-1)),e("tbody",xe,[(d(!0),l(A,null,E(r.backups,s=>(d(),l("tr",{key:s.name,class:"transition hover:bg-gray-50 dark:hover:bg-gray-700/30"},[e("td",ce,g(s.date),1),e("td",ye,g(s.name),1),e("td",fe,[e("span",ve,g(s.size),1)]),e("td",he,[e("button",{onClick:_=>L(s.name),class:"flex items-center gap-1 px-3 py-1.5 bg-orange-50 border border-orange-200 text-orange-700 rounded-lg hover:bg-orange-100 transition text-xs font-bold",title:"Pulihkan database ke titik ini"},[...t[33]||(t[33]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),u(" Restore ",-1)])],8,we),e("a",{href:i.route("backups.download",s.name),class:"flex items-center gap-1 px-3 py-1.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:text-blue-600 transition text-xs font-bold",title:"Download ke Komputer"},"⬇️",8,_e),e("button",{onClick:_=>P(s.name),class:"p-1.5 text-gray-400 hover:text-red-600 rounded transition",title:"Hapus File"},[...t[34]||(t[34]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Be)])]))),128)),!r.backups||r.backups.length===0?(d(),l("tr",Se,[...t[35]||(t[35]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-400"},"Belum ada file backup tersimpan.",-1)])])):M("",!0)])])])])])],64)}}};export{Fe as default};
