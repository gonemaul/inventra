import{_ as S}from"./AuthenticatedLayout-CL35wTeb.js";import{x,s as b,z as v,j as O,g as f,o as p,a as l,d as h,h as F,w as i,b as a,l as V,f as u,t as c,i as C,F as $}from"./app-OOVJa1pD.js";import{_ as N}from"./DataTable-DdkiKaOx.js";import{_ as R}from"./Filter-DZHBq5Rl.js";import T from"./modalFilter-CAGpBgRV.js";import{u as B}from"./useActionLoading-1e1XIs5r.js";import{l as k}from"./lodash-DyM2-MAi.js";import"./TextInput-DJ0hRKLP.js";import"./PrimaryButton-cGu7IqtH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-CeAPgi98.js";const E={class:"w-full min-h-screen space-y-6"},P={class:"p-4 space-y-6 bg-gray-100 border shadow-md rounded-xl dark:bg-customBg-tableDark"},A={class:"font-mono text-sm font-bold text-indigo-600 dark:text-indigo-400"},D=["title"],K={key:0,class:"my-4 text-sm text-gray-600 dark:text-gray-200 whitespace-nowrap"},L={key:1,class:"text-xs text-gray-400"},Y={__name:"index",props:{filters:Object,sales:Object},setup(o){const r=o,d=x(r.filters.search||""),g=x(!1),{isActionLoading:y}=B(),_=[{key:"transaction_date",label:"Tanggal",sortable:!0,format:"tanggal",width:"130px"},{key:"reference_no",label:"No. Referensi",sortable:!0,slot:"reference",width:"130px"},{key:"summary",label:"Summary",slot:"Summary",width:"130px"},{key:"total_revenue",label:"Total Omset",sortable:!0,format:"rupiah"},{key:"aksi",label:"Aksi",width:"120px",slot:"aksi"}],m=x({search:r.filters.search||"",sort:r.filters.sort||"transaction_date",order:r.filters.order||"desc",page:r.sales.current_page||1}),w=k.throttle(()=>{const s={...r.filters};s.search=d.value,s.search||delete s.search,b.get(route("sales.index"),s,{preserveState:!0,replace:!0})},300);v(m,k.throttle(s=>{const e=Object.fromEntries(Object.entries(s).filter(([t,n])=>n!=null&&n!==""));y.value=!0,b.get(route("sales.index"),e,{preserveState:!0,preserveScroll:!0,replace:!0,only:["sales","filters"],onFinish:()=>{y.value=!1}})},300),{deep:!0}),v(d,w);const j=O(()=>{Object.fromEntries(Object.entries(m).filter(([t,n])=>n!=null&&n!==""));const s=Object.keys(r.filters),e=["search","page","per_page"];return s.filter(t=>!e.includes(t)).length});return(s,e)=>(p(),f($,null,[l(h(F),{title:"Riwayat Penjualan"}),l(S,{headerTitle:"Riwayat Penjualan"},{default:i(()=>[a("div",E,[l(R,{filters:o.filters,modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),onShowFilter:e[1]||(e[1]=t=>g.value=!0),filterCount:j.value,actions:[{route:s.route("sales.create"),buttonText:"Rekap"}]},null,8,["filters","modelValue","filterCount","actions"]),l(T,{show:g.value,onClose:e[2]||(e[2]=t=>g.value=!1),filters:o.filters},null,8,["show","filters"]),a("div",P,[e[9]||(e[9]=a("div",null,[a("h2",{class:"text-base font-semibold text-gray-900 dark:text-white sm:text-lg lg:text-xl"}," Riwayat Penjualan "),a("p",{class:"mt-1 text-xs text-gray-600 dark:text-gray-300 sm:text-sm lg:text-base"}," Kelola semua riwayat penjualan. ")],-1)),l(N,{serverSide:"true",data:o.sales.data,columns:_,perPageOptions:[5,10,25,50,100],params:m.value,"onUpdate:params":e[3]||(e[3]=t=>m.value=t),pagination:o.sales},{reference:i(({row:t})=>[a("div",A,c(t.reference_no),1),t.notes?(p(),f("div",{key:0,class:"text-xs text-gray-500 truncate max-w-[150px]",title:t.notes}," ğŸ“ "+c(t.notes),9,D)):C("",!0)]),Summary:i(({row:t})=>[t.financial_summary?(p(),f("div",K,[a("div",null,[e[4]||(e[4]=u(" Item: ",-1)),a("strong",null,c(t.financial_summary.item_count),1),e[5]||(e[5]=u(" Jenis ",-1))]),a("div",null,[e[6]||(e[6]=u(" Qty: ",-1)),a("strong",null,c(t.financial_summary.total_qty),1),e[7]||(e[7]=u(" Unit ",-1))])])):(p(),f("span",L,"-"))]),aksi:i(({row:t})=>[l(h(V),{href:s.route("sales.show",t.id),class:"px-3 py-1 text-sm font-medium text-indigo-600 transition border border-indigo-200 rounded hover:text-indigo-900 hover:bg-indigo-300"},{default:i(()=>[...e[8]||(e[8]=[u(" Lihat Detail ",-1)])]),_:2},1032,["href"])]),_:1},8,["data","params","pagination"])])])]),_:1})],64))}};export{Y as default};
