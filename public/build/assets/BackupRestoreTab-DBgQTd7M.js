import{x as B,g as n,o as l,b as e,n as d,f as p,t as u,d as g,i as b,F as A,q as C,s as i}from"./app-CKedD50u.js";import{u as F}from"./useActionLoading-BwM9d4Sa.js";const E={class:"space-y-8 animate-fade-in"},S={class:"flex items-center justify-between p-6 bg-white border border-gray-200 shadow-sm dark:bg-gray-800 rounded-2xl dark:border-gray-700"},j={class:"flex items-center gap-4"},_={class:"text-sm text-gray-500"},I=["disabled"],L={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},N={class:"flex flex-col justify-between p-6 border border-indigo-100 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl dark:border-indigo-800"},R=["disabled"],M={key:0,class:"w-4 h-4 animate-spin",viewBox:"0 0 24 24"},T={class:"flex flex-col justify-between p-6 border border-orange-100 bg-orange-50 dark:bg-orange-900/20 rounded-2xl dark:border-orange-800"},H=["disabled"],D={class:"overflow-hidden bg-white border border-gray-200 shadow-sm dark:bg-gray-800 dark:border-gray-700 rounded-2xl"},K={class:"overflow-x-auto"},U={class:"w-full text-sm text-left"},z={class:"divide-y divide-gray-100 dark:divide-gray-700"},V={class:"px-6 py-4 font-bold text-gray-700 dark:text-gray-300 whitespace-nowrap"},P={class:"px-6 py-4 font-mono text-xs text-gray-500"},Z={class:"px-6 py-4"},$={class:"px-2 py-1 text-xs font-bold text-gray-600 bg-gray-100 rounded dark:bg-gray-700 dark:text-gray-300"},G={class:"flex justify-end gap-2 px-6 py-4 text-right"},O=["onClick"],q=["href"],J=["onClick"],W={key:0},Y={__name:"BackupRestoreTab",props:{backups:Array,autoBackupEnabled:Boolean},setup(o){const k=o,c=B(null),{isActionLoading:a}=F(),x=()=>{i.post(route("backups.update-setting"),{enabled:!k.autoBackupEnabled},{preserveScroll:!0,onStart:()=>a.value=!0,onFinish:()=>a.value=!1})},f=()=>{confirm("Buat backup database sekarang?")&&(a.value=!0,i.post(route("backups.store"),{},{onFinish:()=>a.value=!1,preserveScroll:!0}))},m=r=>{confirm(`⚠️ PERINGATAN KERAS!

Anda akan me-restore database ke titik waktu file ini dibuat.
Semua data transaksi SETELAH waktu file tersebut akan HILANG dan TIDAK BISA KEMBALI.

Apakah Anda yakin ingin melanjutkan?`)&&(a.value=!0,i.post(route("backups.restore",r),{},{onFinish:()=>a.value=!1,preserveScroll:!0}))},y=()=>c.value.click(),v=r=>{const t=r.target.files[0];if(t&&confirm(`Upload file "${t.name}" dan restore database menggunakan file ini?`)){const s=new FormData;s.append("backup_file",t),a.value=!0,i.post(route("backups.upload-restore"),s,{onFinish:()=>{a.value=!1,c.value.value=null}})}},h=r=>{confirm("Hapus file backup ini permanen?")&&(a.value=!0,i.delete(route("backups.destroy",r),{preserveScroll:!0,onFinish:()=>a.value=!1}))};return(r,t)=>(l(),n("div",E,[e("div",S,[e("div",j,[e("div",{class:d(["p-3 rounded-full",o.autoBackupEnabled?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"])},[...t[0]||(t[0]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],2),e("div",null,[t[2]||(t[2]=e("h3",{class:"text-lg font-bold text-gray-800 dark:text-white"}," Backup Otomatis ",-1)),e("p",_,[t[1]||(t[1]=p(" Status: ",-1)),e("span",{class:d(["font-bold",o.autoBackupEnabled?"text-green-600":"text-gray-400"])},u(o.autoBackupEnabled?"AKTIF (Setiap Jam 22:00)":"NON-AKTIF"),3)])])]),e("button",{onClick:x,disabled:g(a).value==!0,class:d(["relative inline-flex items-center h-6 transition-colors rounded-full w-11 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",o.autoBackupEnabled?"bg-green-500":"bg-gray-200 dark:bg-gray-700"])},[t[3]||(t[3]=e("span",{class:"sr-only"},"Toggle Backup",-1)),e("span",{class:d(["inline-block w-4 h-4 transition-transform transform bg-white rounded-full",o.autoBackupEnabled?"translate-x-6":"translate-x-1"])},null,2)],10,I)]),e("div",L,[e("div",N,[t[6]||(t[6]=e("div",null,[e("h4",{class:"mb-1 text-lg font-bold text-indigo-900 dark:text-indigo-100"}," Backup Sekarang "),e("p",{class:"mb-4 text-xs text-indigo-700 dark:text-indigo-300"}," Buat salinan database saat ini secara manual. Disarankan sebelum melakukan perubahan besar. ")],-1)),e("button",{onClick:f,disabled:g(a).value==!0,class:"flex items-center justify-center w-full gap-2 py-2 text-sm font-bold text-white transition bg-indigo-600 rounded-lg shadow-md hover:bg-indigo-700 disabled:opacity-50"},[g(a).value==!0?(l(),n("svg",M,[...t[4]||(t[4]=[e("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".3"},null,-1),e("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},null,-1)])])):b("",!0),t[5]||(t[5]=e("span",null,"+ Buat Backup Baru",-1))],8,R)]),e("div",T,[t[8]||(t[8]=e("div",null,[e("h4",{class:"mb-1 text-lg font-bold text-orange-900 dark:text-orange-100"}," Restore dari File "),e("p",{class:"mb-4 text-xs text-orange-700 dark:text-orange-300"}," Punya file backup (.zip) dari komputer lain? Upload disini untuk memulihkan database. ")],-1)),e("input",{type:"file",ref_key:"fileInput",ref:c,class:"hidden",accept:".zip",onChange:v},null,544),e("button",{onClick:y,disabled:g(a).value==!0,class:"flex items-center justify-center w-full gap-2 py-2 text-sm font-bold text-white transition bg-orange-600 rounded-lg shadow-md hover:bg-orange-700 disabled:opacity-50"},[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),e("span",null,"Upload & Restore",-1)])],8,H)])]),e("div",D,[t[13]||(t[13]=e("div",{class:"p-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800"},[e("h4",{class:"text-sm font-bold text-gray-800 dark:text-white"}," Riwayat Backup (Restore Points) ")],-1)),e("div",K,[e("table",U,[t[12]||(t[12]=e("thead",{class:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-gray-700/50"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Waktu Backup"),e("th",{class:"px-6 py-3"},"Nama File"),e("th",{class:"px-6 py-3"},"Ukuran"),e("th",{class:"px-6 py-3 text-right"},"Aksi")])],-1)),e("tbody",z,[(l(!0),n(A,null,C(o.backups,s=>(l(),n("tr",{key:s.name,class:"transition hover:bg-gray-50 dark:hover:bg-gray-700/30"},[e("td",V,u(s.date),1),e("td",P,u(s.name),1),e("td",Z,[e("span",$,u(s.size),1)]),e("td",G,[e("button",{onClick:w=>m(s.name),class:"flex items-center gap-1 px-3 py-1.5 bg-orange-50 border border-orange-200 text-orange-700 rounded-lg hover:bg-orange-100 transition text-xs font-bold",title:"Pulihkan database ke titik ini"},[...t[9]||(t[9]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),p(" Restore ",-1)])],8,O),e("a",{href:r.route("backups.download",s.name),class:"flex items-center gap-1 px-3 py-1.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:text-blue-600 transition text-xs font-bold",title:"Download ke Komputer"}," ⬇️ ",8,q),e("button",{onClick:w=>h(s.name),class:"p-1.5 text-gray-400 hover:text-red-600 rounded transition",title:"Hapus File"},[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,J)])]))),128)),!o.backups||o.backups.length===0?(l(),n("tr",W,[...t[11]||(t[11]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-gray-400"}," Belum ada file backup tersimpan. ",-1)])])):b("",!0)])])])])]))}};export{Y as default};
