import{x as d,s as y,z as m,j as C,g as O,o as f,a as n,d as g,h as V,w as o,b as a,k as F,v as T,c as k,l as v,f as _,n as $,t as b,F as D}from"./app-DSv40uao.js";import{_ as A}from"./AuthenticatedLayout-Cu7kgtZV.js";import{_ as N}from"./DataTable-U7G4-E6T.js";import{_ as P}from"./Filter-xSpIrjB4.js";import U from"./modalFilter-CFT4Z--O.js";import{u as E}from"./useActionLoading-PoEUsbxM.js";import{l as S}from"./lodash-KZkFHjaB.js";import"./TextInput-udOVDXCM.js";import"./PrimaryButton-BnPLrvqI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-P8BHQgyt.js";const K={class:"w-full min-h-screen space-y-6"},L={class:"p-4 space-y-6 bg-gray-100 border shadow-md rounded-xl dark:bg-customBg-tableDark"},z={class:"flex items-center space-x-2 cursor-pointer"},M={class:"flex flex-col"},R={class:"font-medium"},q={class:"text-xs text-gray-500"},G={class:"inline-flex w-full gap-2"},ae={__name:"index",props:{dropdowns:Object,filters:Object,purchases:Object},setup(l){const r=l,u=d(r.filters.search||""),p=d(!1),{isActionLoading:x}=E(),c=d(!1),w=[{key:"transaction_date",label:"Tanggal Order",sortable:!0,format:"tanggal"},{key:"reference_no",label:"No. Referensi",sortable:!0},{key:"supplier",label:"Supplier",slot:"supplier"},{key:"grand_total",label:"Total Belanja",sortable:!0,format:"rupiah"},{key:"status",label:"Status",sortable:!0,slot:"status"},{key:"aksi",label:"Aksi",width:"120px",slot:"aksi"}],i=d({search:r.filters.search||"",sort:r.filters.sort||"transaction_date",order:r.filters.order||"desc",page:r.purchases.current_page||1}),j=S.throttle(()=>{const s={...r.filters};s.search=u.value,s.search||delete s.search,y.get(route("purchases.index"),s,{preserveState:!0,replace:!0})},300);m(c,s=>{s===!0?i.value.trashed=!0:delete i.value.trashed}),m(i,S.throttle(s=>{const t=Object.fromEntries(Object.entries(s).filter(([e,h])=>h!=null&&h!==""));x.value=!0,y.get(route("purchases.index"),t,{preserveState:!0,preserveScroll:!0,replace:!0,only:["purchases","filters"],onFinish:()=>{x.value=!1}})},300),{deep:!0}),m(u,j);const B=C(()=>{const s=Object.keys(r.filters),t=["search","page","per_page"];return s.filter(e=>!t.includes(e)).length});return(s,t)=>(f(),O(D,null,[n(g(V),{title:"Pembelian"}),n(A,{headerTitle:"Pembelian"},{default:o(()=>[a("div",K,[n(P,{filters:l.filters,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),onShowFilter:t[1]||(t[1]=e=>p.value=!0),filterCount:B.value,actions:[{route:s.route("purchases.create"),buttonText:"RAB"}]},null,8,["filters","modelValue","filterCount","actions"]),n(U,{show:p.value,onClose:t[2]||(t[2]=e=>p.value=!1),filters:l.filters,dropdowns:l.dropdowns},null,8,["show","filters","dropdowns"]),a("div",L,[a("div",null,[t[6]||(t[6]=a("h2",{class:"text-base font-semibold text-gray-900 dark:text-white sm:text-lg lg:text-xl"}," Daftar Pembelian ",-1)),t[7]||(t[7]=a("p",{class:"mt-1 text-xs text-gray-600 dark:text-gray-300 sm:text-sm lg:text-base"}," Kelola semua pembelian. ",-1)),a("label",z,[F(a("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>c.value=e),class:"rounded dark:bg-gray-900 border-gray-300 dark:border-gray-700 ..."},null,512),[[T,c.value]]),t[5]||(t[5]=a("span",{class:"text-sm text-gray-600 dark:text-gray-400"}," Tampilkan Sampah ",-1))])]),n(N,{serverSide:"true",data:l.purchases.data,columns:w,perPageOptions:[5,10,25,50,100],params:i.value,"onUpdate:params":t[4]||(t[4]=e=>i.value=e),pagination:l.purchases},{supplier:o(({row:e})=>[a("div",M,[a("span",R,b(e.supplier?e.supplier.name:"Umum/Cash"),1),a("span",q,b(e.supplier?e.supplier.phone:"-"),1)])]),status:o(({row:e})=>[a("span",{class:$(["px-2 py-1 text-xs font-bold uppercase rounded",{"bg-gray-200 text-gray-600":e.status==="draft","bg-blue-100 text-blue-600":e.status==="dipesan","bg-yellow-100 text-yellow-600":e.status==="dikirim","bg-purple-100 text-purple-600":e.status==="diterima","bg-teal-100 text-teal-600":e.status==="checking","bg-green-100 text-green-600":e.status==="selesai","bg-red-100 text-red-600":e.status==="dibatalkan"}])},b(e.status),3)]),aksi:o(({row:e})=>[a("div",G,[e.status=="checking"?(f(),k(g(v),{key:0,href:s.route("purchases.checking",e.id),class:"px-3 py-1 text-sm font-medium text-teal-600 transition border border-teal-200 rounded hover:text-teal-900 hover:bg-teal-300"},{default:o(()=>[...t[8]||(t[8]=[_(" Validasi Barang ",-1)])]),_:2},1032,["href"])):(f(),k(g(v),{key:1,href:s.route("purchases.show",e.id),class:"px-3 py-1 text-sm font-medium text-indigo-600 transition border border-indigo-200 rounded hover:text-indigo-900 hover:bg-indigo-300"},{default:o(()=>[...t[9]||(t[9]=[_(" Lihat Detail ",-1)])]),_:2},1032,["href"]))])]),_:1},8,["data","params","pagination"])])])]),_:1})],64))}};export{ae as default};
