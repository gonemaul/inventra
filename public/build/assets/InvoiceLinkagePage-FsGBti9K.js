import{y as te,x as h,j as P,u as j,C as ae,z as se,g as o,o as l,a as _,d as re,h as oe,w as U,b as e,s as w,f as I,i as p,e as M,F as H,q as A,t as s,k as V,A as O,v as E,n as S}from"./app-CHQSHO3f.js";import{_ as le}from"./AuthenticatedLayout-CCTW-xu6.js";import{P as ie}from"./PrimaryButton-DaDid8Yi.js";import{_ as ne}from"./SecondaryButton-_tqmZGEj.js";import{_ as de}from"./ImageModal-C5CzFcDR.js";import{u as ue}from"./useActionLoading-Bk-hXxe0.js";import{l as ce}from"./lodash-C8CUMwmO.js";import pe from"./search-50o8DFVP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-B3iekFlk.js";import"./TextInput-BtDNOho4.js";const ve={class:"flex items-center justify-between mb-4"},ge={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},he={class:"space-y-6 lg:col-span-2"},be={class:"flex flex-col h-full bg-white border border-gray-200 shadow-sm rounded-2xl dark:bg-gray-800 dark:border-gray-700"},me={class:"flex items-center justify-between px-5 py-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800"},xe={key:0,class:"px-2 py-1 text-[10px] font-bold bg-gray-100 text-gray-500 rounded border"},ye={key:0,class:"flex flex-col items-center justify-center flex-1 py-12 text-center"},ke={class:"flex-1 overflow-auto custom-scrollbar"},fe={class:"w-full text-sm text-left"},we={class:"sticky top-0 z-10 text-xs font-bold text-gray-500 uppercase border-b bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300"},_e={key:0,class:"w-10 px-2 py-3 text-center"},Ie={class:"divide-y divide-gray-100 dark:divide-gray-700"},Se={class:"px-4 py-3 align-top"},Ce={class:"text-sm font-bold text-gray-800 dark:text-white line-clamp-2"},Te={class:"text-[13px] text-gray-600 dark:text-gray-200 mt-0.5 flex flex-wrap gap-1"},je={class:"bg-gray-100 dark:bg-gray-700 px-1.5 rounded"},Me={key:0},Ve={class:"mt-2 space-y-1"},Le={key:0,class:"flex items-center text-[10px] text-red-600 font-bold bg-red-50 w-fit px-1.5 rounded"},Be={key:1,class:"flex items-center text-[10px] text-green-600 font-bold bg-green-50 w-fit px-1.5 rounded"},Fe={key:2,class:"text-[10px] text-orange-600 font-bold flex items-center"},Ne={key:3,class:"text-[10px] text-purple-600 font-bold flex items-center"},Pe={class:"px-2 py-3 align-top"},Ue=["onUpdate:modelValue","disabled"],He={class:"text-[10px] text-center text-gray-400 mt-1"},$e={class:"px-2 py-3 align-top"},qe={class:"relative"},De=["onUpdate:modelValue","disabled"],ze={class:"text-[10px] text-right text-gray-400 mt-1"},Ae={key:0,class:"px-2 py-3 text-center align-middle"},Oe=["value"],Ee={key:0,class:"flex items-center justify-between gap-3 p-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800"},Qe=["disabled"],Re={class:"flex gap-2"},Ke=["disabled"],Ge=["disabled"],Je={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},We={class:"space-y-6 lg:col-span-1"},Xe={class:"relative flex flex-col p-5 bg-white border border-gray-200 shadow-sm rounded-2xl dark:bg-gray-800 dark:border-gray-700"},Ye={class:"flex items-start justify-between pb-3 mb-4 border-b border-gray-100 dark:border-gray-700"},Ze={class:"flex items-center gap-2"},et={class:"text-xl font-black tracking-tight text-gray-800 dark:text-white"},tt={key:0,class:"flex items-center justify-center w-6 h-6 text-teal-500 border border-teal-100 rounded-full bg-teal-50 dark:bg-teal-900/30 dark:border-teal-800",title:"Tervalidasi (Data Fisik & Sistem Cocok)"},at={class:"grid grid-cols-1 gap-3 mb-4 text-sm"},st={class:"flex items-center gap-3"},rt={class:"font-bold text-gray-800 dark:text-white"},ot={class:"w-40 text-xs text-gray-500 truncate dark:text-gray-400"},lt={class:"flex items-center justify-between p-2 text-xs border border-gray-100 rounded-lg bg-gray-50 dark:bg-gray-700/50 dark:border-gray-600"},it={class:"flex flex-col"},nt={class:"font-bold text-gray-700 dark:text-gray-300"},dt={class:"flex flex-col text-right"},ut={class:"font-bold text-red-600 dark:text-red-400"},ct={class:"mt-2 space-y-2"},pt={class:"flex items-center justify-between text-xs"},vt={class:"font-bold text-gray-800 dark:text-white"},gt={class:"flex items-center justify-between text-xs"},ht={class:"font-medium text-gray-500 dark:text-gray-400"},bt={class:"font-bold text-blue-600 dark:text-blue-400"},mt={class:"flex items-center justify-between text-sm font-black"},xt={key:0,class:"mt-auto"},yt=["src"],kt={key:0,class:"p-4 border-2 rounded-lg shadow-lg border-lime-100 bg-lime-50 dark:bg-lime-900/30"},ft={key:1,class:"p-6 bg-white border-2 border-gray-100 rounded-lg shadow-lg dark:bg-gray-800"},wt={key:0,class:"py-4 text-center text-gray-500"},_t={key:1,class:"overflow-y-auto border rounded max-h-48 dark:border-gray-700"},It={class:"p-2 space-y-1"},St=["for"],Ct=["id","value"],Tt={class:"flex flex-col flex-1"},jt={class:"font-medium text-gray-900 dark:text-white"},Mt={class:"flex items-center justify-between mt-1 text-xs"},Vt={class:"text-gray-600 dark:text-gray-400"},Lt={class:"font-bold text-gray-800 dark:text-gray-200"},Bt={key:2,class:"flex justify-end mt-4"},Et={__name:"InvoiceLinkagePage",props:{purchase:Object,invoice:Object,unlinkedItems:Object,linkedItems:Object,products:{type:Array,default:()=>[]}},setup(r){const n=r,{isActionLoading:v}=ue(),d=te(),u=h(!1),x=P(()=>n.purchase.status==="checking"?"edit":"detail"),g=h([]),b=h([]),y=h([]),Q=h(!1),f=h(""),C=h([]),L=h(!1),T=j({ids:[],type:"link"}),B=j({product_id:[],type:"create"}),F=j({item_ids:[]}),$=j({items:g});ae(()=>{g.value=JSON.parse(JSON.stringify(n.linkedItems))});const k=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(i),q=i=>i?new Date(i).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}):"-",R=()=>w.get(route("purchases.checking",n.purchase.id)),m=P(()=>g.value.reduce((i,t)=>{const a=(t.quantity||0)*(t.purchase_price||0);return i+a},0)),K=P(()=>g.value.reduce((i,t)=>i+(t.quantity||0),0)),N=h(!1),D=h(null),z=h(null),G=(i,t)=>{D.value=i,z.value="Invoice-#"+t,N.value=!0},J=()=>{if(b.value.length===0){d.error("Pilih minimal satu item untuk ditautkan.");return}T.ids=[],T.ids=b.value,console.log(T.ids),v.value=!0,u.value=!0,T.post(route("purchases.linkItems",{purchase:n.purchase.id,invoice:n.invoice.id}),{preserveScroll:!0,onSuccess:()=>{d.success(`${b.value.length} item berhasil ditautkan. Harga otomatis diperbarui.`),w.visit(window.location.href,{preserveScroll:!0,preserveState:!1})},onError:i=>{d.success(`Terdapat kesalahan : ${i}`),console.log(i)},onFinish:()=>{u.value=!1,v.value=!1,b.value=[]}})},W=()=>{if(y.value.length===0){d.error("Pilih minimal satu item untuk dilepaskan.");return}F.item_ids=[],F.item_ids=y.value,v.value=!0,u.value=!0,F.put(route("purchases.unlinkItems",{purchase:n.purchase.id,invoice:n.invoice.id}),{preserveScroll:!0,onSuccess:()=>{d.warning(`${y.value.length} item dilepaskan. Harga item lain tidak berubah.`),w.visit(window.location.href,{preserveScroll:!0,preserveState:!1})},onFinish:()=>{u.value=!1,v.value=!1,y.value=[]}})},X=()=>{if(v.value=!0,u.value=!0,g.value.some(t=>t.quantity<0)){d.error("Kuantitas yang diterima tidak boleh kurang dari nol."),u.value=!1,v.value=!1;return}$.items=g.value,$.put(route("purchases.updateLinkedItemDetails",{purchase:n.purchase.id,invoice:n.invoice.id}),{preserveScroll:!0,onSuccess:()=>{d.success(`${g.value.length} Produk berhasil diperbarui!`),w.reload({only:["linkedItems"]})},onFinish:()=>{u.value=!1,v.value=!1}})},Y=ce.throttle(()=>{if(f.value.length<2){C.value=[];return}L.value=!0,C.value=n.products.filter(i=>i.name.toLowerCase().includes(f.value.toLowerCase())||i.code.toLowerCase().includes(f.value.toLowerCase())).slice(0,5),L.value=!1},300);se(f,Y);const Z=i=>{const t=g.value.some(c=>c.product_id===i.id);if(n.unlinkedItems.some(c=>c.product_id===i.id)){d.warning("Produk ini sudah ada di daftar pembelian. Tautkan untuk menambahkan ke invoice.");return}if(t){d.warning("Produk ini sudah ada di daftar. Gunakan input Qty untuk menambah.");return}B.product_id=[],B.product_id=[i.id],v.value=!0,u.value=!0,B.post(route("purchases.linkItems",{purchase:n.purchase.id,invoice:n.invoice.id}),{preserveScroll:!0,onSuccess:()=>{d.success("Produk berhasil ditambahkan kedalam Invoice"),w.visit(window.location.href,{preserveScroll:!0,preserveState:!1})},onError:c=>{d.success(`Terdapat kesalahan : ${c}`),console.log(c)},onFinish:()=>{u.value=!1,v.value=!1,b.value=[]}}),f.value="",C.value=[],Q.value=!1},ee=()=>{if(n.invoice.status==="validated"){d.error("Invoice yang sudah berstatus 'validated' tidak dapat divalidasi ulang.");return}if(g.value.length===0){d.error("Tidak dapat memvalidasi invoice tanpa item tertaut.");return}if(m.value!==n.invoice.total_amount){d.error("Total nominal item tertaut tidak sesuai dengan total nota. Silakan koreksi terlebih dahulu.");return}if(n.purchase.status!=="checking"){d.error("Hanya invoice pada pembelian dengan status 'checking' yang dapat divalidasi.");return}v.value=!0,u.value=!0,w.put(route("purchases.validateInvoice",{purchase:n.purchase.id,invoice:n.invoice.id}),{preserveScroll:!0,onSuccess:()=>{d.success("Invoice berhasil divalidasi!"),w.visit(route("purchases.validate",n.purchase.id),{preserveScroll:!0,preserveState:!1})},onFinish:()=>{u.value=!1,v.value=!1}})};return(i,t)=>(l(),o(H,null,[_(de,{show:N.value,imageUrl:D.value,productName:z.value,onClose:t[0]||(t[0]=a=>N.value=!1)},null,8,["show","imageUrl","productName"]),_(re(oe),{title:`Invoice #${r.invoice.invoice_number}`},null,8,["title"]),_(le,{headerTitle:`Invoice : #${r.invoice.invoice_number}`,showSidebar:!1},{default:U(()=>[e("div",ve,[_(ne,{onClick:R},{default:U(()=>[...t[5]||(t[5]=[I(" â† Kembali ke Validasi Utama ",-1)])]),_:1})]),e("div",ge,[e("div",he,[e("div",be,[e("div",me,[t[6]||(t[6]=e("div",null,[e("h3",{class:"text-lg font-bold text-gray-800 dark:text-white"}," Item Terhubung "),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Sesuaikan Qty dan Harga sesuai fisik barang. ")],-1)),r.linkedItems.length===0?(l(),o("span",xe," KOSONG ")):p("",!0)]),r.linkedItems.length===0?(l(),o("div",ye,[...t[7]||(t[7]=[e("div",{class:"flex items-center justify-center w-12 h-12 mb-3 bg-gray-100 rounded-full dark:bg-gray-700"},[e("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1),e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-300"}," Belum ada item tertaut. ",-1),e("p",{class:"mt-1 text-xs text-gray-400"}," Pilih item dari daftar di sebelah kanan. ",-1)])])):(l(),o("form",{key:1,onSubmit:M(X,["prevent"]),class:"flex flex-col flex-1 min-h-0"},[e("div",ke,[e("table",fe,[e("thead",we,[e("tr",null,[t[9]||(t[9]=e("th",{class:"px-4 py-3"},"Produk",-1)),t[10]||(t[10]=e("th",{class:"w-24 px-2 py-3 text-center"}," Qty Fisik ",-1)),t[11]||(t[11]=e("th",{class:"w-32 px-2 py-3 text-right"}," Harga Satuan ",-1)),x.value==="edit"?(l(),o("th",_e,[...t[8]||(t[8]=[e("svg",{class:"w-4 h-4 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])):p("",!0)])]),e("tbody",Ie,[(l(!0),o(H,null,A(g.value,a=>(l(),o("tr",{key:a.id,class:"transition group hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",Se,[e("div",null,[e("p",Ce,s(a.product_snapshot.brand+" "+a.product_snapshot.name+" "+a.product_snapshot.size),1),e("div",Te,[e("span",je,s(a.product_snapshot.code),1),e("span",null,s(a.product_snapshot.brand),1),a.product_snapshot.size?(l(),o("span",Me,"â€¢ "+s(a.product_snapshot.size),1)):p("",!0),e("span",null,"| "+s(a.product_snapshot.category)+" | "+s(a.product_snapshot.productType),1)]),e("div",Ve,[a.purchase_price>(a.product_snapshot.purchase_price||0)?(l(),o("div",Le,[t[12]||(t[12]=e("span",{class:"mr-1"},"ðŸ“ˆ",-1)),I(" Naik "+s(k(a.purchase_price-a.product_snapshot.purchase_price)),1)])):a.purchase_price<(a.product_snapshot.purchase_price||0)?(l(),o("div",Be,[t[13]||(t[13]=e("span",{class:"mr-1"},"ðŸ“‰",-1)),I(" Turun "+s(k(a.product_snapshot.purchase_price-a.purchase_price)),1)])):p("",!0),a.quantity<(a.product_snapshot.stock||0)?(l(),o("div",Fe,[t[14]||(t[14]=e("span",{class:"w-1.5 h-1.5 bg-orange-500 rounded-full mr-1"},null,-1)),I(" Kurang "+s((a.product_snapshot.stock||0)-a.quantity)+" (Parsial) ",1)])):a.quantity>(a.product_snapshot.stock||0)?(l(),o("div",Ne,[t[15]||(t[15]=e("span",{class:"w-1.5 h-1.5 bg-purple-500 rounded-full mr-1"},null,-1)),I(" Lebih "+s(a.quantity-(a.product_snapshot.stock||0))+" (Bonus) ",1)])):p("",!0)])])]),e("td",Pe,[V(e("input",{type:"number","onUpdate:modelValue":c=>a.quantity=c,disabled:x.value!=="edit",class:"w-full text-sm font-bold text-center border-gray-300 rounded-lg focus:ring-lime-500 focus:border-lime-500 disabled:bg-gray-100 disabled:text-gray-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",min:"0"},null,8,Ue),[[O,a.quantity,void 0,{number:!0}]]),e("div",He," Target: "+s(a.product_snapshot.stock||0),1)]),e("td",$e,[e("div",qe,[t[16]||(t[16]=e("span",{class:"absolute text-xs text-gray-400 left-2 top-2"},"Rp",-1)),V(e("input",{type:"number","onUpdate:modelValue":c=>a.purchase_price=c,disabled:x.value!=="edit",class:"w-full pl-7 pr-2 py-1.5 text-right text-sm font-medium border-gray-300 rounded-lg focus:ring-lime-500 focus:border-lime-500 disabled:bg-gray-100 disabled:text-gray-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,8,De),[[O,a.purchase_price,void 0,{number:!0}]])]),e("div",ze," Awal: "+s(k(a.product_snapshot.purchase_price||0)),1)]),x.value==="edit"?(l(),o("td",Ae,[V(e("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":t[1]||(t[1]=c=>y.value=c),class:"w-4 h-4 text-red-600 transition border-gray-300 rounded cursor-pointer focus:ring-red-500 hover:scale-110"},null,8,Oe),[[E,y.value]])])):p("",!0)]))),128))])])]),x.value==="edit"?(l(),o("div",Ee,[e("button",{onClick:M(W,["prevent"]),disabled:y.value.length===0||u.value,class:"flex items-center gap-2 px-3 py-2 text-xs font-bold text-red-600 transition border border-red-200 rounded-lg bg-red-50 hover:bg-red-100 disabled:opacity-50 disabled:cursor-not-allowed"},[t[17]||(t[17]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),e("span",null,"Lepas ("+s(y.value.length)+")",1)],8,Qe),e("div",Re,[e("button",{onClick:M(ee,["prevent"]),disabled:g.value.length===0||n.invoice.status==="validated",class:"px-4 py-2 text-xs font-bold text-white transition bg-teal-500 rounded-lg shadow-sm hover:bg-teal-600 disabled:opacity-50 disabled:cursor-not-allowed"}," Validasi Invoice ",8,Ke),e("button",{type:"submit",disabled:u.value,class:"flex items-center gap-2 px-4 py-2 text-xs font-bold text-white transition transform rounded-lg shadow-md bg-lime-500 hover:bg-lime-600 shadow-lime-200 dark:shadow-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"},[u.value?(l(),o("svg",Je,[...t[18]||(t[18]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):p("",!0),t[19]||(t[19]=e("span",null,"Simpan Perubahan",-1))],8,Ge)])])):p("",!0)],32))])]),e("div",We,[e("div",Xe,[e("div",Ye,[e("div",null,[t[21]||(t[21]=e("p",{class:"text-[10px] font-bold tracking-widest text-gray-400 uppercase mb-1"}," INVOICE TARGET ",-1)),e("div",Ze,[e("h3",et," #"+s(r.invoice.invoice_number),1),r.invoice.status==="validated"?(l(),o("div",tt,[...t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])])):p("",!0)])]),e("span",{class:S(["px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wide border shadow-sm",{"bg-green-100 text-green-700 border-green-200":r.invoice.payment_status==="paid","bg-yellow-100 text-yellow-700 border-yellow-200":r.invoice.payment_status==="partial","bg-red-100 text-red-700 border-red-200":r.invoice.payment_status==="unpaid"}])},s(r.invoice.payment_status),3)]),e("div",at,[e("div",st,[t[22]||(t[22]=e("div",{class:"flex items-center justify-center w-8 h-8 text-gray-500 bg-gray-100 rounded-lg dark:bg-gray-700 dark:text-gray-100"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),e("div",null,[e("p",rt,s(r.purchase.supplier?.name||"Umum/Cash"),1),e("p",ot,s(r.purchase.supplier?.address||"-")+" | "+s(r.purchase.supplier?.phone||"-"),1)])]),e("div",lt,[e("div",it,[t[23]||(t[23]=e("span",{class:"text-gray-400"},"Terbit",-1)),e("span",nt,s(q(r.invoice.invoice_date)),1)]),t[25]||(t[25]=e("div",{class:"w-px h-6 bg-gray-300 dark:bg-gray-600"},null,-1)),e("div",dt,[t[24]||(t[24]=e("span",{class:"text-gray-400"},"Jatuh Tempo",-1)),e("span",ut,s(q(r.invoice.due_date)),1)])])]),e("div",{class:S(["relative p-3 mb-4 overflow-hidden border rounded-xl",Math.abs(r.invoice.total_amount-m.value)<100?"bg-lime-50 border-lime-200 dark:bg-lime-900/20 dark:border-lime-800":"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800"])},[e("div",{class:S(["absolute top-0 right-0 px-2 py-0.5 rounded-bl-lg text-[9px] font-bold uppercase tracking-widest text-white shadow-sm",Math.abs(r.invoice.total_amount-m.value)<100?"bg-lime-500":"bg-red-500"])},s(Math.abs(r.invoice.total_amount-m.value)<100?"Balanced (Cocok)":"Unbalanced (Selisih)"),3),e("div",ct,[e("div",pt,[t[26]||(t[26]=e("span",{class:"font-medium text-gray-500 dark:text-gray-400"},"Target Nota Fisik",-1)),e("span",vt,s(k(r.invoice.total_amount)),1)]),e("div",gt,[e("span",ht,"Total Item Terhubung ("+s(K.value)+")",1),e("span",bt,s(k(m.value)),1)]),t[27]||(t[27]=e("div",{class:"my-1 border-t border-gray-300/50 dark:border-gray-600"},null,-1)),e("div",mt,[e("span",{class:S(Math.abs(r.invoice.total_amount-m.value)<100?"text-lime-700 dark:text-lime-400":"text-red-600 dark:text-red-400")},s(Math.abs(r.invoice.total_amount-m.value)<100?"Selisih Rp 0":"Selisih"),3),e("span",{class:S(Math.abs(r.invoice.total_amount-m.value)<100?"text-lime-700 dark:text-lime-400":"text-red-600 dark:text-red-400")},s(k(r.invoice.total_amount-m.value)),3)])])],2),r.invoice.invoice_url?(l(),o("div",xt,[t[29]||(t[29]=e("p",{class:"mb-2 text-[10px] font-bold text-gray-400 uppercase tracking-wider"}," Lampiran Bukti ",-1)),e("div",{class:"relative overflow-hidden border border-gray-200 cursor-pointer group rounded-xl dark:border-gray-600",onClick:t[2]||(t[2]=a=>G(r.invoice.invoice_url,r.invoice.invoice_number))},[e("img",{src:r.invoice.invoice_url,alt:"Bukti Nota",class:"object-cover w-full h-24 transition duration-500 group-hover:scale-110 group-hover:opacity-75"},null,8,yt),t[28]||(t[28]=e("div",{class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300 bg-black/30 backdrop-blur-[1px]"},[e("svg",{class:"w-6 h-6 text-white drop-shadow-md",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})])],-1))])])):p("",!0)]),x.value==="edit"?(l(),o("div",kt,[t[30]||(t[30]=e("h4",{class:"mb-3 font-bold text-yellow-800 dark:text-yellow-200"}," Tambah Item Baru / Pengganti ",-1)),_(pe,{isSearching:L.value,modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=a=>f.value=a),results:C.value,onSelect:Z,placeholder:"Cari produk ..."},null,8,["isSearching","modelValue","results"])])):p("",!0),x.value==="edit"?(l(),o("div",ft,[t[31]||(t[31]=e("h4",{class:"mb-3 font-bold dark:text-gray-200"}," Produk Belum Tertaut ",-1)),e("form",{onSubmit:M(J,["prevent"])},[x.value==="edit"&&r.unlinkedItems.length==0?(l(),o("p",wt," Semua produk sudah ditautkan. ")):(l(),o("div",_t,[e("ul",It,[(l(!0),o(H,null,A(r.unlinkedItems,a=>(l(),o("li",{key:a.id,class:"flex items-center justify-between w-full p-2 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"},[e("label",{for:"link_item_"+a.id,class:"flex items-start w-full gap-2 text-sm cursor-pointer dark:text-gray-300"},[V(e("input",{id:"link_item_"+a.id,type:"checkbox",value:a.id,"onUpdate:modelValue":t[4]||(t[4]=c=>b.value=c),class:"rounded text-lime-600 mt-1.5"},null,8,Ct),[[E,b.value]]),e("div",Tt,[e("div",jt,s(a.product.name)+" ("+s(a.product.code)+") ",1),e("div",Mt,[e("span",Vt," ("+s(a.quantity)+"x) @"+s(k(a.purchase_price)),1),e("span",Lt," Subtotal: "+s(k(a.subtotal)),1)])])],8,St)]))),128))])])),r.unlinkedItems.length>0?(l(),o("div",Bt,[_(ie,{type:"submit",disabled:b.value.length===0||u.value},{default:U(()=>[I(" Tautkan "+s(b.value.length)+" Item ",1)]),_:1},8,["disabled"])])):p("",!0)],32)])):p("",!0)])])]),_:1},8,["headerTitle"])],64))}};export{Et as default};
