import{s as p,y as C,j as B,c as I,o as n,w as m,b as e,g as d,f as i,k as v,v as h,F as D,m as $,t as l,n as M,a as f,M as N}from"./app-C_cXePOB.js";import{_ as R}from"./Modal-DR4Qf9lZ.js";import{P as V}from"./PrimaryButton-D5q8Vryj.js";import{_ as F}from"./SecondaryButton-ClbDvNQj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"p-6 bg-white dark:bg-gray-800"},q={key:0,class:"py-8 text-center text-gray-500"},A={key:1,class:"py-8 text-center text-gray-500"},P={key:2,class:"overflow-y-auto max-h-[60vh] border rounded-lg dark:border-gray-700"},j={class:"min-w-full text-sm text-left divide-y divide-gray-200 dark:divide-gray-700"},K={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},U={class:"w-10 px-4 py-3"},z={class:"px-4 py-2"},E=["value"],G={class:"px-4 py-2 font-medium"},H={class:"text-xs text-gray-500"},L={class:"px-4 py-2 text-center"},Q={class:"text-gray-400"},J={class:"px-4 py-2 font-bold text-center text-blue-600"},O={class:"px-4 py-2 text-right"},W={class:"flex justify-end gap-3 pt-4 mt-6 border-t dark:border-gray-700"},st={__name:"recom",props:{show:Boolean,supplierId:[Number,String]},emits:["close","add-items"],setup(y,{emit:k}){const u=y,g=k,r=p([]),c=p(!1),o=p([]),b=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s);async function _(){if(u.supplierId){c.value=!0;try{const s=await N.get(route("purchases.recommendations"),{params:{supplier_id:u.supplierId}});r.value=s.data,o.value=s.data.map(t=>t.product_id)}catch(s){console.error("Gagal fetch rekomendasi:",s),r.value=[]}finally{c.value=!1}}}C(()=>u.show,s=>{s?_():r.value=[]});function w(){const s=r.value.filter(t=>o.value.includes(t.product_id)).map(t=>({...t,quantity:t.quantity,purchase_price:t.purchase_price}));s.length!==0&&(g("add-items",s),g("close"))}const x=B({get(){return o.value.length===r.value.length&&r.value.length>0},set(s){o.value=s?r.value.map(t=>t.product_id):[]}});return(s,t)=>(n(),I(R,{show:y.show,onClose:t[3]||(t[3]=a=>s.$emit("close"))},{default:m(()=>[e("div",T,[t[9]||(t[9]=e("h2",{class:"mb-4 text-lg font-medium text-gray-900 dark:text-gray-100"}," ðŸ’¡ Rekomendasi Restock Cerdas ",-1)),t[10]||(t[10]=e("p",{class:"mb-4 text-sm text-gray-500"},[i(" Daftar barang dari Supplier ini yang stoknya kritis ("),e("span",{class:"font-bold text-red-500"},"Stok Kini < Min Stok"),i("). ")],-1)),c.value?(n(),d("div",q," Menganalisa Stok dan Kebutuhan... ")):r.value.length===0?(n(),d("div",A," Semua stok dari Supplier ini masih aman. ")):(n(),d("div",P,[e("table",j,[e("thead",K,[e("tr",null,[e("th",U,[v(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=a=>x.value=a),class:"border-gray-300 rounded text-lime-600 focus:ring-lime-500"},null,512),[[h,x.value]])]),t[4]||(t[4]=e("th",{class:"px-4 py-3"},"Produk",-1)),t[5]||(t[5]=e("th",{class:"px-4 py-3 text-center"},"Stok/Min",-1)),t[6]||(t[6]=e("th",{class:"px-4 py-3 text-center"},"Saran Qty",-1)),t[7]||(t[7]=e("th",{class:"px-4 py-3 text-right"},"Harga Beli",-1))])]),e("tbody",null,[(n(!0),d(D,null,$(r.value,a=>(n(),d("tr",{key:a.product_id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",z,[v(e("input",{type:"checkbox",value:a.product_id,"onUpdate:modelValue":t[1]||(t[1]=S=>o.value=S),class:"border-gray-300 rounded text-lime-600 focus:ring-lime-500"},null,8,E),[[h,o.value]])]),e("td",G,[i(l(a.name)+" ",1),e("div",H," ("+l(a.code)+") ",1)]),e("td",L,[e("span",{class:M(["font-bold",a.current_stock<=a.min_stock?"text-red-500":"text-green-500"])},l(a.current_stock),3),e("span",Q," / "+l(a.min_stock),1)]),e("td",J,l(a.quantity),1),e("td",O,l(b(a.purchase_price)),1)]))),128))])])])),e("div",W,[f(F,{onClick:t[2]||(t[2]=a=>s.$emit("close"))},{default:m(()=>[...t[8]||(t[8]=[i("Tutup",-1)])]),_:1}),f(V,{onClick:w,disabled:o.value.length===0},{default:m(()=>[i(" Ambil Terpilih ("+l(o.value.length)+") ",1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}};export{st as default};
