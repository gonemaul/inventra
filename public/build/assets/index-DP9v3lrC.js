import{v as s,D as F,J as C,K as _,x as ee,S as te,l as d,o as l,e as c,g as L,i as ae,w as P,f as r,d as u,p as D,M as re,n as b,z as le,L as oe,k as U,t as O,F as M,I as V}from"./vendor-core-B46KUNyc.js";import{d as R}from"./vendor-common-GpUWqhKr.js";import{u as se}from"./useActionLoading-pomD9vky.js";import{_ as ne}from"./AuthenticatedLayout-9yD8UcND.js";import ie from"./modalFilter-TETVMdOb.js";import G from"./pagination-CHkyzNSz.js";import{_ as ue}from"./Filter-BCoPa6F1.js";import{_ as de}from"./DeleteConfirm-jyL8Xp5l.js";import{_ as me}from"./ImageModal-Bw2gM8ak.js";import{B as ve}from"./BottomSheet-p_YbYltf.js";import ce from"./MobileCardGrid-DP222j69.js";import pe from"./MobileCardList-Cjm_kltP.js";import ge from"./ProductCardGrid-CI83hMBz.js";import fe from"./ProductCardList-BLeBCk36.js";import ke from"./ProductKanbanBoard-Bw11l-ES.js";import K from"./EmptyState-BGWz0q0E.js";import be from"./StockAdjustmentSheet-CWnLg4jv.js";import he from"./PriceAdjustmentSheet-EB9JF6CD.js";import we from"./ProductDetailSheet-t5-Smmsn.js";import"./vendor-charts-Bw6UNgWf.js";import"./useSidebar-DSTl-7Rw.js";import"./BottomSheetFilter-BbzoWbU-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-DDwApxbn.js";import"./PrimaryButton-H-fN45pr.js";import"./Modal-DXDloOS9.js";import"./ProductKanbanCard-CS1B3mWx.js";import"./InputRupiah-B1VRU30-.js";const ye={class:"w-full pb-10"},xe={class:"flex gap-1 p-1 my-3 bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700"},Ce={class:"relative"},Me={class:"flex items-center gap-2 pl-2 md:border-l md:border-gray-300 dark:md:border-gray-700 shrink-0"},$e={key:1,class:""},Se={key:0,class:"grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5"},Fe={key:2},Pe={key:2,class:"mt-8"},rt={__name:"index",props:{products:Object,filters:Object,dropdowns:Object},setup(o){const n=o,{isActionLoading:p}=se(),m=s({title:"Detail Produk",data:{}}),v=s("grid"),f=s("detail"),B=s(!1),j=s(null),g=s(!1),h=s(n.filters.search||""),W=F(()=>n.filters.trashed===!0||n.filters.trashed==="true"),J=F(()=>{const a=Object.keys(n.filters),e=["search","page","per_page"];return a.filter(t=>!e.includes(t)).length}),A=s(!1),T=s(null),N=s(null),$=s(window.innerWidth<1024),E=()=>{$.value=window.innerWidth<1024},Z={restock:{label:"ðŸš¨ Stok",class:"bg-red-500 animate-pulse",priority:1},margin_alert:{label:"âš ï¸ Margin",class:"bg-yellow-400",priority:2},dead_stock:{label:"ðŸ¢ Slow",class:"bg-gray-600",priority:3},trend:{label:"ðŸ”¥ Trending",class:"bg-purple-600 animate-pulse",priority:4},new:{label:"âœ¨ New",class:"bg-lime-500",priority:5},high_margin:{label:"ðŸ’° Cuan",class:"bg-emerald-600",priority:6},promo:{label:"% Promo",class:"bg-blue-500",priority:7}},w=F(()=>n.products.data.map(a=>{const e=(a.insights||[]).map(t=>({...Z[t.type],type:t.type})).filter(t=>t.label).sort((t,i)=>t.priority-i.priority).slice(0,2);return{...a,active_badges:e}})),k=(a,e=null)=>{f.value=a,e!=null&&(m.value={},m.value.data=e),a=="detail"?m.value.title="Detail Produk":a=="stock"?m.value.title="Penyesuaian Stock":a=="price"&&(m.value.title="Penyesuaian Harga"),g.value=!0},S=a=>{T.value=a.path,N.value=a.name,A.value=!0},y=(a,e=!1)=>{let t={};e?t={title:"Hapus Permanen Produk",message:"Produk ini akan dihapus selamanya. Anda yakin menghapus",itemName:a.name,url:route("products.destroy",{id:a.slug,permanen:!0})}:t={title:"Pindahkan ke Sampah",message:"Anda yakin ingin memindahkan produk",itemName:a.name,url:route("products.destroy",{id:a.slug})},j.value.open(t)},H=a=>{p.value=!0,C.put(route("products.restoreProduct",{id:a.slug}),{},{preserveScroll:!0,onSuccess:()=>{},onError:e=>{console.error(e)},onFinish:()=>{p.value=!1}})},q=R.throttle(()=>{const a={...n.filters};a.search=h.value,a.page=1,(!a.search||h.value=="")&&delete a.search,C.get(route("products.index"),a,{preserveState:!0,replace:!0})},300);_(h,q);const Q=F(()=>n.filters),I=a=>{const e={...n.filters};e.sort=a,console.log(a),a==="default"&&delete e.sort,p.value=!0,C.get(route("products.index"),e,{preserveState:!0,replace:!0,onFinish:()=>{p.value=!1}})},x=s(n.filters.stock_status||""),X=()=>{const a={...n.filters};x.value?a.stock_status=x.value:delete a.stock_status,a.page=1,p.value=!0,C.get(route("products.index"),a,{preserveState:!0,replace:!0,onFinish:()=>{p.value=!1}})},Y=()=>{p.value=!0,x.value="",C.get(route("products.index"),{per_page:n.filters.per_page||10},{preserveState:!0,replace:!0,onFinish:()=>{p.value=!1}})},z=R.throttle(()=>{document.activeElement&&document.activeElement.tagName==="INPUT"&&document.activeElement.blur()},150);return ee(()=>{window.addEventListener("resize",E),window.addEventListener("scroll",z,{passive:!0})}),te(()=>{window.removeEventListener("resize",E),window.removeEventListener("scroll",z)}),(a,e)=>(l(),d(M,null,[c(me,{show:A.value,imageUrl:T.value,productName:N.value,onClose:e[0]||(e[0]=t=>A.value=!1)},null,8,["show","imageUrl","productName"]),c(de,{ref_key:"showConfirmModal",ref:j,onSuccess:e[1]||(e[1]=()=>{})},null,512),c(L(ae),{title:"Data Barang"}),c(ne,{headerTitle:"Data Barang"},{default:P(()=>[r("div",ye,[c(L(re),{data:"dropdowns"},{fallback:P(()=>[...e[18]||(e[18]=[r("div",{class:""},null,-1)])]),default:P(()=>[c(ie,{show:B.value,onClose:e[2]||(e[2]=t=>B.value=!1),filters:o.filters,dropdowns:o.dropdowns},null,8,["show","filters","dropdowns"])]),_:1}),c(ue,{filters:o.filters,modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=t=>h.value=t),onShowFilter:e[4]||(e[4]=t=>B.value=!0),filterCount:J.value,actions:[{route:a.route("products.create"),buttonText:"Tambah Produk"}]},null,8,["filters","modelValue","filterCount","actions"]),r("div",xe,[r("button",{onClick:e[5]||(e[5]=t=>v.value="grid"),class:b([v.value==="grid"?"bg-lime-500 text-white":"text-gray-400 hover:bg-gray-100 hover:text-lime-500","p-2 transition rounded"]),title:"Mode Grid"},[...e[19]||(e[19]=[r("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)])],2),r("button",{onClick:e[6]||(e[6]=t=>v.value="list"),class:b([v.value==="list"?"bg-lime-500 text-white":"text-gray-400 hover:bg-gray-100 hover:text-lime-500","p-2 transition rounded"]),title:"Mode Daftar"},[...e[20]||(e[20]=[r("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])],2),r("button",{onClick:e[7]||(e[7]=t=>v.value="kanban"),class:b([v.value==="kanban"?"bg-lime-500 text-white":"text-gray-400 hover:bg-gray-100 hover:text-lime-500","p-2 transition rounded"]),title:"Mode Analisa DSS"},[...e[21]||(e[21]=[r("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})],-1)])],2),r("div",Ce,[le(r("select",{"onUpdate:modelValue":e[8]||(e[8]=t=>x.value=t),onChange:X,class:"py-1.5 pl-3 pr-8 text-sm border-gray-300 rounded-lg md:mr-1 focus:ring-lime-500 focus:border-lime-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[...e[22]||(e[22]=[r("option",{value:""},"Semua",-1),r("option",{value:"ready"},"Ready",-1),r("option",{value:"empty"},"Habis",-1)])],544),[[oe,x.value]])]),r("div",Me,[r("button",{onClick:e[9]||(e[9]=t=>I(o.filters.sort==="cheapest"?"default":"cheapest")),class:b([o.filters.sort==="cheapest"?"bg-orange-100 text-orange-700 border-orange-200":"bg-white text-gray-400 border-gray-200","p-1.5 border rounded-lg transition-all flex items-center gap-2 font-medium text-sm"]),title:"Termurah"},[e[23]||(e[23]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M12 20V10"}),r("path",{d:"M18 20V4"}),r("path",{d:"M6 20v-4"})],-1)),U(" "+O(o.filters.sort==="cheapest"?"Termurah":""),1)],2),r("button",{onClick:e[10]||(e[10]=t=>I(o.filters.sort==="bestseller"?"default":"bestseller")),class:b([o.filters.sort==="bestseller"?"bg-purple-100 text-purple-700 border-purple-200":"bg-white text-gray-400 border-gray-200","p-1.5 border rounded-lg transition-all flex gap-2 items-center font-medium text-sm"]),title:"Terlaris"},[e[24]||(e[24]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[r("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6"}),r("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18"}),r("path",{d:"M4 22h16"}),r("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"}),r("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"}),r("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z"})],-1)),U(" "+O(o.filters.sort==="bestseller"?"Terlaris":""),1)],2)])]),o.products.data.length>10?(l(),u(G,{key:0,metadata:o.products,filters:o.filters,class:"mb-3"},null,8,["metadata","filters"])):D("",!0),o.products.data.length>0?(l(),d("div",$e,[v.value==="grid"?(l(),d("div",Se,[$.value?(l(!0),d(M,{key:0},V(w.value,t=>(l(),u(ce,{key:"mobile"+t.id,data:t,onClick:i=>k("detail",t),onImageClick:S},null,8,["data","onClick"]))),128)):(l(!0),d(M,{key:1},V(w.value,t=>(l(),u(ge,{key:"desktop"+t.id,data:t,onDelete:i=>y(t),onForceDelete:i=>y(t,!0),onRestore:i=>H(t),onImageClick:S,onAdjustStock:i=>k("stock",t),onAdjustPrice:i=>k("price",t)},null,8,["data","onDelete","onForceDelete","onRestore","onAdjustStock","onAdjustPrice"]))),128))])):v.value==="list"?(l(),d("div",{key:1,class:b(["mt-4",$.value?"flex flex-col gap-3":"grid grid-cols-1 gap-4"])},[$.value?(l(!0),d(M,{key:0},V(w.value,t=>(l(),u(pe,{key:"mobile-list-"+t.id,data:t,onClick:i=>k("detail",t),onImageClick:S},null,8,["data","onClick"]))),128)):(l(!0),d(M,{key:1},V(w.value,t=>(l(),u(fe,{"is-trash-view":W.value,key:"desktop-list-"+t.id,data:t,onDelete:i=>y(t,!1),onForceDelete:i=>y(t,!0),onRestore:i=>H(t),onImageClick:S},null,8,["is-trash-view","data","onDelete","onForceDelete","onRestore"]))),128))],2)):v.value==="kanban"?(l(),d("div",Fe,[c(ke,{products:w.value},null,8,["products"])])):D("",!0)])):(l(),d("div",Pe,[Q.value?(l(),u(K,{key:0,title:"Tidak ditemukan",message:"Maaf, tidak ada produk yang cocok dengan pencarian atau filter Anda. Coba atur ulang.",icon:"search","action-label":"Reset Filter","action-type":"button",onAction:Y})):(l(),u(K,{key:1,title:"Belum ada Produk",message:"Toko Anda masih kosong. Mulai tambahkan produk pertama Anda sekarang!",icon:"box","action-label":"Tambah Produk Baru","action-url":a.route("products.create"),"action-type":"link"},null,8,["action-url"]))])),o.products.total>8?(l(),u(G,{key:3,metadata:o.products,filters:o.filters},null,8,["metadata","filters"])):D("",!0)])]),_:1}),c(ve,{show:g.value,onClose:e[17]||(e[17]=t=>g.value=!1),title:m.value.title},{default:P(()=>[f.value=="detail"?(l(),u(we,{key:0,data:m.value.data,onAdjustStock:e[11]||(e[11]=t=>k("stock")),onAdjustPrice:e[12]||(e[12]=t=>k("price")),onDelete:y},null,8,["data"])):f.value=="stock"?(l(),u(be,{key:1,product:m.value.data,onClose:e[13]||(e[13]=t=>g.value=!1),onSuccess:e[14]||(e[14]=t=>{g.value=!1,f.value="detail"})},null,8,["product"])):f.value=="price"?(l(),u(he,{key:2,product:m.value.data,onClose:e[15]||(e[15]=t=>g.value=!1),onSuccess:e[16]||(e[16]=t=>{g.value=!1,f.value="detail"})},null,8,["product"])):D("",!0)]),_:1},8,["show","title"])],64))}};export{rt as default};
