import{q as w,D as k,u as h,K as S,l as r,p,o as i,f as t,j as _,e as D,g as l,t as d,z as f,A as g,L as M,F as V,I as B}from"./vendor-core-B46KUNyc.js";import"./vendor-common-GpUWqhKr.js";import{u as I}from"./useActionLoading-pomD9vky.js";import{_ as C}from"./InputRupiah-B1VRU30-.js";import"./vendor-charts-Bw6UNgWf.js";const F={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},A={class:"w-full max-w-md overflow-hidden bg-white shadow-2xl rounded-xl animate-fade-in-down"},N={class:"flex items-center justify-between p-4 border-b bg-gray-50"},T={class:"relative"},U={class:"mt-1 text-xs text-right text-gray-400"},$={key:0,class:"mt-1 text-xs text-red-500"},j={class:"grid grid-cols-2 gap-4"},L=["value"],O={key:0,class:"mt-1 text-xs text-red-500"},P={class:"flex gap-3 pt-2"},R=["disabled"],H={__name:"PaymentModal",props:{show:Boolean,paymentMethods:Array,invoice:Object},emits:["close"],setup(m,{emit:x}){const n=m,y=x;w();const{isActionLoading:b}=I(),c=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),u=k(()=>n.invoice?n.invoice.total_amount-n.invoice.amount_paid:0),o=h({payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"transfer",proof_image:null,notes:""});S(()=>n.show,a=>{a&&(o.reset(),o.clearErrors(),o.amount=u.value,o.payment_date=new Date().toISOString().split("T")[0])});const v=()=>{b.value=!0,o.post(route("finance.store",n.invoice.id),{onSuccess:()=>{y("close"),b.value=!1}})};return(a,e)=>m.show?(i(),r("div",F,[t("div",A,[t("div",N,[e[7]||(e[7]=t("h3",{class:"font-bold text-gray-800"},"Input Pembayaran",-1)),t("button",{onClick:e[0]||(e[0]=s=>a.$emit("close")),class:"text-xl font-bold text-gray-400 hover:text-red-500"}," Ã— ")]),t("form",{onSubmit:_(v,["prevent"]),class:"p-5 space-y-4"},[t("div",null,[e[9]||(e[9]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Nominal Bayar",-1)),t("div",T,[e[8]||(e[8]=t("span",{class:"absolute font-bold text-gray-500 left-3 top-2"},"Rp",-1)),D(C,{modelValue:l(o).amount,"onUpdate:modelValue":e[1]||(e[1]=s=>l(o).amount=s),class:"w-full py-2 pl-10 pr-3 text-lg font-bold border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",max:u.value,placeholder:"0"},null,8,["modelValue","max"])]),t("div",U," Maks: "+d(c(u.value)),1),l(o).errors.amount?(i(),r("div",$,d(l(o).errors.amount),1)):p("",!0)]),t("div",j,[t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Tanggal",-1)),f(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>l(o).payment_date=s),class:"w-full p-2 text-sm border rounded-lg"},null,512),[[g,l(o).payment_date]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Metode",-1)),f(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l(o).payment_method=s),class:"w-full p-2 text-sm border rounded-lg"},[(i(!0),r(V,null,B(m.paymentMethods,s=>(i(),r("option",{key:s,value:s},d(s.charAt(0).toUpperCase()+s.slice(1)),9,L))),128))],512),[[M,l(o).payment_method]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Bukti Foto / Struk",-1)),t("input",{type:"file",onInput:e[4]||(e[4]=s=>l(o).proof_image=s.target.files[0]),class:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),l(o).errors.proof_image?(i(),r("div",O,d(l(o).errors.proof_image),1)):p("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Catatan (Opsional)",-1)),f(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).notes=s),rows:"2",class:"w-full p-2 text-sm border rounded-lg",placeholder:"Contoh: Cicilan pertama"},null,512),[[g,l(o).notes]])]),t("div",P,[t("button",{type:"button",onClick:e[6]||(e[6]=s=>a.$emit("close")),class:"flex-1 py-2 text-gray-600 rounded-lg hover:bg-gray-100"}," Batal "),t("button",{type:"submit",disabled:l(o).processing,class:"flex-1 py-2 font-bold text-white rounded-lg bg-lime-600 hover:bg-lime-700 disabled:opacity-50"},d(l(o).processing?"Menyimpan...":"Bayar Sekarang"),9,R)])],32)])])):p("",!0)}};export{H as default};
