const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DesktopDetail-CHNcPLET.js","assets/vendor-core-ConwodqI.js","assets/vendor-common-GpUWqhKr.js","assets/vendor-charts-Bw6UNgWf.js","assets/vendor-core-DnojJsHo.css","assets/Tabs-DR_F7ct6.js","assets/PrimaryButton-JuU0ol6y.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/HeaderDetail-CVTDTMrw.js","assets/InfoCard-C65-5sAE.js","assets/usePurchaseAnalytics-CjB8Y4wn.js","assets/invoiceTable-Cj1lirYb.js","assets/DataTable-Bb1Fbbpp.js","assets/ImageModal-D79EyDPM.js","assets/BottomSheet-BzLjovBZ.js","assets/BottomSheet-CWIWp40S.css","assets/productTable-BAHXmdjH.js","assets/StatusModalMobile-COTEWwES.js","assets/useActionLoading-BVuW09Mi.js","assets/MobileDetail-DvMpgdtj.js","assets/HeadMobile-sePM520G.js","assets/HeadMobile-CJCtzOsO.css","assets/InvoiceMobile-BFThktBi.js","assets/ProdukMobile-D2Y8R-aF.js","assets/useSidebar-BnlGlXj_.js","assets/MobileDetail-Chsqj0fs.css"])))=>i.map(i=>d[i]);
import{_ as N}from"./app-DyHLbp8c.js";import{_ as L}from"./AuthenticatedLayout-y6e15m78.js";import{p as R,q as t,d as P,o as m,w as E,f as y,l as k,m as q,t as A,k as B,e as i,g as I,I as H,v as O,N as K,C as b,i as U,a2 as V,V as z,F as W}from"./vendor-core-ConwodqI.js";import{_ as Y}from"./DeleteConfirm-GSTxJkJb.js";import{_ as G}from"./Modal-BKi8OYoI.js";import{D as J}from"./DangerButton-CwH2QiZ3.js";import{_ as Q}from"./SecondaryButton-B7b5180Y.js";import{u as X}from"./useActionLoading-BVuW09Mi.js";import Z from"./FinalizeModal-CxTOb9-e.js";import ee from"./OrderImageModal-BwbOkIvb.js";import ae from"./InvoiceForm-ciKu8XaM.js";import"./BottomSheet-BzLjovBZ.js";import"./vendor-common-GpUWqhKr.js";import"./vendor-charts-Bw6UNgWf.js";import"./useSidebar-BnlGlXj_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputRupiah-C3RpmbGD.js";import"./PrimaryButton-JuU0ol6y.js";import"./InputError-MhdC0uug.js";import"./TextInput-BfB0-mKB.js";const te={class:"p-6"},se={class:"mb-4 text-xl font-bold text-red-600"},ne={class:"mb-4 text-gray-700 dark:text-gray-300"},ie={key:0,class:"mb-6 text-lg font-semibold"},oe={class:"text-red-700 dark:text-red-400"},le={class:"flex justify-end gap-3 mt-4"},re={key:0},ue={key:1},de={__name:"ConfirmModal",emits:["close","success"],setup(l,{expose:S,emit:$}){const{isActionLoading:a}=X(),p=R(),d=t(!1),r=t("Konfirmasi Aksi"),v=t("Anda yakin ingin melanjutkan aksi ini?"),c=t(""),h=t(""),u=t("post"),g=t({});S({open:n=>{r.value=n.title||"Konfirmasi Penghapusan",v.value=n.message||"Anda yakin ingin menghapus data ini?",c.value=n.itemName||"",h.value=n.url||"",u.value=n.method||"post",g.value=n.data||{},d.value=!0}});const f=()=>{d.value=!1,_("close")},D=()=>{if(!h.value){p.error("URL aksi tidak terdefinisi.");return}a.value=!0;const n=u.value.toLowerCase();H[n](h.value,g.value||{},{preserveScroll:!0,onSuccess:()=>{f(),_("close")},onError:o=>{p.error(o.message||"Terjadi kesalahan saat menghapus data.")},onFinish:()=>{a.value=!1,h.value=""}})},_=$;return(n,o)=>(m(),P(G,{show:d.value,onClose:o[0]||(o[0]=M=>_("close")),maxWidth:"md"},{default:E(()=>[y("div",te,[y("h3",se,A(r.value),1),y("p",ne,A(v.value),1),c.value?(m(),k("p",ie,[o[1]||(o[1]=B(" Item: ",-1)),y("span",oe,A(c.value),1)])):q("",!0),y("div",le,[i(Q,{onClick:f,type:"button"},{default:E(()=>[...o[2]||(o[2]=[B(" Batal ",-1)])]),_:1}),i(J,{onClick:D,disabled:I(a)},{default:E(()=>[I(a)?(m(),k("span",re,"Memproses...")):(m(),k("span",ue,"Ya"))]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},ce={key:0},me={key:1},Ve={__name:"PurchaseDetail",props:{purchase:Object,invoice:Object,paymentStatuses:Array,isCheckingMode:Boolean},setup(l){const S=V(()=>N(()=>import("./DesktopDetail-CHNcPLET.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),$=V(()=>N(()=>import("./MobileDetail-DvMpgdtj.js"),__vite__mapDeps([19,14,1,2,3,4,7,15,20,10,21,22,13,23,17,18,24,25]))),a=l,p=t(!1),d=t(null),r=t(!1),v=t(null),c=t(!1),h=t(!1);t(!1);const u=t(window.innerWidth<1024),g=()=>{u.value=window.innerWidth<1024};O(()=>{window.addEventListener("resize",g),a.purchase.status==="diterima"&&!a.invoice.id&&M()}),K(()=>window.removeEventListener("resize",g));const C=t(a.purchase.items.map(e=>({...e,rejected_quantity:e.rejected_quantity||0,is_valid:e.quantity-(e.rejected_quantity||0)>0}))),f=b(()=>{const e=a.purchase;return e.status!=="checking"||e.invoices.length===0?!1:e.invoices.every(w=>w.status==="validated"&&w.items?.length>0)}),D=b(()=>["diterima","checking"].includes(a.purchase.status)),_=b(()=>a.purchase.status==="draft"||a.purchase.status==="dipesan"),n=b(()=>a.purchase.status==="draft"),o=()=>{f.value&&(c.value=!0)},M=()=>{v.value=null,r.value=!0},F=e=>{v.value=e,r.value=!0},j=e=>{const s={title:"Hapus Nota Keuangan",message:`Hapus Nota No. ${e.invoice_number}? Ini akan menghapus file foto dan mengembalikan status transaksi ke RECEIVED jika tidak ada nota lain.`,itemName:e.invoice_number,url:route("purchases.destroyInvoice",{purchase:a.purchase.id,invoice:e.id})};d.value.open(s)},x=()=>{r.value=!1,router.reload({preserveScroll:!0,preserveState:!0})},T={openCreateInvoiceModal:M,handleEditInvoice:F,handleDeleteInvoice:j,handleDelete:()=>{const e={title:"Hapus Pembelian",message:`Apakah Anda yakin ingin menghapus pembelian #${a.purchase.reference_no}? Tindakan ini tidak dapat dibatalkan.`,url:route("purchases.destroy",a.purchase.id)};d.value.open(e)},openFinalizeModal:o,getActions:e=>{const s=[];switch(e.status){case"draft":s.push({label:"Tandai Dipesan",icon:"play",type:"status",newStatus:"dipesan"});break;case"dipesan":s.push({label:"Tandai Dikirim",icon:"truck",type:"status",newStatus:"dikirim"});break;case"dikirim":s.push({label:"Tandai Diterima",icon:"receive",type:"status",newStatus:"diterima"});break;case"diterima":s.push({label:"Batalkan Terima",icon:"undo",type:"status",newStatus:"dikirim"});break}return s},openImageModal:()=>p.value=!0};return(e,s)=>(m(),k(W,null,[i(I(U),{title:`Detail - ${l.purchase.reference_no}`},null,8,["title"]),i(Y,{ref_key:"deleteModalRef",ref:d,onSuccess:x},null,512),i(de,{ref_key:"showConfirmModal",ref:h,onSuccess:x},null,512),i(Z,{show:c.value,purchase:l.purchase,onClose:s[0]||(s[0]=w=>c.value=!1)},null,8,["show","purchase"]),i(ee,{show:p.value,purchase:l.purchase,"store-name":e.$page.props.auth.user.store_name||"INVENTRA STORE",onClose:s[1]||(s[1]=w=>p.value=!1)},null,8,["show","purchase","store-name"]),i(ae,{show:r.value,purchaseId:l.purchase.id,editingInvoice:v.value,paymentStatuses:l.paymentStatuses,onClose:s[2]||(s[2]=w=>r.value=!1),onInvoiceSaved:x},null,8,["show","purchaseId","editingInvoice","paymentStatuses"]),i(L,{showSidebar:!u.value,showHeader:!u.value,showBottomBar:!u.value,headerTitle:`Detail - ${l.purchase.reference_no}`},{default:E(()=>[u.value?(m(),k("div",ce,[i(I($),z(a,{actions:T,validationItems:C.value,allowFinalize:f.value,canEditDeleteInvoice:D.value,isEditing:_.value,isDeleted:n.value}),null,16,["validationItems","allowFinalize","canEditDeleteInvoice","isEditing","isDeleted"])])):(m(),k("div",me,[i(I(S),z(a,{actions:T,validationItems:C.value,allowFinalize:f.value,canEditDeleteInvoice:D.value,isEditing:_.value,isDeleted:n.value}),null,16,["validationItems","allowFinalize","canEditDeleteInvoice","isEditing","isDeleted"])]))]),_:1},8,["showSidebar","showHeader","showBottomBar","headerTitle"])],64))}};export{Ve as default};
