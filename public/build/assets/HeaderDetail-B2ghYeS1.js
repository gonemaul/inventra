import{j as k,V as O,O as S,g as B,o as I,b as e,a,w as x,t as f,d as i}from"./app-CojE2Nhg.js";import t from"./InfoCard-CGP_UMS7.js";function P(s){const o=k(()=>O(s)?s.value:s),d=u=>parseFloat(u)||0,c=k(()=>{const u=o.value||[];let l={kosong:0,baru_pengganti:0,total_macam_dipesan:0,total_macam_diterima:0,total_qty_dipesan:0,total_qty_diterima:0,total_rupiah_dipesan:0,total_rupiah_diterima:0,total_barang_sesuai:0,macam_harga_naik:0,macam_harga_turun:0,produk_qty_lebih:0,produk_qty_kurang:0};return u.forEach(v=>{const y=v.product_snapshot||{},r=d(y.quantity),m=d(y.purchase_price),n=d(v.quantity),_=d(v.purchase_price);l.total_qty_dipesan+=r,l.total_qty_diterima+=n,l.total_rupiah_dipesan+=r*m,l.total_rupiah_diterima+=n*_,r===0&&n>0&&(l.baru_pengganti+=1),r>0&&(l.total_macam_dipesan+=1,n===0&&(l.kosong+=1)),n>0&&(l.total_macam_diterima+=1),n>r?l.produk_qty_lebih+=n-r:n<r&&(l.produk_qty_kurang+=r-n);const b=n===r&&r>0,h=_===m;b&&(_>m?l.macam_harga_naik+=1:_<m&&(l.macam_harga_turun+=1)),b&&h&&(l.total_barang_sesuai+=1)}),console.log(o),l});return{...S(c.value),analytics:c}}const Q={class:"space-y-8 dark:bg-gray-800"},R={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},C={class:"space-y-6"},F={class:"p-4 border shadow-lg rounded-xl border-lime-400 bg-gray-50 dark:bg-gray-900"},A={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},K={class:"flex flex-col"},M={class:"font-medium"},j={class:"text-sm text-gray-500"},H={class:"p-4 border shadow-lg rounded-xl border-lime-400 bg-gray-50 dark:bg-gray-900"},V={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},E={class:"flex flex-col h-full gap-6"},U={class:"p-4 border shadow-lg rounded-xl border-lime-400 bg-gray-50 dark:bg-gray-900"},J={class:"grid grid-cols-2 gap-4 sm:grid-cols-3"},z={__name:"HeaderDetail",props:{data:{type:Object,required:!0},mode:{type:String,default:"detail"}},setup(s){const o=s;function d(g){return g?new Date(g).toLocaleDateString("id-ID",{day:"2-digit",month:"numeric",year:"numeric"}):"-"}function c(g){return!g&&g!==0?"-":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(g)}const u=k(()=>o.data.status==="received"),l=(o.data.shipping_cost||0)+(o.data.other_costs||0);(o.data.invoices_sum_total_amount||0)+l;const{kosong:v,baru_pengganti:y,total_macam_dipesan:r,total_macam_diterima:m,total_qty_dipesan:n,total_qty_diterima:_,total_rupiah_dipesan:b,total_rupiah_diterima:h,total_barang_sesuai:q,macam_harga_naik:D,macam_harga_turun:w,produk_qty_lebih:N,produk_qty_kurang:T}=P(o.data.items);return(g,p)=>(I(),B("div",Q,[e("div",R,[e("div",C,[e("div",F,[p[0]||(p[0]=e("div",{class:"flex justify-between"},[e("h3",{class:"mb-4 text-sm font-semibold text-gray-600 dark:text-gray-300"}," Info Transaksi ")],-1)),e("div",A,[a(t,{label:"Supplier"},{default:x(()=>[e("div",K,[e("span",M,f(s.data.supplier?s.data.supplier.name:"Umum/Cash"),1),e("span",j,f(s.data.supplier?s.data.supplier.address+" | "+s.data.supplier.phone:"-"),1)])]),_:1}),a(t,{label:"Status"},{default:x(()=>[e("span",null,f(s.data.status.toUpperCase()),1)]),_:1}),a(t,{label:"Tanggal Order",value:d(s.data.transaction_date)},null,8,["value"]),a(t,{label:"Tanggal Datang",value:d(s.data.received_at)},null,8,["value"])])]),e("div",H,[p[1]||(p[1]=e("h3",{class:"mb-4 text-sm font-semibold text-gray-600 dark:text-gray-300"}," Ringkasan Keuangan ",-1)),e("div",V,[a(t,{label:"Jumlah Nota",value:u.value?s.data.invoices.length+" Nota":"-"},null,8,["value"]),a(t,{label:"Nilai PO Awal",value:c(i(b)),"format-value":c},null,8,["value"]),a(t,{label:"Nilai Fisik Diterima",value:u.value?c(i(h)):"-","format-value":c,highlight:""},null,8,["value"])])])]),e("div",E,[e("div",U,[p[2]||(p[2]=e("h3",{class:"mb-4 text-sm font-semibold text-gray-600 dark:text-gray-300"}," Analisis Discrepancy (PO vs Fisik Nota) ",-1)),e("div",J,[a(t,{label:"Barang Sesuai Total",value:i(q),type:"success"},null,8,["value"]),a(t,{label:"Macam Dipesan",value:i(r)},null,8,["value"]),a(t,{label:"Macam Diterima",value:u.value?i(m):"-"},null,8,["value"]),a(t,{label:"Qty Total Dipesan",value:i(n)},null,8,["value"]),a(t,{label:"Qty Total Diterima",value:u.value?i(_):"-"},null,8,["value"]),a(t,{label:"Qty Kekurangan",value:i(T),type:"danger"},null,8,["value"]),a(t,{label:"Qty Kelebihan",value:i(N),type:"warning"},null,8,["value"]),a(t,{label:"Item Kosong (Qty 0)",value:i(v),type:"danger"},null,8,["value"]),a(t,{label:"Harga Naik (Macam)",value:i(D),type:"warning"},null,8,["value"]),a(t,{label:"Harga Turun (Macam)",value:i(w),type:"info"},null,8,["value"]),a(t,{label:"Barang Baru/Substitusi",value:i(y),type:"info"},null,8,["value"]),a(t,{label:"Catatan",value:s.data.notes||"-"},null,8,["value"])])])])])]))}};export{z as default};
