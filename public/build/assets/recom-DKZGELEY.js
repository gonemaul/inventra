import{x as p,z as j,j as M,c as I,o as n,w as g,b as e,g as d,f as i,t as l,k as h,v as k,F as S,q as D,n as y,e as V,i as $,a as v,R as A}from"./app-CKedD50u.js";import{_ as N}from"./Modal-gP53gBdn.js";import{P as R}from"./PrimaryButton-DC8fjAi-.js";import{_ as q}from"./SecondaryButton-DAuDdDzR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"p-6 bg-white dark:bg-gray-800"},F={class:"flex items-start justify-between mb-4"},P={class:"px-3 py-1 text-xs font-bold text-blue-600 border border-blue-100 rounded-lg bg-blue-50"},T={key:0,class:"flex flex-col items-center justify-center py-12 text-gray-500 animate-pulse"},E={key:1,class:"flex flex-col items-center py-12 text-center text-gray-500"},H={key:2,class:"overflow-y-auto max-h-[60vh] border rounded-lg dark:border-gray-700"},K={class:"min-w-full text-sm text-left divide-y divide-gray-200 dark:divide-gray-700"},L={class:"sticky top-0 z-10 text-xs text-gray-700 uppercase shadow-sm bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},U={class:"w-10 px-4 py-3 bg-gray-50 dark:bg-gray-700"},G={class:"bg-white divide-y divide-gray-200 dark:divide-gray-700 dark:bg-gray-800"},O=["onClick"],Q=["value"],W={class:"px-4 py-3"},J={class:"flex items-center gap-3"},X={class:"flex-shrink-0 w-10 h-10 overflow-hidden bg-gray-100 border rounded"},Y=["src"],Z=["title"],ee={class:"flex items-center gap-1 text-xs text-gray-500"},te={class:"px-1 font-mono bg-gray-100 rounded"},se={class:"px-4 py-3"},ae={key:0,class:"mr-1"},re={class:"px-4 py-3 text-center"},oe={class:"flex flex-col items-center"},le={class:"text-[10px] text-gray-400"},ne={class:"px-4 py-3 text-center"},de={class:"px-3 py-1 font-bold text-blue-700 border border-blue-200 rounded-lg shadow-sm bg-blue-50"},ie={class:"px-4 py-3 font-medium text-right text-gray-600 dark:text-gray-300"},ce={class:"flex items-center justify-end gap-3 pt-4 mt-6 border-t dark:border-gray-700"},ue={class:"mr-auto text-sm text-gray-500"},be={__name:"recom",props:{show:Boolean,supplierId:[Number,String]},emits:["close","add-items"],setup(x,{emit:_}){const c=x,m=_,o=p([]),u=p(!1),r=p([]),w=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a);async function C(){if(c.supplierId){u.value=!0;try{const a=await A.get(route("purchases.recommendations",c.supplierId));o.value=a.data,r.value=a.data.filter(t=>t.is_critical).map(t=>t.product_id)}catch(a){console.error("Gagal fetch rekomendasi:",a),o.value=[]}finally{u.value=!1}}}j(()=>c.show,a=>{a?C():o.value=[]});function B(){const a=o.value.filter(t=>r.value.includes(t.product_id)).map(t=>({...t,quantity:t.quantity,purchase_price:t.purchase_price}));a.length!==0&&(m("add-items",a),m("close"))}const b=M({get(){return r.value.length===o.value.length&&o.value.length>0},set(a){r.value=a?o.value.map(t=>t.product_id):[]}});return(a,t)=>(n(),I(N,{show:x.show,onClose:t[4]||(t[4]=s=>a.$emit("close")),maxWidth:"2xl"},{default:g(()=>[e("div",z,[e("div",F,[t[5]||(t[5]=e("div",null,[e("h2",{class:"flex items-center gap-2 text-lg font-bold text-gray-900 dark:text-gray-100"}," ðŸ’¡ Rekomendasi Restock Cerdas "),e("p",{class:"mt-1 text-sm text-gray-500"},[i(" Daftar barang dari Supplier ini yang perlu dibeli berdasarkan "),e("span",{class:"font-bold text-blue-500"},"Forecasting"),i(" dan "),e("span",{class:"font-bold text-red-500"},"Stok Minimum"),i(". ")])],-1)),e("div",P,l(o.value.length)+" Item Ditemukan ",1)]),u.value?(n(),d("div",T,[...t[6]||(t[6]=[e("svg",{class:"w-8 h-8 mb-2",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("span",null,"Menganalisa Kebutuhan Stok...",-1)])])):o.value.length===0?(n(),d("div",E,[...t[7]||(t[7]=[e("div",{class:"flex items-center justify-center w-12 h-12 mb-2 text-green-600 bg-green-100 rounded-full"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1),e("span",{class:"font-medium text-gray-800 dark:text-white"},"Stok Aman!",-1),e("span",{class:"mt-1 text-sm"},"Tidak ada barang yang perlu di-restock dari supplier ini.",-1)])])):(n(),d("div",H,[e("table",K,[e("thead",L,[e("tr",null,[e("th",U,[h(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=s=>b.value=s),class:"border-gray-300 rounded cursor-pointer text-lime-600 focus:ring-lime-500"},null,512),[[k,b.value]])]),t[8]||(t[8]=e("th",{class:"px-4 py-3 bg-gray-50 dark:bg-gray-700"}," Produk ",-1)),t[9]||(t[9]=e("th",{class:"px-4 py-3 bg-gray-50 dark:bg-gray-700"}," Analisa / Alasan ",-1)),t[10]||(t[10]=e("th",{class:"px-4 py-3 text-center bg-gray-50 dark:bg-gray-700"}," Stok ",-1)),t[11]||(t[11]=e("th",{class:"px-4 py-3 text-center bg-gray-50 dark:bg-gray-700"}," Saran Qty ",-1)),t[12]||(t[12]=e("th",{class:"px-4 py-3 text-right bg-gray-50 dark:bg-gray-700"}," Estimasi ",-1))])]),e("tbody",G,[(n(!0),d(S,null,D(o.value,s=>(n(),d("tr",{key:s.product_id,class:y(["transition cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50",{"bg-red-50/30 dark:bg-red-900/10":s.is_critical}]),onClick:f=>r.value.includes(s.product_id)?r.value.splice(r.value.indexOf(s.product_id),1):r.value.push(s.product_id)},[e("td",{class:"px-4 py-3",onClick:t[2]||(t[2]=V(()=>{},["stop"]))},[h(e("input",{type:"checkbox",value:s.product_id,"onUpdate:modelValue":t[1]||(t[1]=f=>r.value=f),class:"border-gray-300 rounded cursor-pointer text-lime-600 focus:ring-lime-500"},null,8,Q),[[k,r.value]])]),e("td",W,[e("div",J,[e("div",X,[e("img",{src:s.image_path?"/storage/"+s.image_path:"/no-image.png",class:"object-contain w-full h-full"},null,8,Y)]),e("div",null,[e("p",{class:"font-bold text-gray-800 dark:text-gray-200 line-clamp-1",title:s.name},l(s.name),9,Z),e("div",ee,[e("span",te,l(s.code),1),e("span",null,"â€¢ "+l(s.brand),1)])])])]),e("td",se,[e("span",{class:y(["inline-flex items-center px-2.5 py-0.5 rounded text-xs font-bold border shadow-sm",s.is_critical?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-700 border-yellow-200"])},[s.is_critical?(n(),d("span",ae,"ðŸš¨")):$("",!0),i(" "+l(s.reason),1)],2)]),e("td",re,[e("div",oe,[e("span",{class:y(["font-bold",s.current_stock<=s.min_stock?"text-red-600":"text-gray-700"])},l(s.current_stock),3),e("span",le,"Min: "+l(s.min_stock),1)])]),e("td",ne,[e("span",de,l(s.quantity),1)]),e("td",ie,l(w(s.purchase_price*s.quantity)),1)],10,O))),128))])])])),e("div",ce,[e("p",ue,l(r.value.length)+" item dipilih ",1),v(q,{onClick:t[3]||(t[3]=s=>a.$emit("close"))},{default:g(()=>[...t[13]||(t[13]=[i("Batal",-1)])]),_:1}),v(R,{onClick:B,disabled:r.value.length===0,class:"flex items-center gap-2"},{default:g(()=>[...t[14]||(t[14]=[e("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),i(" Masukkan ke Keranjang ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}};export{be as default};
