import{u as j,J as B,q as C,d as M,o as l,w as g,f as e,j as v,k as d,e as i,g as s,l as n,F as N,H as S,n as I,y as L,m as f,M as z,t as F}from"./vendor-core-B1zCOcYd.js";import{P as T}from"./PrimaryButton-wFvWlFJU.js";import{_ as A}from"./SecondaryButton-CwJXwDfS.js";import{_ as c}from"./InputError-CO3QNUvp.js";import{_ as b}from"./TextInput-DMvbwMar.js";import{_ as H}from"./InputRupiah-QN5qUxkk.js";import{u as P}from"./useActionLoading-AmW3nhbQ.js";import{B as U}from"./BottomSheet-B4v_a9x7.js";import"./vendor-common-GpUWqhKr.js";import"./vendor-charts-Bw6UNgWf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"px-3 py-4 space-y-6 border-l border-r border-gray-300"},D={class:"space-y-4"},G={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},q={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},E={class:"space-y-4"},J={class:"grid grid-cols-2 gap-2"},O=["value"],K={class:"text-sm uppercase"},R={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor"},Q={class:"relative"},W={class:"p-6 text-center transition border-2 border-gray-300 border-dashed dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 bg-gray-50 dark:bg-gray-900"},X={key:0,class:"space-y-2"},Y={key:1,class:"flex items-center justify-between p-2 bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700"},Z={class:"flex flex-col-reverse justify-end gap-3 px-6 py-4 border-b border-l border-r border-gray-300 sm:flex-row"},ee={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},te={key:1},ae={key:2},ce={__name:"InvoiceForm",props:{show:Boolean,purchaseId:[Number,String],paymentStatuses:Array,editingInvoice:{type:Object,default:null}},emits:["close","invoice-saved"],setup(m,{emit:w}){const u=m,p=w,{isActionLoading:y}=P(),a=j({invoice_number:null,invoice_date:new Date().toISOString().split("T")[0],due_date:null,total_amount:0,invoice_image:null,payment_status:"unpaid"});B(()=>u.editingInvoice,r=>{r?(a.invoice_number=r.invoice_number,a.invoice_date=r.invoice_date,a.due_date=r.due_date,a.total_amount=r.total_amount,a.payment_status=r.payment_status):a.reset()},{immediate:!0});const k=C(null);function h(r){a.invoice_image=r.target.files[0]}const _=()=>{if(!a.invoice_number||a.total_amount<=0){alert("Nomor nota dan Total Nominal wajib diisi.");return}const r=!!u.editingInvoice,t=r?route("purchases.updateInvoice",{purchase:u.purchaseId,invoice:u.editingInvoice.id}):route("purchases.storeInvoice",u.purchaseId);y.value=!0,a.transform(o=>({...o,_method:r?"put":"post"})).post(t,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{a.reset(),p("invoice-saved"),p("close")},onError:o=>{toast.error(o.message||"Terjadi kesalahan saat menghapus data."),console.error("Gagal upload/update invoice:",o)},onFinish:()=>{y.value=!1}})};function x(){a.reset(),p("close")}return(r,t)=>(l(),M(U,{show:m.show,onClose:x,title:"Tambah Invoice"},{default:g(()=>[e("form",{onSubmit:v(_,["prevent"]),class:"overflow-hidden bg-white dark:bg-gray-900 rounded-2xl"},[t[20]||(t[20]=e("div",{class:"px-6 py-4 bg-gray-200 border-b border-gray-100 dark:border-gray-800 dark:bg-gray-800/50"},[e("h3",{class:"flex items-center gap-2 text-lg font-bold text-gray-800 dark:text-white"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-lime-500",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})]),d(" Upload Nota & Keuangan ")]),e("p",{class:"mt-1 text-xs text-gray-500"}," Pastikan data yang diinput sesuai dengan bukti fisik nota dari supplier. ")],-1)),e("div",$,[e("div",D,[e("div",G,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-1.5"},[d(" No. Nota Supplier "),e("span",{class:"text-red-500"},"*")],-1)),i(b,{modelValue:s(a).invoice_number,"onUpdate:modelValue":t[0]||(t[0]=o=>s(a).invoice_number=o),required:"",placeholder:"Contoh: INV-001/2024",class:"w-full py-3"},null,8,["modelValue"]),i(c,{message:s(a).errors.invoice_number},null,8,["message"])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-1.5"},[d(" Total Nominal (Rp) "),e("span",{class:"text-red-500"},"*")],-1)),i(H,{modelValue:s(a).total_amount,"onUpdate:modelValue":t[1]||(t[1]=o=>s(a).total_amount=o),placeholder:"0",min:"1",class:"w-full py-3 font-bold text-left text-gray-800"},null,8,["modelValue"]),i(c,{message:s(a).errors.total_amount},null,8,["message"])])]),e("div",q,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-1.5"},[d(" Tanggal Nota "),e("span",{class:"text-red-500"},"*")],-1)),i(b,{modelValue:s(a).invoice_date,"onUpdate:modelValue":t[2]||(t[2]=o=>s(a).invoice_date=o),type:"date",required:"",class:"w-full py-3"},null,8,["modelValue"])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-1.5"}," Jatuh Tempo (Opsional) ",-1)),i(b,{modelValue:s(a).due_date,"onUpdate:modelValue":t[3]||(t[3]=o=>s(a).due_date=o),type:"date",class:"w-full py-3"},null,8,["modelValue"]),t[10]||(t[10]=e("p",{class:"text-[10px] text-gray-400 mt-1"}," Kosongkan jika tunai. ",-1))])])]),t[17]||(t[17]=e("hr",{class:"border-gray-100 dark:border-gray-800"},null,-1)),e("div",E,[e("div",null,[t[12]||(t[12]=e("label",{class:"block mb-2 text-xs font-bold tracking-wide text-gray-700 uppercase dark:text-gray-300"},[d(" Status Pembayaran "),e("span",{class:"text-red-500"},"*")],-1)),e("div",J,[(l(!0),n(N,null,S(m.paymentStatuses,o=>(l(),n("label",{key:o,class:I(["cursor-pointer border rounded-xl p-3 text-center transition flex items-center justify-center gap-2",s(a).payment_status===o?"bg-lime-50 border-lime-500 text-lime-700 font-bold ring-1 ring-lime-500":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-50"])},[L(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=V=>s(a).payment_status=V),value:o,class:"hidden"},null,8,O),[[z,s(a).payment_status]]),e("span",K,F(o),1),s(a).payment_status===o?(l(),n("svg",R,[...t[11]||(t[11]=[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):f("",!0)],2))),128))])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block mb-2 text-xs font-bold tracking-wide text-gray-700 uppercase dark:text-gray-300"},[d(" Foto Nota Fisik "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Q,[e("input",{type:"file",onChange:h,ref_key:"fileInput",ref:k,accept:"image/*",class:"absolute inset-0 z-10 w-full h-full opacity-0 cursor-pointer"},null,544),e("div",W,[s(a).invoice_image?(l(),n("div",Y,[t[15]||(t[15]=e("div",{class:"flex items-center gap-3 overflow-hidden"},[e("div",{class:"flex items-center justify-center w-10 h-10 rounded bg-lime-100 text-lime-600 shrink-0"}," IMG "),e("p",{class:"text-sm font-medium truncate max-w-[150px]"}," Foto Terpilih ")],-1)),e("button",{type:"button",onClick:t[5]||(t[5]=v(o=>s(a).invoice_image=null,["stop"])),class:"z-20 p-2 text-red-500"},[...t[14]||(t[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])):(l(),n("div",X,[...t[13]||(t[13]=[e("div",{class:"flex items-center justify-center w-10 h-10 mx-auto rounded-full bg-lime-100 text-lime-600"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})])],-1),e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-300"}," Tap untuk ambil foto / upload ",-1),e("p",{class:"text-xs text-gray-400"}," JPG, PNG (Max 2MB) ",-1)])]))])]),i(c,{message:s(a).errors.invoice_image},null,8,["message"])])])]),e("div",Z,[i(A,{onClick:x,type:"button",class:"justify-center w-full py-3 sm:w-auto"},{default:g(()=>[...t[18]||(t[18]=[d(" Batal ",-1)])]),_:1}),i(T,{disabled:s(a).processing,type:"submit",class:"justify-center w-full py-3 shadow-lg sm:w-auto bg-lime-500 hover:bg-lime-600 border-lime-500 shadow-lime-500/20"},{default:g(()=>[s(a).processing?f("",!0):(l(),n("svg",ee,[...t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),s(a).processing?(l(),n("span",te,"Menyimpan...")):(l(),n("span",ae,"Simpan & Lanjut Checking"))]),_:1},8,["disabled"])])],32)]),_:1},8,["show"]))}};export{ce as default};
