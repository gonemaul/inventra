import{x as h,u as S,C,g as a,o,c as D,i as d,b as r,d as l,n as I,t as n,a as p,f as m,k as g,B as b,F as x,q as _,A as j,w,l as N,e as R}from"./app-Bur_-z3X.js";import{_ as y}from"./TextInput-CZCIpDPX.js";import{P as H}from"./PrimaryButton-CYbjPfWK.js";import{_ as z}from"./SecondaryButton-Cu1dnxoz.js";import{u as A}from"./useActionLoading-ranTtZro.js";import{_ as L}from"./BarcodeScanner-CNJcIF0s.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"flex flex-col gap-4 md:flex-row"},$={class:"flex flex-col lg:w-2/5"},T=["src"],O={key:0,class:"mt-1 text-sm text-red-500"},q={class:"flex flex-col justify-center flex-1 gap-3"},E={class:"relative flex-1"},J={key:0,class:"mt-1 text-sm text-red-500"},G={key:0,class:"mt-1 text-sm text-red-500"},W={class:"grid grid-cols-1 gap-3 mt-5 md:grid-cols-3"},Q={key:0,value:null},X=["value"],Y={key:0,class:"mt-1 text-sm text-red-500"},Z={key:0,value:null},ee=["value"],te={key:0,class:"mt-1 text-sm text-red-500"},re={key:0,value:null},se=["value"],le={key:0,class:"mt-1 text-sm text-red-500"},oe={key:0,value:null},ae=["value"],ne={key:0,class:"mt-1 text-sm text-red-500"},ie={key:0,value:null},de=["value"],ue={key:0,class:"mt-1 text-sm text-red-500"},me={key:0,value:null},pe=["value"],ce={key:0,class:"mt-1 text-sm text-red-500"},ge={class:"mt-4"},xe={key:0,class:"mt-1 text-sm text-red-500"},ye={class:"flex flex-col gap-3 mt-4 md:flex-row"},be={class:"flex-1"},_e={class:"relative"},ke={class:"flex justify-between"},fe={class:"ml-2 text-sm text-gray-500"},ve={key:0,class:"mt-1 text-sm text-red-500"},we={class:"flex-1"},he={class:"relative"},Ve={class:"flex justify-between"},Fe={class:"ml-2 text-sm text-gray-500"},Me={key:0,class:"mt-1 text-sm text-red-500"},Ue={class:"grid grid-cols-1 gap-3 mt-4 md:grid-cols-5"},Be={key:0,class:"mt-1 text-sm text-red-500"},Pe={key:0,class:"mt-1 text-sm text-red-500"},Se={class:"relative"},Ce={class:"ml-2 text-sm text-gray-500"},De={class:"relative"},Ie={key:0,class:"mt-1 text-sm text-red-500"},je=["value"],Ne={key:0,class:"mt-1 text-sm text-red-500"},Re={class:"flex justify-end gap-3 mt-6"},Oe={__name:"form-create-edit",props:{dropdowns:Object,product:{type:Object,default:null},mode:String},setup(c){const i=c,{isActionLoading:f}=A(),v=h(!1),t=S({category_id:i.product?.category_id||null,unit_id:i.product?.unit_id||null,size_id:i.product?.size_id||null,supplier_id:i.product?.supplier_id||null,brand_id:i.product?.brand_id||null,product_type_id:i.product?.product_type_id||null,name:i.product?.name||"",code:i.product?.code||"",description:i.product?.description||"",status:i.product?.status||"active",purchase_price:i.product?.purchase_price||0,selling_price:i.product?.selling_price||0,stock:i.product?.stock||0,min_stock:i.product?.min_stock||0,target_margin_percent:i.product?.target_margin_percent||20,margin_nominal:0,image:null}),k=h(i.product?.image_url??null);C(async()=>{const u=parseFloat(t.purchase_price)||0,e=parseFloat(t.target_margin_percent)||0,s=u*(e/100);t.margin_nominal=Math.round(s)});const V=()=>{const u=parseFloat(t.purchase_price)||0,e=parseFloat(t.target_margin_percent)||0,s=u*(e/100);t.margin_nominal=Math.round(s),t.selling_price=Math.round(u+s)},F=()=>{const u=parseFloat(t.purchase_price)||0,s=(parseFloat(t.selling_price)||0)-u;t.margin_nominal=s,u>0?t.target_margin_percent=parseFloat((s/u*100).toFixed(2)):t.target_margin_percent=100},M=()=>{const u=parseFloat(t.purchase_price)||0,e=parseFloat(t.target_margin_percent)||0,s=u*(e/100);t.margin_nominal=Math.round(s),t.selling_price=Math.round(u+s)},U=()=>{const u=parseFloat(t.purchase_price)||0,e=parseFloat(t.margin_nominal)||0;t.selling_price=Math.round(u+e),u>0&&(t.target_margin_percent=parseFloat((e/u*100).toFixed(2)))};function B(u){const e=u.target.files[0];e&&(t.image=e,k.value=URL.createObjectURL(e))}const P=()=>{f.value=!0,i.mode==="create"?t.post(route("products.store"),{onFinish:()=>f.value=!1}):t.transform(u=>({...u,_method:"put"})).post(route("products.update",{product:i.product.id}),{onFinish:()=>f.value=!1})};return(u,e)=>(o(),a(x,null,[v.value?(o(),D(L,{key:0,onResult:l(t).code,onClose:e[0]||(e[0]=s=>v.value=!1)},null,8,["onResult"])):d("",!0),r("form",{class:"p-6 bg-gray-100 rounded-lg shadow dark:bg-customBg-tableDark",onSubmit:R(P,["prevent"])},[r("div",K,[r("div",$,[r("label",{for:"image-upload",class:I(["flex flex-col items-center justify-center w-40 mt-2 rounded-lg cursor-pointer aspect-square bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600",{"border-2 border-gray-300 border-dashed":!k.value}])},[k.value?(o(),a("img",{key:0,src:k.value,onload:"this.classList.remove('opacity-0')",onerror:"this.style.display='none'",alt:"Preview",class:"object-cover w-full h-full rounded-lg opacity-0"},null,8,T)):d("",!0),e[18]||(e[18]=r("div",{class:"flex flex-col items-center justify-center w-full h-full pt-5 pb-6"},[r("p",{class:"mb-2 text-sm text-gray-500 dark:text-gray-200"},[r("span",{class:"font-semibold"},"Klik untuk Upload")]),r("p",{class:"text-xs text-gray-500 dark:text-gray-200"}," WEBP, PNG (max. 1MB) ")],-1)),r("input",{id:"image-upload",type:"file",name:"image",class:"hidden",onChange:B},null,32)],2),l(t).errors.image?(o(),a("p",O,n(l(t).errors.image),1)):d("",!0)]),r("div",q,[r("div",E,[e[20]||(e[20]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},"Kode Barang",-1)),p(y,{class:"w-full max-h-10",id:"kode",type:"text",name:"kode",placeholder:"Kode Barang",modelValue:l(t).code,"onUpdate:modelValue":e[1]||(e[1]=s=>l(t).code=s)},null,8,["modelValue"]),l(t).errors.code?(o(),a("p",J,n(l(t).errors.code),1)):d("",!0),r("button",{type:"button",onClick:e[2]||(e[2]=s=>v.value=!0),class:"absolute right-1.5 top-7 p-1 bg-white dark:bg-gray-700 rounded-lg shadow-sm text-gray-600 dark:text-gray-200 hover:text-lime-600 hover:bg-lime-50 transition border border-gray-200 dark:border-gray-600",title:"Scan Produk"},[...e[19]||(e[19]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])])]),r("div",null,[e[21]||(e[21]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Nama Barang"),r("span",{class:"text-red-500"},"*")],-1)),p(y,{class:"w-full max-h-10",id:"nama",type:"text",name:"nama",placeholder:"Nama Barang",modelValue:l(t).name,"onUpdate:modelValue":e[3]||(e[3]=s=>l(t).name=s)},null,8,["modelValue"]),l(t).errors.name?(o(),a("p",G,n(l(t).errors.name),1)):d("",!0)])])]),r("div",W,[r("div",null,[e[22]||(e[22]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Kategori"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[4]||(e[4]=s=>l(t).category_id=s)},[i.mode=="create"?(o(),a("option",Q," Pilih Kategori ")):d("",!0),(o(!0),a(x,null,_(c.dropdowns.categories,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,X))),128))],512),[[b,l(t).category_id]]),l(t).errors.category_id?(o(),a("p",Y,n(l(t).errors.category_id),1)):d("",!0)]),r("div",null,[e[23]||(e[23]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Type"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{class:"w-full px-3 py-2 text-sm border border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500","onUpdate:modelValue":e[5]||(e[5]=s=>l(t).product_type_id=s)},[i.mode=="create"?(o(),a("option",Z," Pilih Type ")):d("",!0),(o(!0),a(x,null,_(c.dropdowns.types,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,ee))),128))],512),[[b,l(t).product_type_id]]),l(t).errors.product_type_id?(o(),a("p",te,n(l(t).errors.product_type_id),1)):d("",!0)]),r("div",null,[e[24]||(e[24]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Satuan"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>l(t).unit_id=s),class:"w-full px-3 py-2 text-sm border border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[i.mode=="create"?(o(),a("option",re," Pilih Satuan ")):d("",!0),(o(!0),a(x,null,_(c.dropdowns.units,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,se))),128))],512),[[b,l(t).unit_id]]),l(t).errors.unit_id?(o(),a("p",le,n(l(t).errors.unit_id),1)):d("",!0)]),r("div",null,[e[25]||(e[25]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Ukuran"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>l(t).size_id=s),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[i.mode=="create"?(o(),a("option",oe," Pilih Ukuran ")):d("",!0),(o(!0),a(x,null,_(c.dropdowns.sizes,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,ae))),128))],512),[[b,l(t).size_id]]),l(t).errors.size_id?(o(),a("p",ne,n(l(t).errors.size_id),1)):d("",!0)]),r("div",null,[e[26]||(e[26]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Merk"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>l(t).brand_id=s),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[i.mode=="create"?(o(),a("option",ie," Pilih Merk ")):d("",!0),(o(!0),a(x,null,_(c.dropdowns.brands,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,de))),128))],512),[[b,l(t).brand_id]]),l(t).errors.brand_id?(o(),a("p",ue,n(l(t).errors.brand_id),1)):d("",!0)]),r("div",null,[e[27]||(e[27]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Supplier"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>l(t).supplier_id=s),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},[i.mode=="create"?(o(),a("option",me," Pilih Supplier ")):d("",!0),(o(!0),a(x,null,_(c.dropdowns.suppliers,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,pe))),128))],512),[[b,l(t).supplier_id]]),l(t).errors.supplier_id?(o(),a("p",ce,n(l(t).errors.supplier_id),1)):d("",!0)])]),r("div",ge,[e[28]||(e[28]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Deskripsi"),r("span",{class:"text-red-500"},"*")],-1)),g(r("textarea",{"onUpdate:modelValue":e[10]||(e[10]=s=>l(t).description=s),name:"description",id:"description",rows:"3",placeholder:"Deskripsi Barang",class:"w-full px-3 py-2 border border-gray-400 rounded-lg dark:bg-gray-700 dark:text-white focus:border-lime-500 focus:ring-lime-500"},null,512),[[j,l(t).description]]),l(t).errors.description?(o(),a("p",xe,n(l(t).errors.description),1)):d("",!0)]),r("div",ye,[r("div",be,[e[30]||(e[30]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Harga Beli (HPP)"),r("span",{class:"text-red-500"},"*")],-1)),r("div",_e,[e[29]||(e[29]=r("span",{class:"absolute text-sm text-gray-500 left-3 top-2"},"Rp",-1)),p(y,{modelValue:l(t).purchase_price,"onUpdate:modelValue":e[11]||(e[11]=s=>l(t).purchase_price=s),class:"w-full py-2 pr-3 max-h-10 pl-9",onInput:V,id:"price_buy",type:"number",min:"0",name:"price_buy",placeholder:"Harga Beli"},null,8,["modelValue"])]),r("span",ke,[r("p",fe,n(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(l(t).purchase_price)||0),1),l(t).errors.purchase_price?(o(),a("p",ve,n(l(t).errors.purchase_price),1)):d("",!0)])]),r("div",we,[e[32]||(e[32]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Harga Jual"),r("span",{class:"text-red-500"},"*")],-1)),r("div",he,[e[31]||(e[31]=r("span",{class:"absolute text-sm text-gray-500 left-3 top-2"},"Rp",-1)),p(y,{modelValue:l(t).selling_price,"onUpdate:modelValue":e[12]||(e[12]=s=>l(t).selling_price=s),class:"w-full py-2 pr-3 max-h-10 pl-9",id:"price_sell",type:"number",min:"0",onInput:F,name:"price_sell",placeholder:"Harga Jual"},null,8,["modelValue"])]),r("span",Ve,[r("p",Fe,n(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(l(t).selling_price)||0),1),l(t).errors.selling_price?(o(),a("p",Me,n(l(t).errors.selling_price),1)):d("",!0)])])]),r("div",Ue,[r("div",null,[e[33]||(e[33]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Stock"),r("span",{class:"text-red-500"},"*")],-1)),p(y,{class:"w-full max-h-10",id:"stock",type:"number",name:"stock",min:"0",placeholder:"Stock",modelValue:l(t).stock,"onUpdate:modelValue":e[13]||(e[13]=s=>l(t).stock=s)},null,8,["modelValue"]),l(t).errors.stock?(o(),a("p",Be,n(l(t).errors.stock),1)):d("",!0)]),r("div",null,[e[34]||(e[34]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Min Stock"),r("span",{class:"text-red-500"},"*")],-1)),p(y,{modelValue:l(t).min_stock,"onUpdate:modelValue":e[14]||(e[14]=s=>l(t).min_stock=s),class:"w-full max-h-10",id:"min_stock",min:"0",type:"number",name:"min_stock",placeholder:"Min Stock"},null,8,["modelValue"]),l(t).errors.min_stock?(o(),a("p",Pe,n(l(t).errors.min_stock),1)):d("",!0)]),r("div",null,[e[36]||(e[36]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Margin (Rp)"),r("span",{class:"text-red-500"},"*")],-1)),r("div",Se,[e[35]||(e[35]=r("span",{class:"absolute text-sm text-gray-500 left-3 top-2"},"Rp",-1)),p(y,{modelValue:l(t).margin_nominal,"onUpdate:modelValue":e[15]||(e[15]=s=>l(t).margin_nominal=s),class:"w-full py-2 pr-3 pl-9 max-h-10",id:"margin_nominal",type:"number",min:"0",onInput:U,name:"margin_nominal",placeholder:"Margin Nominal"},null,8,["modelValue"]),r("p",Ce,n(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(l(t).margin_nominal)||0),1)])]),r("div",null,[e[38]||(e[38]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 border-gray-400 dark:text-gray-100"},[m("Margin (%)"),r("span",{class:"text-red-500"},"*")],-1)),r("div",De,[p(y,{modelValue:l(t).target_margin_percent,"onUpdate:modelValue":e[16]||(e[16]=s=>l(t).target_margin_percent=s),class:"w-full py-2 pl-3 pr-8 max-h-10",id:"target_margin_percent",type:"text",min:"0",onInput:M,name:"target_margin_percent",placeholder:"Margin Percent"},null,8,["modelValue"]),e[37]||(e[37]=r("span",{class:"absolute text-sm font-bold text-gray-500 right-3 top-2"},"%",-1)),l(t).errors.target_margin_percent?(o(),a("p",Ie,n(l(t).errors.target_margin_percent),1)):d("",!0)])]),r("div",null,[e[39]||(e[39]=r("label",{class:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-100"},[m("Status"),r("span",{class:"text-red-500"},"*")],-1)),g(r("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>l(t).status=s),class:"w-full px-3 py-2 text-sm border border-gray-400 rounded-lg focus:border-lime-500 focus:ring-lime-500 dark:bg-gray-700 dark:text-white"},[(o(!0),a(x,null,_(c.dropdowns.productStatuses,s=>(o(),a("option",{key:s,value:s},n(s.charAt(0).toUpperCase()+s.slice(1)),9,je))),128))],512),[[b,l(t).status]]),l(t).errors.status?(o(),a("p",Ne,n(l(t).errors.status),1)):d("",!0)])]),r("div",Re,[p(l(N),{href:u.route("products.index")},{default:w(()=>[p(z,null,{default:w(()=>[...e[40]||(e[40]=[m("Batal",-1)])]),_:1})]),_:1},8,["href"]),p(H,{type:"submit",disabled:l(t).processing},{default:w(()=>[m(n(l(t).processing?"Menyimpan...":"Simpan"),1)]),_:1},8,["disabled"])])],32)],64))}};export{Oe as default};
