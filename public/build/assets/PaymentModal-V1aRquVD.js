import{y as w,j as k,u as h,z as S,g as r,i as b,o as i,b as t,e as B,k as m,A as f,d as l,t as d,B as M,F as _,q as D}from"./app-CjEDMysI.js";import"./lodash-ogj_d-kl.js";import{u as C}from"./useActionLoading-CKYbla82.js";const I={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},F={class:"w-full max-w-md overflow-hidden bg-white shadow-2xl rounded-xl animate-fade-in-down"},V={class:"flex items-center justify-between p-4 border-b bg-gray-50"},A={class:"relative"},T=["max"],U={class:"mt-1 text-xs text-right text-gray-400"},j={key:0,class:"mt-1 text-xs text-red-500"},N={class:"grid grid-cols-2 gap-4"},O=["value"],$={key:0,class:"mt-1 text-xs text-red-500"},L={class:"flex gap-3 pt-2"},P=["disabled"],q={__name:"PaymentModal",props:{show:Boolean,paymentMethods:Array,invoice:Object},emits:["close"],setup(u,{emit:y}){const a=u,x=y;w();const{isActionLoading:g}=C(),c=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),p=k(()=>a.invoice?a.invoice.total_amount-a.invoice.amount_paid:0),o=h({payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"transfer",proof_image:null,notes:""});S(()=>a.show,n=>{n&&(o.reset(),o.clearErrors(),o.amount=p.value,o.payment_date=new Date().toISOString().split("T")[0])});const v=()=>{g.value=!0,o.post(route("finance.store",a.invoice.id),{onSuccess:()=>{x("close"),g.value=!1}})};return(n,e)=>u.show?(i(),r("div",I,[t("div",F,[t("div",V,[e[7]||(e[7]=t("h3",{class:"font-bold text-gray-800"},"Input Pembayaran",-1)),t("button",{onClick:e[0]||(e[0]=s=>n.$emit("close")),class:"text-xl font-bold text-gray-400 hover:text-red-500"}," Ã— ")]),t("form",{onSubmit:B(v,["prevent"]),class:"p-5 space-y-4"},[t("div",null,[e[9]||(e[9]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Nominal Bayar",-1)),t("div",A,[e[8]||(e[8]=t("span",{class:"absolute font-bold text-gray-500 left-3 top-2"},"Rp",-1)),m(t("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=s=>l(o).amount=s),class:"w-full py-2 pl-10 pr-3 text-lg font-bold border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",max:p.value,placeholder:"0"},null,8,T),[[f,l(o).amount]])]),t("div",U," Maks: "+d(c(p.value)),1),l(o).errors.amount?(i(),r("div",j,d(l(o).errors.amount),1)):b("",!0)]),t("div",N,[t("div",null,[e[10]||(e[10]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Tanggal",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>l(o).payment_date=s),class:"w-full p-2 text-sm border rounded-lg"},null,512),[[f,l(o).payment_date]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Metode",-1)),m(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l(o).payment_method=s),class:"w-full p-2 text-sm border rounded-lg"},[(i(!0),r(_,null,D(u.paymentMethods,s=>(i(),r("option",{key:s,value:s},d(s.charAt(0).toUpperCase()+s.slice(1)),9,O))),128))],512),[[M,l(o).payment_method]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Bukti Foto / Struk",-1)),t("input",{type:"file",onInput:e[4]||(e[4]=s=>l(o).proof_image=s.target.files[0]),class:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),l(o).errors.proof_image?(i(),r("div",$,d(l(o).errors.proof_image),1)):b("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Catatan (Opsional)",-1)),m(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).notes=s),rows:"2",class:"w-full p-2 text-sm border rounded-lg",placeholder:"Contoh: Cicilan pertama"},null,512),[[f,l(o).notes]])]),t("div",L,[t("button",{type:"button",onClick:e[6]||(e[6]=s=>n.$emit("close")),class:"flex-1 py-2 text-gray-600 rounded-lg hover:bg-gray-100"}," Batal "),t("button",{type:"submit",disabled:l(o).processing,class:"flex-1 py-2 font-bold text-white rounded-lg bg-lime-600 hover:bg-lime-700 disabled:opacity-50"},d(l(o).processing?"Menyimpan...":"Bayar Sekarang"),9,P)])],32)])])):b("",!0)}};export{q as default};
